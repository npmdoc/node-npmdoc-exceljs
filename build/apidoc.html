<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/guyonroche/exceljs#readme"

    >exceljs (v0.4.4)</a>
</h1>
<h4>Excel Workbook Manager - Read and Write xlsx and csv Files.</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs">module exceljs</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.ModelContainer">
            function <span class="apidocSignatureSpan">exceljs.</span>ModelContainer
            <span class="apidocSignatureSpan">(model)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.Workbook">
            function <span class="apidocSignatureSpan">exceljs.</span>Workbook
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.auto_drain">
            function <span class="apidocSignatureSpan">exceljs.</span>auto_drain
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.base_xform">
            function <span class="apidocSignatureSpan">exceljs.</span>base_xform
            <span class="apidocSignatureSpan">(model, name)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.cell_matrix">
            function <span class="apidocSignatureSpan">exceljs.</span>cell_matrix
            <span class="apidocSignatureSpan">(template)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.composite_xform">
            function <span class="apidocSignatureSpan">exceljs.</span>composite_xform
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.csv">
            function <span class="apidocSignatureSpan">exceljs.</span>csv
            <span class="apidocSignatureSpan">(workbook)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.flow_control">
            function <span class="apidocSignatureSpan">exceljs.</span>flow_control
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.hyperlink_reader">
            function <span class="apidocSignatureSpan">exceljs.</span>hyperlink_reader
            <span class="apidocSignatureSpan">(workbook, id)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.hyperlink_writer">
            function <span class="apidocSignatureSpan">exceljs.</span>hyperlink_writer
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.line_buffer">
            function <span class="apidocSignatureSpan">exceljs.</span>line_buffer
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.list_xform">
            function <span class="apidocSignatureSpan">exceljs.</span>list_xform
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.shared_strings">
            function <span class="apidocSignatureSpan">exceljs.</span>shared_strings
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.static_xform">
            function <span class="apidocSignatureSpan">exceljs.</span>static_xform
            <span class="apidocSignatureSpan">(model)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_base64">
            function <span class="apidocSignatureSpan">exceljs.</span>stream_base64
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_buf">
            function <span class="apidocSignatureSpan">exceljs.</span>stream_buf
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_converter">
            function <span class="apidocSignatureSpan">exceljs.</span>stream_converter
            <span class="apidocSignatureSpan">(inner, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.string_buf">
            function <span class="apidocSignatureSpan">exceljs.</span>string_buf
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.string_builder">
            function <span class="apidocSignatureSpan">exceljs.</span>string_builder
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stuttered_pipe">
            function <span class="apidocSignatureSpan">exceljs.</span>stuttered_pipe
            <span class="apidocSignatureSpan">(readable, writable, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.typed_stack">
            function <span class="apidocSignatureSpan">exceljs.</span>typed_stack
            <span class="apidocSignatureSpan">(type)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_reader">
            function <span class="apidocSignatureSpan">exceljs.</span>workbook_reader
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_writer">
            function <span class="apidocSignatureSpan">exceljs.</span>workbook_writer
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_reader">
            function <span class="apidocSignatureSpan">exceljs.</span>worksheet_reader
            <span class="apidocSignatureSpan">(workbook, id)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer">
            function <span class="apidocSignatureSpan">exceljs.</span>worksheet_writer
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx">
            function <span class="apidocSignatureSpan">exceljs.</span>xlsx
            <span class="apidocSignatureSpan">(workbook)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xml_stream">
            function <span class="apidocSignatureSpan">exceljs.</span>xml_stream
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>DocumentType</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>ErrorValue</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>FormulaType</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>ReadingOrder</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>RelationshipType</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>ValueType</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>Workbook.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>auto_drain.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>base_xform.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>cell_matrix.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>col_cache</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>composite_xform.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>config</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>csv.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>exceljs_browser</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>exceljs_nodejs</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>flow_control.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>hyperlink_reader.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>hyperlink_writer.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>line_buffer.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>list_xform.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>promish</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>shared_formula</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>shared_strings.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>static_xform.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>stream</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>stream_base64.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>stream_buf.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>stream_converter.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>string_buf.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>string_builder.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>stuttered_pipe.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>typed_stack.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>under_dash</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>utils</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>workbook_reader.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>workbook_writer.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>worksheet_reader.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>worksheet_writer.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>xlsx.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>xml_stream.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.</span>zip_stream</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.Workbook">module exceljs.Workbook</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.Workbook.Workbook">
            function <span class="apidocSignatureSpan">exceljs.</span>Workbook
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.Workbook.prototype">module exceljs.Workbook.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.Workbook.prototype._removeWorksheet">
            function <span class="apidocSignatureSpan">exceljs.Workbook.prototype.</span>_removeWorksheet
            <span class="apidocSignatureSpan">(worksheet)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.Workbook.prototype.addWorksheet">
            function <span class="apidocSignatureSpan">exceljs.Workbook.prototype.</span>addWorksheet
            <span class="apidocSignatureSpan">(name, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.Workbook.prototype.clearThemes">
            function <span class="apidocSignatureSpan">exceljs.Workbook.prototype.</span>clearThemes
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.Workbook.prototype.eachSheet">
            function <span class="apidocSignatureSpan">exceljs.Workbook.prototype.</span>eachSheet
            <span class="apidocSignatureSpan">(iteratee)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.Workbook.prototype.getWorksheet">
            function <span class="apidocSignatureSpan">exceljs.Workbook.prototype.</span>getWorksheet
            <span class="apidocSignatureSpan">(id)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.Workbook.prototype.removeWorksheet">
            function <span class="apidocSignatureSpan">exceljs.Workbook.prototype.</span>removeWorksheet
            <span class="apidocSignatureSpan">(id)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.Workbook.prototype.</span>_csv</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.Workbook.prototype.</span>_xlsx</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.Workbook.prototype.</span>csv</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.Workbook.prototype.</span>xlsx</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.auto_drain">module exceljs.auto_drain</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.auto_drain.auto_drain">
            function <span class="apidocSignatureSpan">exceljs.</span>auto_drain
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.auto_drain.super_">
            function <span class="apidocSignatureSpan">exceljs.auto_drain.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.auto_drain.prototype">module exceljs.auto_drain.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.auto_drain.prototype.end">
            function <span class="apidocSignatureSpan">exceljs.auto_drain.prototype.</span>end
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.auto_drain.prototype.write">
            function <span class="apidocSignatureSpan">exceljs.auto_drain.prototype.</span>write
            <span class="apidocSignatureSpan">(chunk)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.base_xform">module exceljs.base_xform</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.base_xform.base_xform">
            function <span class="apidocSignatureSpan">exceljs.</span>base_xform
            <span class="apidocSignatureSpan">(model, name)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.base_xform.prototype">module exceljs.base_xform.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.base_xform.prototype.parse">
            function <span class="apidocSignatureSpan">exceljs.base_xform.prototype.</span>parse
            <span class="apidocSignatureSpan">(parser)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.base_xform.prototype.parseClose">
            function <span class="apidocSignatureSpan">exceljs.base_xform.prototype.</span>parseClose
            <span class="apidocSignatureSpan">(name)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.base_xform.prototype.parseOpen">
            function <span class="apidocSignatureSpan">exceljs.base_xform.prototype.</span>parseOpen
            <span class="apidocSignatureSpan">(node)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.base_xform.prototype.parseStream">
            function <span class="apidocSignatureSpan">exceljs.base_xform.prototype.</span>parseStream
            <span class="apidocSignatureSpan">(stream)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.base_xform.prototype.parseText">
            function <span class="apidocSignatureSpan">exceljs.base_xform.prototype.</span>parseText
            <span class="apidocSignatureSpan">(node)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.base_xform.prototype.prepare">
            function <span class="apidocSignatureSpan">exceljs.base_xform.prototype.</span>prepare
            <span class="apidocSignatureSpan">(model, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.base_xform.prototype.reconcile">
            function <span class="apidocSignatureSpan">exceljs.base_xform.prototype.</span>reconcile
            <span class="apidocSignatureSpan">(model, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.base_xform.prototype.render">
            function <span class="apidocSignatureSpan">exceljs.base_xform.prototype.</span>render
            <span class="apidocSignatureSpan">(xmlStream, model)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.base_xform.prototype.reset">
            function <span class="apidocSignatureSpan">exceljs.base_xform.prototype.</span>reset
            <span class="apidocSignatureSpan">(model)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.base_xform.prototype.toXml">
            function <span class="apidocSignatureSpan">exceljs.base_xform.prototype.</span>toXml
            <span class="apidocSignatureSpan">(model)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">exceljs.base_xform.prototype.</span>xml</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.cell_matrix">module exceljs.cell_matrix</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.cell_matrix.cell_matrix">
            function <span class="apidocSignatureSpan">exceljs.</span>cell_matrix
            <span class="apidocSignatureSpan">(template)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.cell_matrix.prototype">module exceljs.cell_matrix.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.cell_matrix.prototype.addCell">
            function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>addCell
            <span class="apidocSignatureSpan">(addressStr)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.cell_matrix.prototype.addCellEx">
            function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>addCellEx
            <span class="apidocSignatureSpan">(address)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.cell_matrix.prototype.findCell">
            function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>findCell
            <span class="apidocSignatureSpan">(addressStr)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.cell_matrix.prototype.findCellAt">
            function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>findCellAt
            <span class="apidocSignatureSpan">(sheetName, rowNumber, colNumber)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.cell_matrix.prototype.findCellEx">
            function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>findCellEx
            <span class="apidocSignatureSpan">(address, create)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.cell_matrix.prototype.findRowCell">
            function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>findRowCell
            <span class="apidocSignatureSpan">(row, address, create)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.cell_matrix.prototype.findSheet">
            function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>findSheet
            <span class="apidocSignatureSpan">(address, create)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.cell_matrix.prototype.findSheetRow">
            function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>findSheetRow
            <span class="apidocSignatureSpan">(sheet, address, create)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.cell_matrix.prototype.forEach">
            function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>forEach
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.cell_matrix.prototype.getCell">
            function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>getCell
            <span class="apidocSignatureSpan">(addressStr)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.cell_matrix.prototype.getCellAt">
            function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>getCellAt
            <span class="apidocSignatureSpan">(sheetName, rowNumber, colNumber)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.cell_matrix.prototype.getCellEx">
            function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>getCellEx
            <span class="apidocSignatureSpan">(address)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.cell_matrix.prototype.map">
            function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>map
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.cell_matrix.prototype.removeCellEx">
            function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>removeCellEx
            <span class="apidocSignatureSpan">(address)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.col_cache">module exceljs.col_cache</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.col_cache._fill">
            function <span class="apidocSignatureSpan">exceljs.col_cache.</span>_fill
            <span class="apidocSignatureSpan">(level)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.col_cache._level">
            function <span class="apidocSignatureSpan">exceljs.col_cache.</span>_level
            <span class="apidocSignatureSpan">(n)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.col_cache.decode">
            function <span class="apidocSignatureSpan">exceljs.col_cache.</span>decode
            <span class="apidocSignatureSpan">(value)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.col_cache.decodeAddress">
            function <span class="apidocSignatureSpan">exceljs.col_cache.</span>decodeAddress
            <span class="apidocSignatureSpan">(value)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.col_cache.decodeEx">
            function <span class="apidocSignatureSpan">exceljs.col_cache.</span>decodeEx
            <span class="apidocSignatureSpan">(value)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.col_cache.encode">
            function <span class="apidocSignatureSpan">exceljs.col_cache.</span>encode
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.col_cache.encodeAddress">
            function <span class="apidocSignatureSpan">exceljs.col_cache.</span>encodeAddress
            <span class="apidocSignatureSpan">(row, col)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.col_cache.getAddress">
            function <span class="apidocSignatureSpan">exceljs.col_cache.</span>getAddress
            <span class="apidocSignatureSpan">(r, c)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.col_cache.l2n">
            function <span class="apidocSignatureSpan">exceljs.col_cache.</span>l2n
            <span class="apidocSignatureSpan">(l)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.col_cache.n2l">
            function <span class="apidocSignatureSpan">exceljs.col_cache.</span>n2l
            <span class="apidocSignatureSpan">(n)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.col_cache.validateAddress">
            function <span class="apidocSignatureSpan">exceljs.col_cache.</span>validateAddress
            <span class="apidocSignatureSpan">(value)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.col_cache.</span>_dictionary</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.col_cache.</span>_hash</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.col_cache.</span>_l2n</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.col_cache.</span>_n2l</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.composite_xform">module exceljs.composite_xform</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.composite_xform.composite_xform">
            function <span class="apidocSignatureSpan">exceljs.</span>composite_xform
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.composite_xform.super_">
            function <span class="apidocSignatureSpan">exceljs.composite_xform.</span>super_
            <span class="apidocSignatureSpan">(model, name)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.composite_xform.prototype">module exceljs.composite_xform.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.composite_xform.prototype.parseClose">
            function <span class="apidocSignatureSpan">exceljs.composite_xform.prototype.</span>parseClose
            <span class="apidocSignatureSpan">(name)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.composite_xform.prototype.parseOpen">
            function <span class="apidocSignatureSpan">exceljs.composite_xform.prototype.</span>parseOpen
            <span class="apidocSignatureSpan">(node)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.composite_xform.prototype.parseText">
            function <span class="apidocSignatureSpan">exceljs.composite_xform.prototype.</span>parseText
            <span class="apidocSignatureSpan">(text)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.composite_xform.prototype.prepare">
            function <span class="apidocSignatureSpan">exceljs.composite_xform.prototype.</span>prepare
            <span class="apidocSignatureSpan">(model, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.composite_xform.prototype.reconcile">
            function <span class="apidocSignatureSpan">exceljs.composite_xform.prototype.</span>reconcile
            <span class="apidocSignatureSpan">(model, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.composite_xform.prototype.render">
            function <span class="apidocSignatureSpan">exceljs.composite_xform.prototype.</span>render
            <span class="apidocSignatureSpan">(xmlStream, model)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.config">module exceljs.config</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.config.setValue">
            function <span class="apidocSignatureSpan">exceljs.config.</span>setValue
            <span class="apidocSignatureSpan">(key, value, overwrite)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.csv">module exceljs.csv</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.csv.csv">
            function <span class="apidocSignatureSpan">exceljs.</span>csv
            <span class="apidocSignatureSpan">(workbook)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.csv.prototype">module exceljs.csv.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.csv.prototype.createInputStream">
            function <span class="apidocSignatureSpan">exceljs.csv.prototype.</span>createInputStream
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.csv.prototype.read">
            function <span class="apidocSignatureSpan">exceljs.csv.prototype.</span>read
            <span class="apidocSignatureSpan">(stream, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.csv.prototype.readFile">
            function <span class="apidocSignatureSpan">exceljs.csv.prototype.</span>readFile
            <span class="apidocSignatureSpan">(filename, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.csv.prototype.write">
            function <span class="apidocSignatureSpan">exceljs.csv.prototype.</span>write
            <span class="apidocSignatureSpan">(stream, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.csv.prototype.writeFile">
            function <span class="apidocSignatureSpan">exceljs.csv.prototype.</span>writeFile
            <span class="apidocSignatureSpan">(filename, options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.exceljs_browser">module exceljs.exceljs_browser</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.exceljs_browser.Workbook">
            function <span class="apidocSignatureSpan">exceljs.exceljs_browser.</span>Workbook
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.exceljs_browser.</span>DocumentType</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.exceljs_browser.</span>ErrorValue</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.exceljs_browser.</span>FormulaType</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.exceljs_browser.</span>ReadingOrder</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.exceljs_browser.</span>RelationshipType</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.exceljs_browser.</span>ValueType</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.exceljs_nodejs">module exceljs.exceljs_nodejs</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.exceljs_nodejs.ModelContainer">
            function <span class="apidocSignatureSpan">exceljs.exceljs_nodejs.</span>ModelContainer
            <span class="apidocSignatureSpan">(model)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.exceljs_nodejs.Workbook">
            function <span class="apidocSignatureSpan">exceljs.exceljs_nodejs.</span>Workbook
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.exceljs_nodejs.</span>DocumentType</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.exceljs_nodejs.</span>ErrorValue</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.exceljs_nodejs.</span>FormulaType</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.exceljs_nodejs.</span>ReadingOrder</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.exceljs_nodejs.</span>RelationshipType</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.exceljs_nodejs.</span>ValueType</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.exceljs_nodejs.</span>config</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.exceljs_nodejs.</span>stream</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.flow_control">module exceljs.flow_control</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.flow_control.flow_control">
            function <span class="apidocSignatureSpan">exceljs.</span>flow_control
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.flow_control.super_">
            function <span class="apidocSignatureSpan">exceljs.flow_control.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.flow_control.prototype">module exceljs.flow_control.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.flow_control.prototype._animate">
            function <span class="apidocSignatureSpan">exceljs.flow_control.prototype.</span>_animate
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.flow_control.prototype._delay">
            function <span class="apidocSignatureSpan">exceljs.flow_control.prototype.</span>_delay
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.flow_control.prototype._flush">
            function <span class="apidocSignatureSpan">exceljs.flow_control.prototype.</span>_flush
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.flow_control.prototype._pipe">
            function <span class="apidocSignatureSpan">exceljs.flow_control.prototype.</span>_pipe
            <span class="apidocSignatureSpan">(chunk)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.flow_control.prototype._write">
            function <span class="apidocSignatureSpan">exceljs.flow_control.prototype.</span>_write
            <span class="apidocSignatureSpan">(dst, data, encoding)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.flow_control.prototype.createChild">
            function <span class="apidocSignatureSpan">exceljs.flow_control.prototype.</span>createChild
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.flow_control.prototype.end">
            function <span class="apidocSignatureSpan">exceljs.flow_control.prototype.</span>end
            <span class="apidocSignatureSpan">(chunk, encoding, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.flow_control.prototype.pipe">
            function <span class="apidocSignatureSpan">exceljs.flow_control.prototype.</span>pipe
            <span class="apidocSignatureSpan">(stream, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.flow_control.prototype.unpipe">
            function <span class="apidocSignatureSpan">exceljs.flow_control.prototype.</span>unpipe
            <span class="apidocSignatureSpan">(stream)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.flow_control.prototype.write">
            function <span class="apidocSignatureSpan">exceljs.flow_control.prototype.</span>write
            <span class="apidocSignatureSpan">(data, encoding, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.hyperlink_reader">module exceljs.hyperlink_reader</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.hyperlink_reader.hyperlink_reader">
            function <span class="apidocSignatureSpan">exceljs.</span>hyperlink_reader
            <span class="apidocSignatureSpan">(workbook, id)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.hyperlink_reader.super_">
            function <span class="apidocSignatureSpan">exceljs.hyperlink_reader.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.hyperlink_reader.prototype">module exceljs.hyperlink_reader.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.hyperlink_reader.prototype.each">
            function <span class="apidocSignatureSpan">exceljs.hyperlink_reader.prototype.</span>each
            <span class="apidocSignatureSpan">(fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.hyperlink_reader.prototype.read">
            function <span class="apidocSignatureSpan">exceljs.hyperlink_reader.prototype.</span>read
            <span class="apidocSignatureSpan">(entry, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">exceljs.hyperlink_reader.prototype.</span>count</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.hyperlink_writer">module exceljs.hyperlink_writer</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.hyperlink_writer.hyperlink_writer">
            function <span class="apidocSignatureSpan">exceljs.</span>hyperlink_writer
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.hyperlink_writer.prototype">module exceljs.hyperlink_writer.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.hyperlink_writer.prototype._writeClose">
            function <span class="apidocSignatureSpan">exceljs.hyperlink_writer.prototype.</span>_writeClose
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.hyperlink_writer.prototype._writeOpen">
            function <span class="apidocSignatureSpan">exceljs.hyperlink_writer.prototype.</span>_writeOpen
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.hyperlink_writer.prototype._writeRelationship">
            function <span class="apidocSignatureSpan">exceljs.hyperlink_writer.prototype.</span>_writeRelationship
            <span class="apidocSignatureSpan">(hyperlink)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.hyperlink_writer.prototype.commit">
            function <span class="apidocSignatureSpan">exceljs.hyperlink_writer.prototype.</span>commit
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.hyperlink_writer.prototype.each">
            function <span class="apidocSignatureSpan">exceljs.hyperlink_writer.prototype.</span>each
            <span class="apidocSignatureSpan">(fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.hyperlink_writer.prototype.push">
            function <span class="apidocSignatureSpan">exceljs.hyperlink_writer.prototype.</span>push
            <span class="apidocSignatureSpan">(hyperlink)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.line_buffer">module exceljs.line_buffer</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.line_buffer.line_buffer">
            function <span class="apidocSignatureSpan">exceljs.</span>line_buffer
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.line_buffer.super_">
            function <span class="apidocSignatureSpan">exceljs.line_buffer.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.line_buffer.prototype">module exceljs.line_buffer.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.line_buffer.prototype._flush">
            function <span class="apidocSignatureSpan">exceljs.line_buffer.prototype.</span>_flush
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.line_buffer.prototype.cork">
            function <span class="apidocSignatureSpan">exceljs.line_buffer.prototype.</span>cork
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.line_buffer.prototype.end">
            function <span class="apidocSignatureSpan">exceljs.line_buffer.prototype.</span>end
            <span class="apidocSignatureSpan">(chunk, encoding, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.line_buffer.prototype.setDefaultEncoding">
            function <span class="apidocSignatureSpan">exceljs.line_buffer.prototype.</span>setDefaultEncoding
            <span class="apidocSignatureSpan">(encoding)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.line_buffer.prototype.uncork">
            function <span class="apidocSignatureSpan">exceljs.line_buffer.prototype.</span>uncork
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.line_buffer.prototype.write">
            function <span class="apidocSignatureSpan">exceljs.line_buffer.prototype.</span>write
            <span class="apidocSignatureSpan">(chunk, encoding, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.list_xform">module exceljs.list_xform</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.list_xform.list_xform">
            function <span class="apidocSignatureSpan">exceljs.</span>list_xform
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.list_xform.super_">
            function <span class="apidocSignatureSpan">exceljs.list_xform.</span>super_
            <span class="apidocSignatureSpan">(model, name)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.list_xform.prototype">module exceljs.list_xform.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.list_xform.prototype.parseClose">
            function <span class="apidocSignatureSpan">exceljs.list_xform.prototype.</span>parseClose
            <span class="apidocSignatureSpan">(name)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.list_xform.prototype.parseOpen">
            function <span class="apidocSignatureSpan">exceljs.list_xform.prototype.</span>parseOpen
            <span class="apidocSignatureSpan">(node)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.list_xform.prototype.parseText">
            function <span class="apidocSignatureSpan">exceljs.list_xform.prototype.</span>parseText
            <span class="apidocSignatureSpan">(text)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.list_xform.prototype.prepare">
            function <span class="apidocSignatureSpan">exceljs.list_xform.prototype.</span>prepare
            <span class="apidocSignatureSpan">(model, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.list_xform.prototype.reconcile">
            function <span class="apidocSignatureSpan">exceljs.list_xform.prototype.</span>reconcile
            <span class="apidocSignatureSpan">(model, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.list_xform.prototype.render">
            function <span class="apidocSignatureSpan">exceljs.list_xform.prototype.</span>render
            <span class="apidocSignatureSpan">(xmlStream, model)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.promish">module exceljs.promish</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.promish.Promish">
            function <span class="apidocSignatureSpan">exceljs.promish.</span>Promish
            <span class="apidocSignatureSpan">(f)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.shared_formula">module exceljs.shared_formula</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.shared_formula.slideFormula">
            function <span class="apidocSignatureSpan">exceljs.shared_formula.</span>slideFormula
            <span class="apidocSignatureSpan">(formula, fromCell, toCell)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.shared_strings">module exceljs.shared_strings</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.shared_strings.shared_strings">
            function <span class="apidocSignatureSpan">exceljs.</span>shared_strings
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.shared_strings.prototype">module exceljs.shared_strings.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.shared_strings.prototype.add">
            function <span class="apidocSignatureSpan">exceljs.shared_strings.prototype.</span>add
            <span class="apidocSignatureSpan">(value)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.shared_strings.prototype.getString">
            function <span class="apidocSignatureSpan">exceljs.shared_strings.prototype.</span>getString
            <span class="apidocSignatureSpan">(index)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.static_xform">module exceljs.static_xform</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.static_xform.static_xform">
            function <span class="apidocSignatureSpan">exceljs.</span>static_xform
            <span class="apidocSignatureSpan">(model)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.static_xform.super_">
            function <span class="apidocSignatureSpan">exceljs.static_xform.</span>super_
            <span class="apidocSignatureSpan">(model, name)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.static_xform.prototype">module exceljs.static_xform.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.static_xform.prototype.parseClose">
            function <span class="apidocSignatureSpan">exceljs.static_xform.prototype.</span>parseClose
            <span class="apidocSignatureSpan">(name)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.static_xform.prototype.parseOpen">
            function <span class="apidocSignatureSpan">exceljs.static_xform.prototype.</span>parseOpen
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.static_xform.prototype.parseText">
            function <span class="apidocSignatureSpan">exceljs.static_xform.prototype.</span>parseText
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.static_xform.prototype.render">
            function <span class="apidocSignatureSpan">exceljs.static_xform.prototype.</span>render
            <span class="apidocSignatureSpan">(xmlStream)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.stream_base64">module exceljs.stream_base64</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_base64.stream_base64">
            function <span class="apidocSignatureSpan">exceljs.</span>stream_base64
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_base64.super_">
            function <span class="apidocSignatureSpan">exceljs.stream_base64.</span>super_
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.stream_base64.prototype">module exceljs.stream_base64.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_base64.prototype.cork">
            function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>cork
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_base64.prototype.end">
            function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>end
            <span class="apidocSignatureSpan">(chunk, encoding, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_base64.prototype.isPaused">
            function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>isPaused
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_base64.prototype.pause">
            function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>pause
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_base64.prototype.pipe">
            function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>pipe
            <span class="apidocSignatureSpan">(destination, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_base64.prototype.read">
            function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>read
            <span class="apidocSignatureSpan">(size)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_base64.prototype.resume">
            function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>resume
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_base64.prototype.setEncoding">
            function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>setEncoding
            <span class="apidocSignatureSpan">(encoding)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_base64.prototype.uncork">
            function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>uncork
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_base64.prototype.unpipe">
            function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>unpipe
            <span class="apidocSignatureSpan">(destination)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_base64.prototype.unshift">
            function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>unshift
            <span class="apidocSignatureSpan">(chunk)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_base64.prototype.wrap">
            function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>wrap
            <span class="apidocSignatureSpan">(stream)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_base64.prototype.write">
            function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>write
            <span class="apidocSignatureSpan">(data, encoding, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.stream_buf">module exceljs.stream_buf</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_buf.stream_buf">
            function <span class="apidocSignatureSpan">exceljs.</span>stream_buf
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_buf.super_">
            function <span class="apidocSignatureSpan">exceljs.stream_buf.</span>super_
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.stream_buf.prototype">module exceljs.stream_buf.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_buf.prototype._flush">
            function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>_flush
            <span class="apidocSignatureSpan">(destination)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_buf.prototype._getWritableBuffer">
            function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>_getWritableBuffer
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_buf.prototype._pipe">
            function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>_pipe
            <span class="apidocSignatureSpan">(chunk)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_buf.prototype._writeToBuffers">
            function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>_writeToBuffers
            <span class="apidocSignatureSpan">(chunk)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_buf.prototype.cork">
            function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>cork
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_buf.prototype.end">
            function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>end
            <span class="apidocSignatureSpan">(chunk, encoding, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_buf.prototype.isPaused">
            function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>isPaused
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_buf.prototype.pause">
            function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>pause
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_buf.prototype.pipe">
            function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>pipe
            <span class="apidocSignatureSpan">(destination, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_buf.prototype.read">
            function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>read
            <span class="apidocSignatureSpan">(size)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_buf.prototype.resume">
            function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>resume
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_buf.prototype.setEncoding">
            function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>setEncoding
            <span class="apidocSignatureSpan">(encoding)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_buf.prototype.uncork">
            function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>uncork
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_buf.prototype.unpipe">
            function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>unpipe
            <span class="apidocSignatureSpan">(destination)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_buf.prototype.unshift">
            function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>unshift
            <span class="apidocSignatureSpan">(chunk)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_buf.prototype.wrap">
            function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>wrap
            <span class="apidocSignatureSpan">(stream)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_buf.prototype.write">
            function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>write
            <span class="apidocSignatureSpan">(data, encoding, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.stream_converter">module exceljs.stream_converter</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_converter.stream_converter">
            function <span class="apidocSignatureSpan">exceljs.</span>stream_converter
            <span class="apidocSignatureSpan">(inner, options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.stream_converter.prototype">module exceljs.stream_converter.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_converter.prototype.addListener">
            function <span class="apidocSignatureSpan">exceljs.stream_converter.prototype.</span>addListener
            <span class="apidocSignatureSpan">(event, handler)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_converter.prototype.close">
            function <span class="apidocSignatureSpan">exceljs.stream_converter.prototype.</span>close
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_converter.prototype.convertInwards">
            function <span class="apidocSignatureSpan">exceljs.stream_converter.prototype.</span>convertInwards
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_converter.prototype.convertOutwards">
            function <span class="apidocSignatureSpan">exceljs.stream_converter.prototype.</span>convertOutwards
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_converter.prototype.emit">
            function <span class="apidocSignatureSpan">exceljs.stream_converter.prototype.</span>emit
            <span class="apidocSignatureSpan">(type, value)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_converter.prototype.end">
            function <span class="apidocSignatureSpan">exceljs.stream_converter.prototype.</span>end
            <span class="apidocSignatureSpan">(chunk, encoding, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_converter.prototype.on">
            function <span class="apidocSignatureSpan">exceljs.stream_converter.prototype.</span>on
            <span class="apidocSignatureSpan">(type, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_converter.prototype.once">
            function <span class="apidocSignatureSpan">exceljs.stream_converter.prototype.</span>once
            <span class="apidocSignatureSpan">(type, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_converter.prototype.pipe">
            function <span class="apidocSignatureSpan">exceljs.stream_converter.prototype.</span>pipe
            <span class="apidocSignatureSpan">(destination, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_converter.prototype.read">
            function <span class="apidocSignatureSpan">exceljs.stream_converter.prototype.</span>read
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_converter.prototype.removeListener">
            function <span class="apidocSignatureSpan">exceljs.stream_converter.prototype.</span>removeListener
            <span class="apidocSignatureSpan">(event, handler)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stream_converter.prototype.write">
            function <span class="apidocSignatureSpan">exceljs.stream_converter.prototype.</span>write
            <span class="apidocSignatureSpan">(data, encoding, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.string_buf">module exceljs.string_buf</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.string_buf.string_buf">
            function <span class="apidocSignatureSpan">exceljs.</span>string_buf
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.string_buf.prototype">module exceljs.string_buf.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.string_buf.prototype._grow">
            function <span class="apidocSignatureSpan">exceljs.string_buf.prototype.</span>_grow
            <span class="apidocSignatureSpan">(min)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.string_buf.prototype.addStringBuf">
            function <span class="apidocSignatureSpan">exceljs.string_buf.prototype.</span>addStringBuf
            <span class="apidocSignatureSpan">(inBuf)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.string_buf.prototype.addText">
            function <span class="apidocSignatureSpan">exceljs.string_buf.prototype.</span>addText
            <span class="apidocSignatureSpan">(text)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.string_buf.prototype.reset">
            function <span class="apidocSignatureSpan">exceljs.string_buf.prototype.</span>reset
            <span class="apidocSignatureSpan">(position)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.string_buf.prototype.toBuffer">
            function <span class="apidocSignatureSpan">exceljs.string_buf.prototype.</span>toBuffer
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">undefined <span class="apidocSignatureSpan">exceljs.string_buf.prototype.</span>buffer</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.string_builder">module exceljs.string_builder</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.string_builder.string_builder">
            function <span class="apidocSignatureSpan">exceljs.</span>string_builder
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.string_builder.prototype">module exceljs.string_builder.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.string_builder.prototype.addStringBuf">
            function <span class="apidocSignatureSpan">exceljs.string_builder.prototype.</span>addStringBuf
            <span class="apidocSignatureSpan">(inBuf)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.string_builder.prototype.addText">
            function <span class="apidocSignatureSpan">exceljs.string_builder.prototype.</span>addText
            <span class="apidocSignatureSpan">(text)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.string_builder.prototype.reset">
            function <span class="apidocSignatureSpan">exceljs.string_builder.prototype.</span>reset
            <span class="apidocSignatureSpan">(position)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.string_builder.prototype.toString">
            function <span class="apidocSignatureSpan">exceljs.string_builder.prototype.</span>toString
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.stuttered_pipe">module exceljs.stuttered_pipe</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stuttered_pipe.stuttered_pipe">
            function <span class="apidocSignatureSpan">exceljs.</span>stuttered_pipe
            <span class="apidocSignatureSpan">(readable, writable, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stuttered_pipe.super_">
            function <span class="apidocSignatureSpan">exceljs.stuttered_pipe.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.stuttered_pipe.prototype">module exceljs.stuttered_pipe.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stuttered_pipe.prototype._schedule">
            function <span class="apidocSignatureSpan">exceljs.stuttered_pipe.prototype.</span>_schedule
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stuttered_pipe.prototype.pause">
            function <span class="apidocSignatureSpan">exceljs.stuttered_pipe.prototype.</span>pause
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.stuttered_pipe.prototype.resume">
            function <span class="apidocSignatureSpan">exceljs.stuttered_pipe.prototype.</span>resume
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.typed_stack">module exceljs.typed_stack</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.typed_stack.typed_stack">
            function <span class="apidocSignatureSpan">exceljs.</span>typed_stack
            <span class="apidocSignatureSpan">(type)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.typed_stack.prototype">module exceljs.typed_stack.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.typed_stack.prototype.pop">
            function <span class="apidocSignatureSpan">exceljs.typed_stack.prototype.</span>pop
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.typed_stack.prototype.push">
            function <span class="apidocSignatureSpan">exceljs.typed_stack.prototype.</span>push
            <span class="apidocSignatureSpan">(instance)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.under_dash">module exceljs.under_dash</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.under_dash.each">
            function <span class="apidocSignatureSpan">exceljs.under_dash.</span>each
            <span class="apidocSignatureSpan">(obj, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.under_dash.every">
            function <span class="apidocSignatureSpan">exceljs.under_dash.</span>every
            <span class="apidocSignatureSpan">(obj, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.under_dash.isEqual">
            function <span class="apidocSignatureSpan">exceljs.under_dash.</span>isEqual
            <span class="apidocSignatureSpan">(a, b)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.under_dash.map">
            function <span class="apidocSignatureSpan">exceljs.under_dash.</span>map
            <span class="apidocSignatureSpan">(obj, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.under_dash.some">
            function <span class="apidocSignatureSpan">exceljs.under_dash.</span>some
            <span class="apidocSignatureSpan">(obj, cb)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.utils">module exceljs.utils</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.utils.dateToExcel">
            function <span class="apidocSignatureSpan">exceljs.utils.</span>dateToExcel
            <span class="apidocSignatureSpan">(d, date1904)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.utils.excelToDate">
            function <span class="apidocSignatureSpan">exceljs.utils.</span>excelToDate
            <span class="apidocSignatureSpan">(v, date1904)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.utils.getRelsPath">
            function <span class="apidocSignatureSpan">exceljs.utils.</span>getRelsPath
            <span class="apidocSignatureSpan">(filepath)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.utils.inherits">
            function <span class="apidocSignatureSpan">exceljs.utils.</span>inherits
            <span class="apidocSignatureSpan">(cls, superCtor, statics, prototype)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.utils.isDateFmt">
            function <span class="apidocSignatureSpan">exceljs.utils.</span>isDateFmt
            <span class="apidocSignatureSpan">(fmt)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.utils.nop">
            function <span class="apidocSignatureSpan">exceljs.utils.</span>nop
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.utils.parsePath">
            function <span class="apidocSignatureSpan">exceljs.utils.</span>parsePath
            <span class="apidocSignatureSpan">(filepath)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.utils.promiseImmediate">
            function <span class="apidocSignatureSpan">exceljs.utils.</span>promiseImmediate
            <span class="apidocSignatureSpan">(value)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.utils.toIsoDateString">
            function <span class="apidocSignatureSpan">exceljs.utils.</span>toIsoDateString
            <span class="apidocSignatureSpan">(dt)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.utils.validInt">
            function <span class="apidocSignatureSpan">exceljs.utils.</span>validInt
            <span class="apidocSignatureSpan">(value)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.utils.xmlDecode">
            function <span class="apidocSignatureSpan">exceljs.utils.</span>xmlDecode
            <span class="apidocSignatureSpan">(text)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.utils.xmlEncode">
            function <span class="apidocSignatureSpan">exceljs.utils.</span>xmlEncode
            <span class="apidocSignatureSpan">(text)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.utils.</span>fs</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.workbook_reader">module exceljs.workbook_reader</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_reader.workbook_reader">
            function <span class="apidocSignatureSpan">exceljs.</span>workbook_reader
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_reader.super_">
            function <span class="apidocSignatureSpan">exceljs.workbook_reader.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.workbook_reader.prototype">module exceljs.workbook_reader.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_reader.prototype._emitEntry">
            function <span class="apidocSignatureSpan">exceljs.workbook_reader.prototype.</span>_emitEntry
            <span class="apidocSignatureSpan">(options, payload)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_reader.prototype._getReader">
            function <span class="apidocSignatureSpan">exceljs.workbook_reader.prototype.</span>_getReader
            <span class="apidocSignatureSpan">(Type, collection, sheetNo)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_reader.prototype._getStream">
            function <span class="apidocSignatureSpan">exceljs.workbook_reader.prototype.</span>_getStream
            <span class="apidocSignatureSpan">(input)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_reader.prototype._parseHyperlinks">
            function <span class="apidocSignatureSpan">exceljs.workbook_reader.prototype.</span>_parseHyperlinks
            <span class="apidocSignatureSpan">(entry, sheetNo, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_reader.prototype._parseSharedStrings">
            function <span class="apidocSignatureSpan">exceljs.workbook_reader.prototype.</span>_parseSharedStrings
            <span class="apidocSignatureSpan">(entry, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_reader.prototype._parseStyles">
            function <span class="apidocSignatureSpan">exceljs.workbook_reader.prototype.</span>_parseStyles
            <span class="apidocSignatureSpan">(entry, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_reader.prototype._parseWorksheet">
            function <span class="apidocSignatureSpan">exceljs.workbook_reader.prototype.</span>_parseWorksheet
            <span class="apidocSignatureSpan">(entry, sheetNo, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_reader.prototype.read">
            function <span class="apidocSignatureSpan">exceljs.workbook_reader.prototype.</span>read
            <span class="apidocSignatureSpan">(input, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.workbook_reader.prototype.</span>_flowControl</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.workbook_reader.prototype.</span>flowControl</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.workbook_reader.prototype.</span>options</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.workbook_writer">module exceljs.workbook_writer</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_writer.workbook_writer">
            function <span class="apidocSignatureSpan">exceljs.</span>workbook_writer
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.workbook_writer.prototype">module exceljs.workbook_writer.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_writer.prototype._commitWorksheets">
            function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>_commitWorksheets
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_writer.prototype._finalize">
            function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>_finalize
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_writer.prototype._openStream">
            function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>_openStream
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_writer.prototype.addApp">
            function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>addApp
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_writer.prototype.addContentTypes">
            function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>addContentTypes
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_writer.prototype.addCore">
            function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>addCore
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_writer.prototype.addOfficeRels">
            function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>addOfficeRels
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_writer.prototype.addSharedStrings">
            function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>addSharedStrings
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_writer.prototype.addStyles">
            function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>addStyles
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_writer.prototype.addThemes">
            function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>addThemes
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_writer.prototype.addWorkbook">
            function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>addWorkbook
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_writer.prototype.addWorkbookRels">
            function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>addWorkbookRels
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_writer.prototype.addWorksheet">
            function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>addWorksheet
            <span class="apidocSignatureSpan">(name, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_writer.prototype.commit">
            function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>commit
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.workbook_writer.prototype.getWorksheet">
            function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>getWorksheet
            <span class="apidocSignatureSpan">(id)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.worksheet_reader">module exceljs.worksheet_reader</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_reader.worksheet_reader">
            function <span class="apidocSignatureSpan">exceljs.</span>worksheet_reader
            <span class="apidocSignatureSpan">(workbook, id)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_reader.super_">
            function <span class="apidocSignatureSpan">exceljs.worksheet_reader.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.worksheet_reader.prototype">module exceljs.worksheet_reader.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_reader.prototype._emitRow">
            function <span class="apidocSignatureSpan">exceljs.worksheet_reader.prototype.</span>_emitRow
            <span class="apidocSignatureSpan">(row)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_reader.prototype.destroy">
            function <span class="apidocSignatureSpan">exceljs.worksheet_reader.prototype.</span>destroy
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_reader.prototype.getColumn">
            function <span class="apidocSignatureSpan">exceljs.worksheet_reader.prototype.</span>getColumn
            <span class="apidocSignatureSpan">(c)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_reader.prototype.read">
            function <span class="apidocSignatureSpan">exceljs.worksheet_reader.prototype.</span>read
            <span class="apidocSignatureSpan">(entry, options, hyperlinkReader)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.worksheet_writer">module exceljs.worksheet_writer</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.worksheet_writer">
            function <span class="apidocSignatureSpan">exceljs.</span>worksheet_writer
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.worksheet_writer.prototype">module exceljs.worksheet_writer.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype._commitRow">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_commitRow
            <span class="apidocSignatureSpan">(cRow)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype._write">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_write
            <span class="apidocSignatureSpan">(text)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype._writeCloseSheetData">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writeCloseSheetData
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype._writeCloseWorksheet">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writeCloseWorksheet
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype._writeColumns">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writeColumns
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype._writeDataValidations">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writeDataValidations
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype._writeDimensions">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writeDimensions
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype._writeHyperlinks">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writeHyperlinks
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype._writeMergeCells">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writeMergeCells
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype._writeOpenSheetData">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writeOpenSheetData
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype._writeOpenWorksheet">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writeOpenWorksheet
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype._writePageMargins">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writePageMargins
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype._writePageSetup">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writePageSetup
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype._writeRow">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writeRow
            <span class="apidocSignatureSpan">(row)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype._writeSheetFormatProperties">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writeSheetFormatProperties
            <span class="apidocSignatureSpan">(xmlBuf, properties)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype._writeSheetProperties">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writeSheetProperties
            <span class="apidocSignatureSpan">(xmlBuf, properties, pageSetup)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype.addRow">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>addRow
            <span class="apidocSignatureSpan">(value)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype.commit">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>commit
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype.destroy">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>destroy
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype.eachRow">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>eachRow
            <span class="apidocSignatureSpan">(options, iteratee)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype.findCell">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>findCell
            <span class="apidocSignatureSpan">(r, c)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype.findRow">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>findRow
            <span class="apidocSignatureSpan">(rowNumber)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype.getCell">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>getCell
            <span class="apidocSignatureSpan">(r, c)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype.getColumn">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>getColumn
            <span class="apidocSignatureSpan">(c)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype.getRow">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>getRow
            <span class="apidocSignatureSpan">(rowNumber)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.worksheet_writer.prototype.mergeCells">
            function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>mergeCells
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.xlsx">module exceljs.xlsx</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.xlsx">
            function <span class="apidocSignatureSpan">exceljs.</span>xlsx
            <span class="apidocSignatureSpan">(workbook)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.xlsx.</span>RelType</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.xlsx.prototype">module exceljs.xlsx.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype._finalize">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>_finalize
            <span class="apidocSignatureSpan">(zip)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype.addApp">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>addApp
            <span class="apidocSignatureSpan">(zip, model)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype.addContentTypes">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>addContentTypes
            <span class="apidocSignatureSpan">(zip, model)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype.addCore">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>addCore
            <span class="apidocSignatureSpan">(zip, model)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype.addOfficeRels">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>addOfficeRels
            <span class="apidocSignatureSpan">(zip)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype.addSharedStrings">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>addSharedStrings
            <span class="apidocSignatureSpan">(zip, model)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype.addStyles">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>addStyles
            <span class="apidocSignatureSpan">(zip, model)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype.addThemes">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>addThemes
            <span class="apidocSignatureSpan">(zip, model)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype.addWorkbook">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>addWorkbook
            <span class="apidocSignatureSpan">(zip, model, xform)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype.addWorkbookRels">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>addWorkbookRels
            <span class="apidocSignatureSpan">(zip, model)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype.addWorksheets">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>addWorksheets
            <span class="apidocSignatureSpan">(zip, model, worksheetXform)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype.createInputStream">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>createInputStream
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype.load">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>load
            <span class="apidocSignatureSpan">(data, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype.parseRels">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>parseRels
            <span class="apidocSignatureSpan">(stream)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype.parseSharedStrings">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>parseSharedStrings
            <span class="apidocSignatureSpan">(stream)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype.parseWorkbook">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>parseWorkbook
            <span class="apidocSignatureSpan">(stream)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype.processIgnoreEntry">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>processIgnoreEntry
            <span class="apidocSignatureSpan">(entry)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype.processThemeEntry">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>processThemeEntry
            <span class="apidocSignatureSpan">(entry, model)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype.processWorksheetEntry">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>processWorksheetEntry
            <span class="apidocSignatureSpan">(entry, model)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype.processWorksheetRelsEntry">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>processWorksheetRelsEntry
            <span class="apidocSignatureSpan">(entry, model)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype.read">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>read
            <span class="apidocSignatureSpan">(stream)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype.readFile">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>readFile
            <span class="apidocSignatureSpan">(filename)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype.reconcile">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>reconcile
            <span class="apidocSignatureSpan">(model)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype.write">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>write
            <span class="apidocSignatureSpan">(stream, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype.writeBuffer">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>writeBuffer
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xlsx.prototype.writeFile">
            function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>writeFile
            <span class="apidocSignatureSpan">(filename, options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.xml_stream">module exceljs.xml_stream</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xml_stream.xml_stream">
            function <span class="apidocSignatureSpan">exceljs.</span>xml_stream
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">exceljs.xml_stream.</span>StdDocAttributes</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.xml_stream.prototype">module exceljs.xml_stream.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xml_stream.prototype.addAttribute">
            function <span class="apidocSignatureSpan">exceljs.xml_stream.prototype.</span>addAttribute
            <span class="apidocSignatureSpan">(name, value)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xml_stream.prototype.addAttributes">
            function <span class="apidocSignatureSpan">exceljs.xml_stream.prototype.</span>addAttributes
            <span class="apidocSignatureSpan">(attrs)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xml_stream.prototype.addRollback">
            function <span class="apidocSignatureSpan">exceljs.xml_stream.prototype.</span>addRollback
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xml_stream.prototype.closeAll">
            function <span class="apidocSignatureSpan">exceljs.xml_stream.prototype.</span>closeAll
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xml_stream.prototype.closeNode">
            function <span class="apidocSignatureSpan">exceljs.xml_stream.prototype.</span>closeNode
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xml_stream.prototype.commit">
            function <span class="apidocSignatureSpan">exceljs.xml_stream.prototype.</span>commit
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xml_stream.prototype.leafNode">
            function <span class="apidocSignatureSpan">exceljs.xml_stream.prototype.</span>leafNode
            <span class="apidocSignatureSpan">(name, attributes, text)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xml_stream.prototype.openNode">
            function <span class="apidocSignatureSpan">exceljs.xml_stream.prototype.</span>openNode
            <span class="apidocSignatureSpan">(name, attributes)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xml_stream.prototype.openXml">
            function <span class="apidocSignatureSpan">exceljs.xml_stream.prototype.</span>openXml
            <span class="apidocSignatureSpan">(docAttributes)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xml_stream.prototype.rollback">
            function <span class="apidocSignatureSpan">exceljs.xml_stream.prototype.</span>rollback
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xml_stream.prototype.writeText">
            function <span class="apidocSignatureSpan">exceljs.xml_stream.prototype.</span>writeText
            <span class="apidocSignatureSpan">(text)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.xml_stream.prototype.writeXml">
            function <span class="apidocSignatureSpan">exceljs.xml_stream.prototype.</span>writeXml
            <span class="apidocSignatureSpan">(xml)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.exceljs.zip_stream">module exceljs.zip_stream</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.zip_stream.ZipReader">
            function <span class="apidocSignatureSpan">exceljs.zip_stream.</span>ZipReader
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.exceljs.zip_stream.ZipWriter">
            function <span class="apidocSignatureSpan">exceljs.zip_stream.</span>ZipWriter
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs" id="apidoc.module.exceljs">module exceljs</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.ModelContainer" id="apidoc.element.exceljs.ModelContainer">
        function <span class="apidocSignatureSpan">exceljs.</span>ModelContainer
        <span class="apidocSignatureSpan">(model)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ModelContainer = function (model) {
  this.model = model;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.Workbook" id="apidoc.element.exceljs.Workbook">
        function <span class="apidocSignatureSpan">exceljs.</span>Workbook
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">Workbook = function () {
  this.created = new Date();
  this.modified = this.created;
  this.properties = {};
  this._worksheets = [];
  this.views = [];
  this._definedNames = new DefinedNames();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```javascript
var Excel = require(&#x27;exceljs&#x27;);
```

## Create a Workbook

```javascript
var workbook = new Excel.<span class="apidocCodeKeywordSpan">Workbook</span>();
```

## Set Workbook Properties

```javascript
workbook.creator = &#x27;Me&#x27;;
workbook.lastModifiedBy = &#x27;Her&#x27;;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.auto_drain" id="apidoc.element.exceljs.auto_drain">
        function <span class="apidocSignatureSpan">exceljs.</span>auto_drain
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">auto_drain = function () {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.base_xform" id="apidoc.element.exceljs.base_xform">
        function <span class="apidocSignatureSpan">exceljs.</span>base_xform
        <span class="apidocSignatureSpan">(model, name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">base_xform = function (model, name) {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.cell_matrix" id="apidoc.element.exceljs.cell_matrix">
        function <span class="apidocSignatureSpan">exceljs.</span>cell_matrix
        <span class="apidocSignatureSpan">(template)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">cell_matrix = function (template) {
  this.template = template;
  this.sheets = {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.composite_xform" id="apidoc.element.exceljs.composite_xform">
        function <span class="apidocSignatureSpan">exceljs.</span>composite_xform
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">composite_xform = function (options) {
  this.tag = options.tag;
  this.attrs = options.attrs;
  this.children = options.children;
  this.map = this.children.reduce(function(map, child) {
    var name = child.name || child.tag;
    var tag = child.tag || child.name;
    map[tag] = child;
    child.name = name;
    child.tag = tag;
    return map;
  }, {});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.csv" id="apidoc.element.exceljs.csv">
        function <span class="apidocSignatureSpan">exceljs.</span>csv
        <span class="apidocSignatureSpan">(workbook)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">csv = function (workbook) {
  this.workbook = workbook;
  this.worksheet = null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.flow_control" id="apidoc.element.exceljs.flow_control">
        function <span class="apidocSignatureSpan">exceljs.</span>flow_control
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">flow_control = function (options) {
  this.options = options = options || {};

  // Buffer queue
  this.queue = [];

  // Consumer streams
  this.pipes = [];

  // Down-stream flow-control instances
  this.children = [];

  // Up-stream flow-control instances
  this.parent = options.parent;

  // Ensure we don&#x27;t flush more than once at a time
  this.flushing = false;

  // determine timeout for flow control delays
  if (options.gc) {
    var gc = options.gc;
    if (gc.getTimeout) {
      this.getTimeout = gc.getTimeout;
    } else {
      // heap size below which we don&#x27;t bother delaying
      var threshold = gc.threshold !== undefined ? gc.threshold : 150000000;
      // convert from heapsize to ms timeout
      var divisor = gc.divisor !== undefined ? gc.divisor : 500000;
      this.getTimeout = function() {
        var memory = process.memoryUsage();
        var heapSize = memory.heapTotal;
        return (heapSize &#x3c; threshold) ? 0 : Math.floor(heapSize / divisor);
      };
    }
  } else {
    this.getTimeout = null;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.hyperlink_reader" id="apidoc.element.exceljs.hyperlink_reader">
        function <span class="apidocSignatureSpan">exceljs.</span>hyperlink_reader
        <span class="apidocSignatureSpan">(workbook, id)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hyperlink_reader = function (workbook, id) {
    // in a workbook, each sheet will have a number
    this.id = id;

    this._workbook = workbook;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.hyperlink_writer" id="apidoc.element.exceljs.hyperlink_writer">
        function <span class="apidocSignatureSpan">exceljs.</span>hyperlink_writer
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hyperlink_writer = function (options) {
  // in a workbook, each sheet will have a number
  this.id = options.id;

  // keep record of all hyperlinks
  this._hyperlinks = [];

  this._workbook = options.workbook;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.line_buffer" id="apidoc.element.exceljs.line_buffer">
        function <span class="apidocSignatureSpan">exceljs.</span>line_buffer
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">line_buffer = function (options) {
  events.EventEmitter.call(this);
  this.encoding = options.encoding;

  this.buffer = null;

  // part of cork/uncork
  this.corked = false;
  this.queue = [];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.list_xform" id="apidoc.element.exceljs.list_xform">
        function <span class="apidocSignatureSpan">exceljs.</span>list_xform
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">list_xform = function (options) {
  this.tag = options.tag;
  this.count = options.count;
  this.empty = options.empty;
  this.$count = options.$count || &#x27;count&#x27;;
  this.$ = options.$;
  this.childXform = options.childXform;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.shared_strings" id="apidoc.element.exceljs.shared_strings">
        function <span class="apidocSignatureSpan">exceljs.</span>shared_strings
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">shared_strings = function () {
  this._values = [];
  this._totalRefs = 0;
  this._hash = {}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.static_xform" id="apidoc.element.exceljs.static_xform">
        function <span class="apidocSignatureSpan">exceljs.</span>static_xform
        <span class="apidocSignatureSpan">(model)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">static_xform = function (model) {
  // This class is an optimisation for static (unimportant and unchanging) xml
  // It is stateless - apart from its static model and so can be used as a singleton
  // Being stateless - it will only track entry to and exit from it&#x27;s root xml tag during parsing and nothing else
  // Known issues:
  //    since stateless - parseOpen always returns true. Parent xform must know when to start using this xform
  //    if the root tag is recursive, the parsing will behave unpredictably
  this._model = model;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_base64" id="apidoc.element.exceljs.stream_base64">
        function <span class="apidocSignatureSpan">exceljs.</span>stream_base64
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">stream_base64 = function (options) {
  options = options || {};

  // consuming pipe streams go here
  this.pipes = [];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_buf" id="apidoc.element.exceljs.stream_buf">
        function <span class="apidocSignatureSpan">exceljs.</span>stream_buf
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">stream_buf = function (options) {
  options = options || {};
  this.bufSize = options.bufSize || 1024 * 1024;
  this.buffers = [];

  // batch mode fills a buffer completely before passing the data on
  // to pipes or &#x27;readable&#x27; event listeners
  this.batch = options.batch || false;

  this.corked = false;
  // where in the current writable buffer we&#x27;re up to
  this.inPos = 0;

  // where in the current readable buffer we&#x27;ve read up to
  this.outPos = 0;

  // consuming pipe streams go here
  this.pipes = [];

  // controls emit(&#x27;data&#x27;)
  this.paused = false;

  this.encoding = null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_converter" id="apidoc.element.exceljs.stream_converter">
        function <span class="apidocSignatureSpan">exceljs.</span>stream_converter
        <span class="apidocSignatureSpan">(inner, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">stream_converter = function (inner, options) {

    this.inner = inner;

    options = options || {};
    this.innerEncoding = (options.innerEncoding || &#x27;UTF8&#x27;).toUpperCase();
    this.outerEncoding = (options.outerEncoding || &#x27;UTF8&#x27;).toUpperCase();

    this.innerBOM = options.innerBOM || null;
    this.outerBOM = options.outerBOM || null;

    this.writeStarted = false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.string_buf" id="apidoc.element.exceljs.string_buf">
        function <span class="apidocSignatureSpan">exceljs.</span>string_buf
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">string_buf = function (options) {
  this._buf = new Buffer((options &#x26;&#x26; options.size) || 16384);
  this._encoding = (options &#x26;&#x26; options.encoding) || &#x27;utf8&#x27;;

  // where in the buffer we are at
  this._inPos = 0;

  // for use by toBuffer()
  this._buffer = undefined;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.string_builder" id="apidoc.element.exceljs.string_builder">
        function <span class="apidocSignatureSpan">exceljs.</span>string_builder
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">string_builder = function (options) {
  this.reset();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stuttered_pipe" id="apidoc.element.exceljs.stuttered_pipe">
        function <span class="apidocSignatureSpan">exceljs.</span>stuttered_pipe
        <span class="apidocSignatureSpan">(readable, writable, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">stuttered_pipe = function (readable, writable, options) {
  var self = this;
  options = options || {};

  this.readable = readable;
  this.writable = writable;
  this.bufSize = options.bufSize || 16384;
  this.autoPause = options.autoPause || false;

  this.paused = false;
  this.eod = false;
  this.scheduled = null;

  readable.on(&#x27;end&#x27;, function() {
    self.eod = true;
    writable.end();
  });

  // need to have some way to communicate speed of stream
  // back from the consumer
  readable.on(&#x27;readable&#x27;, function() {
    if (!self.paused) {
      self.resume();
    }
  });
  this._schedule();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.typed_stack" id="apidoc.element.exceljs.typed_stack">
        function <span class="apidocSignatureSpan">exceljs.</span>typed_stack
        <span class="apidocSignatureSpan">(type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">typed_stack = function (type) {
  this._type = type;
  this._stack = [];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.workbook_reader" id="apidoc.element.exceljs.workbook_reader">
        function <span class="apidocSignatureSpan">exceljs.</span>workbook_reader
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">workbook_reader = function (options) {
  this.options = options = options || {};

  // until we actually parse a styles.xml file, just assume we&#x27;re not handling styles
  // (but we do need to handle dates)
  this.styles = new StyleManager.Mock();

  // worksheet readers, indexed by sheetNo
  this.worksheetReaders = {};

  // hyperlink readers, indexed by sheetNo
  this.hyperlinkReaders = {};

  // count the open readers
  this.readers = 0;

  // end of stream check
  this.atEnd = false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.workbook_writer" id="apidoc.element.exceljs.workbook_writer">
        function <span class="apidocSignatureSpan">exceljs.</span>workbook_writer
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">workbook_writer = function (options) {
  options = options || {};

  this.created = options.created || new Date();
  this.modified = options.modified || this.created;
  this.creator = options.creator || &#x27;ExcelJS&#x27;;
  this.lastModifiedBy = options.lastModifiedBy || &#x27;ExcelJS&#x27;;
  this.lastPrinted = options.lastPrinted;

  // using shared strings creates a smaller xlsx file but may use more memory
  this.useSharedStrings = options.useSharedStrings || false;
  this.sharedStrings = new SharedStrings();

  // style manager
  this.styles = options.useStyles ? new StylesXform(true) : new StylesXform.Mock(true);

  // defined names
  this._definedNames = new DefinedNames();

  this._worksheets = [];
  this.views = [];

  this.zip = Archiver(&#x27;zip&#x27;);
  if (options.stream) {
    this.stream = options.stream;
  } else if (options.filename) {
    this.stream = fs.createWriteStream(options.filename);
  } else {
    this.stream = new StreamBuf();
  }
  this.zip.pipe(this.stream);

  // these bits can be added right now
  this.promise = PromishLib.Promish.all([
    this.addThemes(),
    this.addOfficeRels()
  ]);

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_reader" id="apidoc.element.exceljs.worksheet_reader">
        function <span class="apidocSignatureSpan">exceljs.</span>worksheet_reader
        <span class="apidocSignatureSpan">(workbook, id)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">worksheet_reader = function (workbook, id) {
  this.workbook = workbook;
  this.id = id;

  // and a name
  this.name = &#x27;Sheet&#x27; + this.id;

  // column definitions
  this._columns = null;
  this._keys = {};

  // keep a record of dimensions
  this._dimensions = new Dimensions();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer" id="apidoc.element.exceljs.worksheet_writer">
        function <span class="apidocSignatureSpan">exceljs.</span>worksheet_writer
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">worksheet_writer = function (options) {
  // in a workbook, each sheet will have a number
  this.id = options.id;

  // and a name
  this.name = options.name || &#x27;Sheet&#x27; + this.id;

  // rows are stored here while they need to be worked on.
  // when they are committed, they will be deleted.
  this._rows = [];

  // column definitions
  this._columns = null;

  // column keys (addRow convenience): key ==&#x3e; this._columns index
  this._keys = {};

  // keep record of all merges
  this._merges = [];
  this._merges.add = function() {}; // ignore cell instruction

  // keep record of all hyperlinks
  this._hyperlinkWriter = new HyperlinkWriter(options);

  // keep a record of dimensions
  this._dimensions = new Dimensions();

  // first uncommitted row
  this._rowZero = 1;

  // committed flag
  this.committed = false;

  // for data validations
  this.dataValidations = new DataValidations();

  // for sharing formulae
  this._formulae = {};
  this._siFormulae = 0;

  // for default row height, outline levels, etc
  this.properties = Object.assign({}, {
    defaultRowHeight: 15,
    dyDescent: 55,
    outlineLevelCol: 0,
    outlineLevelRow: 0
  }, options.properties);

  // for all things printing
  this.pageSetup = Object.assign({}, {
    margins: {left: 0.7, right: 0.7, top: 0.75, bottom: 0.75, header: 0.3, footer:  0.3 },
    orientation: &#x27;portrait&#x27;,
    horizontalDpi: 4294967295,
    verticalDpi: 4294967295,
    fitToPage: !!(options.pageSetup &#x26;&#x26; ((options.pageSetup.fitToWidth || options.pageSetup.fitToHeight) &#x26;&#x26; !options.pageSetup.scale
)),
    pageOrder: &#x27;downThenOver&#x27;,
    blackAndWhite: false,
    draft: false,
    cellComments: &#x27;None&#x27;,
    errors: &#x27;displayed&#x27;,
    scale: 100,
    fitToWidth: 1,
    fitToHeight: 1,
    paperSize: undefined,
    showRowColHeaders: false,
    showGridLines: false,
    horizontalCentered: false,
    verticalCentered: false,
    rowBreaks: null,
    colBreaks: null
  }, options.pageSetup);

  // using shared strings creates a smaller xlsx file but may use more memory
  this.useSharedStrings = options.useSharedStrings || false;

  this._workbook = options.workbook;

  // views
  this._views = options.views || [];

  // start writing to stream now
  this._writeOpenWorksheet();

  this.startedData = false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx" id="apidoc.element.exceljs.xlsx">
        function <span class="apidocSignatureSpan">exceljs.</span>xlsx
        <span class="apidocSignatureSpan">(workbook)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">xlsx = function (workbook) {
  this.workbook = workbook;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xml_stream" id="apidoc.element.exceljs.xml_stream">
        function <span class="apidocSignatureSpan">exceljs.</span>xml_stream
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">xml_stream = function () {
  this._xml = [];
  this._stack = [];
  this._rollbacks = [];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>






















































































</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.Workbook" id="apidoc.module.exceljs.Workbook">module exceljs.Workbook</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.Workbook.Workbook" id="apidoc.element.exceljs.Workbook.Workbook">
        function <span class="apidocSignatureSpan">exceljs.</span>Workbook
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">Workbook = function () {
  this.created = new Date();
  this.modified = this.created;
  this.properties = {};
  this._worksheets = [];
  this.views = [];
  this._definedNames = new DefinedNames();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```javascript
var Excel = require(&#x27;exceljs&#x27;);
```

## Create a Workbook

```javascript
var workbook = new Excel.<span class="apidocCodeKeywordSpan">Workbook</span>();
```

## Set Workbook Properties

```javascript
workbook.creator = &#x27;Me&#x27;;
workbook.lastModifiedBy = &#x27;Her&#x27;;
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.Workbook.prototype" id="apidoc.module.exceljs.Workbook.prototype">module exceljs.Workbook.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.Workbook.prototype._removeWorksheet" id="apidoc.element.exceljs.Workbook.prototype._removeWorksheet">
        function <span class="apidocSignatureSpan">exceljs.Workbook.prototype.</span>_removeWorksheet
        <span class="apidocSignatureSpan">(worksheet)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_removeWorksheet = function (worksheet) {
  delete this._worksheets[worksheet.id];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

get workbook() {
  return this._workbook;
},

// when you&#x27;re done with this worksheet, call this to remove from workbook
destroy: function destroy() {
  this._workbook.<span class="apidocCodeKeywordSpan">_removeWorksheet</span>(this);
},

// Get the bounding range of the cells in this worksheet
get dimensions() {
  var dimensions = new Range();
  this._rows.forEach(function (row) {
    if (row) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.Workbook.prototype.addWorksheet" id="apidoc.element.exceljs.Workbook.prototype.addWorksheet">
        function <span class="apidocSignatureSpan">exceljs.Workbook.prototype.</span>addWorksheet
        <span class="apidocSignatureSpan">(name, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addWorksheet = function (name, options) {

  var id = this.nextId;
  name = name || &#x27;sheet&#x27; + id;

  // if options is a color, call it tabColor (and signal deprecated message)
  if (options) {
    if (typeof options === &#x27;string&#x27;) {
      console.trace(&#x27;tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb
: &#x22;rbg value&#x22; } }&#x27;);
      options = {
        properties: {
          tabColor: {argb: options}
        }
      };
    } else if (options.argb || options.theme || options.indexed) {
      console.trace(&#x27;tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }&#x27;);
      options = {
        properties: {
          tabColor: options
        }
      };
    }
  }

  var worksheetOptions = Object.assign({}, options, {
    id: id,
    name: name,
    workbook: this
  });

  var worksheet = new Worksheet(worksheetOptions);

  this._worksheets[id] = worksheet;
  return worksheet;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  }
]
```

## Add a Worksheet

```javascript
var sheet = workbook.<span class="apidocCodeKeywordSpan">addWorksheet</span>(&#x27;My Sheet&#x27;);
```

Use the second parameter of the addWorksheet function to specify options for the worksheet.

For Example:

```javascript
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.Workbook.prototype.clearThemes" id="apidoc.element.exceljs.Workbook.prototype.clearThemes">
        function <span class="apidocSignatureSpan">exceljs.Workbook.prototype.</span>clearThemes
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">clearThemes = function () {
  // Note: themes are not an exposed feature, meddle at your peril!
  this._themes = undefined;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.Workbook.prototype.eachSheet" id="apidoc.element.exceljs.Workbook.prototype.eachSheet">
        function <span class="apidocSignatureSpan">exceljs.Workbook.prototype.</span>eachSheet
        <span class="apidocSignatureSpan">(iteratee)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">eachSheet = function (iteratee) {
  this._worksheets.forEach(function(sheet) {
    iteratee(sheet, sheet.id);
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var sheet = workbook.addWorksheet(&#x27;My Sheet&#x27;, {views:[{xSplit: 1, ySplit:1}]});
```

## Access Worksheets
```javascript
// Iterate over all sheets
// Note: workbook.worksheets.forEach will still work but this is better
workbook.<span class="apidocCodeKeywordSpan">eachSheet</span>(function(worksheet, sheetId) {
    // ...
});

// fetch sheet by name
var worksheet = workbook.getWorksheet(&#x27;My Sheet&#x27;);

// fetch sheet by id
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.Workbook.prototype.getWorksheet" id="apidoc.element.exceljs.Workbook.prototype.getWorksheet">
        function <span class="apidocSignatureSpan">exceljs.Workbook.prototype.</span>getWorksheet
        <span class="apidocSignatureSpan">(id)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getWorksheet = function (id) {
  if (id === undefined) {
    return this._worksheets.find(function(worksheet) { return worksheet; });
  } else if (typeof(id) === &#x27;number&#x27;) {
    return this._worksheets[id];
  } else if (typeof id === &#x27;string&#x27;) {
    return this._worksheets.find(function(worksheet) {
      return worksheet &#x26;&#x26; worksheet.name == id;
    });
  } else {
    return undefined;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// Iterate over all sheets
// Note: workbook.worksheets.forEach will still work but this is better
workbook.eachSheet(function(worksheet, sheetId) {
    // ...
});

// fetch sheet by name
var worksheet = workbook.<span class="apidocCodeKeywordSpan">getWorksheet</span>(&#x27;My Sheet&#x27;);

// fetch sheet by id
var worksheet = workbook.getWorksheet(1);
```

## Worksheet Properties
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.Workbook.prototype.removeWorksheet" id="apidoc.element.exceljs.Workbook.prototype.removeWorksheet">
        function <span class="apidocSignatureSpan">exceljs.Workbook.prototype.</span>removeWorksheet
        <span class="apidocSignatureSpan">(id)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">removeWorksheet = function (id) {
  var worksheet = this.getWorksheet(id);
  if (worksheet) {
    worksheet.destroy();
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>










</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.auto_drain" id="apidoc.module.exceljs.auto_drain">module exceljs.auto_drain</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.auto_drain.auto_drain" id="apidoc.element.exceljs.auto_drain.auto_drain">
        function <span class="apidocSignatureSpan">exceljs.</span>auto_drain
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">auto_drain = function () {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.auto_drain.super_" id="apidoc.element.exceljs.auto_drain.super_">
        function <span class="apidocSignatureSpan">exceljs.auto_drain.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.auto_drain.prototype" id="apidoc.module.exceljs.auto_drain.prototype">module exceljs.auto_drain.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.auto_drain.prototype.end" id="apidoc.element.exceljs.auto_drain.prototype.end">
        function <span class="apidocSignatureSpan">exceljs.auto_drain.prototype.</span>end
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">end = function () {
  this.emit(&#x27;end&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      }
      var values = row.values;
      values.shift();
      csvStream.write(values.map(map));
      lastRow = rowNumber;
    });
  }
  csvStream.<span class="apidocCodeKeywordSpan">end</span>();
});
  },
  writeFile: function writeFile(filename, options) {
options = options || {};

var streamOptions = {
  encoding: options.encoding || &#x27;utf8&#x27;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.auto_drain.prototype.write" id="apidoc.element.exceljs.auto_drain.prototype.write">
        function <span class="apidocSignatureSpan">exceljs.auto_drain.prototype.</span>write
        <span class="apidocSignatureSpan">(chunk)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">write = function (chunk) {
  this.emit(&#x27;data&#x27;, chunk);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var workbook = createAndFillWorkbook();
workbook.xlsx.writeFile(filename)
    .then(function() {
        // done
    });

// write to a stream
workbook.xlsx.<span class="apidocCodeKeywordSpan">write</span>(stream)
    .then(function() {
        // done
    });
```

### CSV
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.base_xform" id="apidoc.module.exceljs.base_xform">module exceljs.base_xform</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.base_xform.base_xform" id="apidoc.element.exceljs.base_xform.base_xform">
        function <span class="apidocSignatureSpan">exceljs.</span>base_xform
        <span class="apidocSignatureSpan">(model, name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">base_xform = function (model, name) {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.base_xform.prototype" id="apidoc.module.exceljs.base_xform.prototype">module exceljs.base_xform.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.base_xform.prototype.parse" id="apidoc.element.exceljs.base_xform.prototype.parse">
        function <span class="apidocSignatureSpan">exceljs.base_xform.prototype.</span>parse
        <span class="apidocSignatureSpan">(parser)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parse = function (parser) {
  var self = this;
  return new PromishLib.Promish(function(resolve, reject){
    parser.on(&#x27;opentag&#x27;, function(node) {
      self.parseOpen(node);
    });
    parser.on(&#x27;text&#x27;, function(text) {
      self.parseText(text);
    });
    parser.on(&#x27;closetag&#x27;, function(name) {
      if (!self.parseClose(name)) {
        resolve(self.model);
      }
    });
    parser.on(&#x27;end&#x27;, function() {
      resolve(self.model);
    });
    parser.on(&#x27;error&#x27;, function(error) {
      reject(error);
    });
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
                // column 1 is string
                return value;
            case 1:
                // column 2 is a date
                return new Date(value);
            case 2:
                // column 3 is JSON of a formula value
                return JSON.<span class="apidocCodeKeywordSpan">parse</span>(value);
            default:
                // the rest are numbers
                return parseFloat(value);
        }
    }
};
workbook.csv.readFile(filename, options)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.base_xform.prototype.parseClose" id="apidoc.element.exceljs.base_xform.prototype.parseClose">
        function <span class="apidocSignatureSpan">exceljs.base_xform.prototype.</span>parseClose
        <span class="apidocSignatureSpan">(name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parseClose = function (name) {
  // Sax Close Node event
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
parser.on(&#x27;opentag&#x27;, function (node) {
  self.parseOpen(node);
});
parser.on(&#x27;text&#x27;, function (text) {
  self.parseText(text);
});
parser.on(&#x27;closetag&#x27;, function (name) {
  if (!self.<span class="apidocCodeKeywordSpan">parseClose</span>(name)) {
    resolve(self.model);
  }
});
parser.on(&#x27;end&#x27;, function () {
  resolve(self.model);
});
parser.on(&#x27;error&#x27;, function (error) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.base_xform.prototype.parseOpen" id="apidoc.element.exceljs.base_xform.prototype.parseOpen">
        function <span class="apidocSignatureSpan">exceljs.base_xform.prototype.</span>parseOpen
        <span class="apidocSignatureSpan">(node)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parseOpen = function (node) {
  // Sax Open Node event
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  // to make sure parses don&#x27;t bleed to next iteration
  this.model = model;
},
parse: function parse(parser) {
  var self = this;
  return new PromishLib.Promish(function (resolve, reject) {
    parser.on(&#x27;opentag&#x27;, function (node) {
      self.<span class="apidocCodeKeywordSpan">parseOpen</span>(node);
    });
    parser.on(&#x27;text&#x27;, function (text) {
      self.parseText(text);
    });
    parser.on(&#x27;closetag&#x27;, function (name) {
      if (!self.parseClose(name)) {
        resolve(self.model);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.base_xform.prototype.parseStream" id="apidoc.element.exceljs.base_xform.prototype.parseStream">
        function <span class="apidocSignatureSpan">exceljs.base_xform.prototype.</span>parseStream
        <span class="apidocSignatureSpan">(stream)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parseStream = function (stream) {
  var parser = Sax.createStream(true, {});
  var promise = this.parse(parser);
  stream.pipe(parser);
  return promise;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    .then(function (workbook) {
      stream.close();
      return workbook;
    });
},
parseRels: function (stream) {
  var xform = new RelationshipsXform();
  return xform.<span class="apidocCodeKeywordSpan">parseStream</span>(stream);
},
parseWorkbook: function (stream) {
  var xform = new WorkbookXform();
  return xform.parseStream(stream);
},
parseSharedStrings: function (stream) {
  var xform = new SharedStringsXform();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.base_xform.prototype.parseText" id="apidoc.element.exceljs.base_xform.prototype.parseText">
        function <span class="apidocSignatureSpan">exceljs.base_xform.prototype.</span>parseText
        <span class="apidocSignatureSpan">(node)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parseText = function (node) {
  // Sax Text event
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  parse: function parse(parser) {
var self = this;
return new PromishLib.Promish(function (resolve, reject) {
  parser.on(&#x27;opentag&#x27;, function (node) {
    self.parseOpen(node);
  });
  parser.on(&#x27;text&#x27;, function (text) {
    self.<span class="apidocCodeKeywordSpan">parseText</span>(text);
  });
  parser.on(&#x27;closetag&#x27;, function (name) {
    if (!self.parseClose(name)) {
      resolve(self.model);
    }
  });
  parser.on(&#x27;end&#x27;, function () {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.base_xform.prototype.prepare" id="apidoc.element.exceljs.base_xform.prototype.prepare">
        function <span class="apidocSignatureSpan">exceljs.base_xform.prototype.</span>prepare
        <span class="apidocSignatureSpan">(model, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">prepare = function (model, options) {
  // optional preparation (mutation) of model so it is ready for write
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

utils.inherits(ListXform, BaseXform, {
prepare: function prepare(model, options) {
  var childXform = this.childXform;
  if (model) {
    model.forEach(function (childModel) {
      childXform.<span class="apidocCodeKeywordSpan">prepare</span>(childModel, options);
    });
  }
},

render: function render(xmlStream, model) {
  if (model &#x26;&#x26; model.length) {
    xmlStream.openNode(this.tag, this.$);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.base_xform.prototype.reconcile" id="apidoc.element.exceljs.base_xform.prototype.reconcile">
        function <span class="apidocSignatureSpan">exceljs.base_xform.prototype.</span>reconcile
        <span class="apidocSignatureSpan">(model, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">reconcile = function (model, options) {
  // optional post-parse step (opposite to prepare)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      return false;
    }
  },
  reconcile: function reconcile(model, options) {
    if (model) {
      var childXform = this.childXform;
      model.forEach(function (childModel) {
        childXform.<span class="apidocCodeKeywordSpan">reconcile</span>(childModel, options);
      });
    }
  }
});


},{&#x22;../../utils/utils&#x22;:20,&#x22;./base-xform&#x22;:25}],39:[function(require,module,exports){
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.base_xform.prototype.render" id="apidoc.element.exceljs.base_xform.prototype.render">
        function <span class="apidocSignatureSpan">exceljs.base_xform.prototype.</span>render
        <span class="apidocSignatureSpan">(xmlStream, model)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">render = function (xmlStream, model) {
  // convert model to xml
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    // convenience function to get the xml of this.model
    // useful for manager types that are built during the prepare phase
    return this.toXml(this.model);
  },

  toXml: function toXml(model) {
    var xmlStream = new XmlStream();
    this.<span class="apidocCodeKeywordSpan">render</span>(xmlStream, model);
    return xmlStream.xml;
  }
};


},{&#x22;../../utils/promish&#x22;:15,&#x22;../../utils/xml-stream&#x22;:21,&#x22;sax&#x22;:188}],26:[function(require,module,exports
){
/**
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.base_xform.prototype.reset" id="apidoc.element.exceljs.base_xform.prototype.reset">
        function <span class="apidocSignatureSpan">exceljs.base_xform.prototype.</span>reset
        <span class="apidocSignatureSpan">(model)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">reset = function (model) {
  // to make sure parses don&#x27;t bleed to next iteration
  this.model = model;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
},

parseOpen: function parseOpen(node) {
  if (this.parser) {
    this.parser.parseOpen(node);
    return true;
  } else if (node.name === this.tag) {
    this.map.tabColor.<span class="apidocCodeKeywordSpan">reset</span>();
    this.map.pageSetUpPr.reset();
    return true;
  } else if (this.map[node.name]) {
    this.parser = this.map[node.name];
    this.parser.parseOpen(node);
    return true;
  } else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.base_xform.prototype.toXml" id="apidoc.element.exceljs.base_xform.prototype.toXml">
        function <span class="apidocSignatureSpan">exceljs.base_xform.prototype.</span>toXml
        <span class="apidocSignatureSpan">(model)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toXml = function (model) {
  var xmlStream = new XmlStream();
  this.render(xmlStream, model);
  return xmlStream.xml;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  stream.pipe(parser);
  return promise;
},

get xml() {
  // convenience function to get the xml of this.model
  // useful for manager types that are built during the prepare phase
  return this.<span class="apidocCodeKeywordSpan">toXml</span>(this.model);
},

toXml: function toXml(model) {
  var xmlStream = new XmlStream();
  this.render(xmlStream, model);
  return xmlStream.xml;
}
...</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.cell_matrix" id="apidoc.module.exceljs.cell_matrix">module exceljs.cell_matrix</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.cell_matrix.cell_matrix" id="apidoc.element.exceljs.cell_matrix.cell_matrix">
        function <span class="apidocSignatureSpan">exceljs.</span>cell_matrix
        <span class="apidocSignatureSpan">(template)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">cell_matrix = function (template) {
  this.template = template;
  this.sheets = {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.cell_matrix.prototype" id="apidoc.module.exceljs.cell_matrix.prototype">module exceljs.cell_matrix.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.cell_matrix.prototype.addCell" id="apidoc.element.exceljs.cell_matrix.prototype.addCell">
        function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>addCell
        <span class="apidocSignatureSpan">(addressStr)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addCell = function (addressStr) {
  this.addCellEx(colCache.decodeEx(addressStr));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  set model(value) {
    // value is [ { name, ranges }, ... ]
    var matrixMap = this.matrixMap = {};
    value.forEach(function (definedName) {
      var matrix = matrixMap[definedName.name] = new CellMatrix();
      definedName.ranges.forEach(function (rangeStr) {
        if (rangeRegexp.test(rangeStr.split(&#x27;!&#x27;).pop() || &#x27;&#x27;)) {
          matrix.<span class="apidocCodeKeywordSpan">addCell</span>(rangeStr);
        }
      });
    });
  }
};

//&#x3c;definedNames&#x3e;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.cell_matrix.prototype.addCellEx" id="apidoc.element.exceljs.cell_matrix.prototype.addCellEx">
        function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>addCellEx
        <span class="apidocSignatureSpan">(address)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addCellEx = function (address) {
  if (address.top) {
    for (var row = address.top; row &#x3c;= address.bottom; row++) {
      for (var col = address.left; col &#x3c;= address.right; col++) {
        this.getCellAt(address.sheetName, row, col);
      }
    }
  } else {
    this.findCellEx(address, true);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        var address = {
          sheetName: location.sheetName,
          address: colCache.n2l(col) + row,
          row: row,
          col: col
        };

        matrix.<span class="apidocCodeKeywordSpan">addCellEx</span>(address);
      }
    }
  } else {
    matrix.addCellEx(location);
  }
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.cell_matrix.prototype.findCell" id="apidoc.element.exceljs.cell_matrix.prototype.findCell">
        function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>findCell
        <span class="apidocSignatureSpan">(addressStr)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findCell = function (addressStr) {
  return this.findCellEx(colCache.decodeEx(addressStr), false);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
},
set address(value) {
  this.model.address = value;
},
_getTranslatedFormula: function _getTranslatedFormula() {
  if (!this._translatedFormula &#x26;&#x26; this.model.sharedFormula) {
    var worksheet = this.cell._row.worksheet;
    var master = worksheet.<span class="apidocCodeKeywordSpan">findCell</span>(this.model.sharedFormula);
    this._translatedFormula = master &#x26;&#x26; slideFormula(master.formula, master.address, this.model.address);
  }
  return this._translatedFormula;
},

toCsvString: function toCsvString() {
  return &#x27;&#x27; + (this.model.result || &#x27;&#x27;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.cell_matrix.prototype.findCellAt" id="apidoc.element.exceljs.cell_matrix.prototype.findCellAt">
        function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>findCellAt
        <span class="apidocSignatureSpan">(sheetName, rowNumber, colNumber)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findCellAt = function (sheetName, rowNumber, colNumber) {
  var sheet = this.sheets[sheetName];
  var row = sheet &#x26;&#x26; sheet[rowNumber];
  return row &#x26;&#x26; row[colNumber];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var sheetName = cell.sheetName;

var range = new Range(cell.row, cell.col, cell.row, cell.col, sheetName);
var x, y;

// grow vertical - only one col to worry about
function vGrow(y, edge) {
  var c = matrix.<span class="apidocCodeKeywordSpan">findCellAt</span>(sheetName, y, cell.col);
  if (!c || !c.mark) {
    return false;
  }
  range[edge] = y;
  c.mark = false;
  return true;
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.cell_matrix.prototype.findCellEx" id="apidoc.element.exceljs.cell_matrix.prototype.findCellEx">
        function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>findCellEx
        <span class="apidocSignatureSpan">(address, create)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findCellEx = function (address, create) {
  var sheet = this.findSheet(address, create);
  var row = this.findSheetRow(sheet, address, create);
  return this.findRowCell(row, address, create);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

// get all the names of a cell
getNames: function getNames(addressStr) {
  return this.getNamesEx(colCache.decodeEx(addressStr));
},
getNamesEx: function getNamesEx(address) {
  return _.map(this.matrixMap, function (matrix, name) {
    if (matrix.<span class="apidocCodeKeywordSpan">findCellEx</span>(address)) {
      return name;
    }
  }).filter(function (name) {
    return name;
  });
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.cell_matrix.prototype.findRowCell" id="apidoc.element.exceljs.cell_matrix.prototype.findRowCell">
        function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>findRowCell
        <span class="apidocSignatureSpan">(row, address, create)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findRowCell = function (row, address, create) {
  var col = address.col;
  if (row &#x26;&#x26; row[col]) {
    return row[col];
  }
  if (create) {
    return (row[col] = this.template ? Object.assign(address, JSON.parse(JSON.stringify(this.template))) : address);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
},
getCellEx: function getCellEx(address) {
  return this.findCellEx(address, true);
},
findCellEx: function findCellEx(address, create) {
  var sheet = this.findSheet(address, create);
  var row = this.findSheetRow(sheet, address, create);
  return this.<span class="apidocCodeKeywordSpan">findRowCell</span>(row, address, create);
},
getCellAt: function getCellAt(sheetName, rowNumber, colNumber) {
  var sheet = this.sheets[sheetName] || (this.sheets[sheetName] = []);
  var row = sheet[rowNumber] || (sheet[rowNumber] = []);
  return row[colNumber] || (row[colNumber] = {
    sheetName: sheetName,
    address: colCache.n2l(colNumber) + rowNumber,
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.cell_matrix.prototype.findSheet" id="apidoc.element.exceljs.cell_matrix.prototype.findSheet">
        function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>findSheet
        <span class="apidocSignatureSpan">(address, create)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findSheet = function (address, create) {
  var name = address.sheetName;
  if (this.sheets[name]) {
    return this.sheets[name];
  }
  if (create) {
    return (this.sheets[name] = []);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    this.findCellEx(address, true);
  }
},
getCellEx: function getCellEx(address) {
  return this.findCellEx(address, true);
},
findCellEx: function findCellEx(address, create) {
  var sheet = this.<span class="apidocCodeKeywordSpan">findSheet</span>(address, create);
  var row = this.findSheetRow(sheet, address, create);
  return this.findRowCell(row, address, create);
},
getCellAt: function getCellAt(sheetName, rowNumber, colNumber) {
  var sheet = this.sheets[sheetName] || (this.sheets[sheetName] = []);
  var row = sheet[rowNumber] || (sheet[rowNumber] = []);
  return row[colNumber] || (row[colNumber] = {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.cell_matrix.prototype.findSheetRow" id="apidoc.element.exceljs.cell_matrix.prototype.findSheetRow">
        function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>findSheetRow
        <span class="apidocSignatureSpan">(sheet, address, create)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findSheetRow = function (sheet, address, create) {
  var row = address.row;
  if (sheet &#x26;&#x26; sheet[row]) {
    return sheet[row];
  }
  if (create) {
    return (sheet[row] = []);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  }
},
getCellEx: function getCellEx(address) {
  return this.findCellEx(address, true);
},
findCellEx: function findCellEx(address, create) {
  var sheet = this.findSheet(address, create);
  var row = this.<span class="apidocCodeKeywordSpan">findSheetRow</span>(sheet, address, create);
  return this.findRowCell(row, address, create);
},
getCellAt: function getCellAt(sheetName, rowNumber, colNumber) {
  var sheet = this.sheets[sheetName] || (this.sheets[sheetName] = []);
  var row = sheet[rowNumber] || (sheet[rowNumber] = []);
  return row[colNumber] || (row[colNumber] = {
    sheetName: sheetName,
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.cell_matrix.prototype.forEach" id="apidoc.element.exceljs.cell_matrix.prototype.forEach">
        function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>forEach
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">forEach = function (callback) {
  _.each(this.sheets, function(sheet) {
    if (sheet) sheet.forEach(function(row) {
      if (row) row.forEach(function(cell) {
        if (cell) callback(cell);
      });
    });
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
get names() {
  return this.workbook.definedNames.getNamesEx(this.fullAddress);
},
set names(value) {
  var self = this;
  var definedNames = this.workbook.definedNames;
  this.workbook.definedNames.removeAllNames(self.fullAddress);
  value.<span class="apidocCodeKeywordSpan">forEach</span>(function (name) {
    definedNames.addEx(self.fullAddress, name);
  });
},
addName: function addName(name) {
  this.workbook.definedNames.addEx(this.fullAddress, name);
},
removeName: function removeName(name) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.cell_matrix.prototype.getCell" id="apidoc.element.exceljs.cell_matrix.prototype.getCell">
        function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>getCell
        <span class="apidocSignatureSpan">(addressStr)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getCell = function (addressStr) {
  return this.findCellEx(colCache.decodeEx(addressStr), true);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
worksheet.getRow(5).outlineLevel = 1;

// rows support a readonly field to indicate the collapsed state based on outlineLevel
expect(worksheet.getRow(4).collapsed).to.equal(false);
expect(worksheet.getRow(5).collapsed).to.equal(true);


row.<span class="apidocCodeKeywordSpan">getCell</span>(1).value = 5; // A5&#x27;s value set to 5
row.getCell(&#x27;name&#x27;).value = &#x27;Zeb&#x27;; // B5&#x27;s value set to &#x27;Zeb&#x27; - assuming column 2 is still keyed
 by name
row.getCell(&#x27;C&#x27;).value = new Date(); // C5&#x27;s value set to now

// Get a row as a sparse array
// Note: interface change: worksheet.getRow(4) ==&#x3e; worksheet.getRow(4).values
row = worksheet.getRow(4).values;
expect(row[5]).toEqual(&#x27;Kyle&#x27;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.cell_matrix.prototype.getCellAt" id="apidoc.element.exceljs.cell_matrix.prototype.getCellAt">
        function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>getCellAt
        <span class="apidocSignatureSpan">(sheetName, rowNumber, colNumber)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getCellAt = function (sheetName, rowNumber, colNumber) {
  var sheet = this.sheets[sheetName] || (this.sheets[sheetName] = []);
  var row = sheet[rowNumber] || (sheet[rowNumber] = []);
  return row[colNumber] || (row[colNumber] = {
    sheetName: sheetName,
    address: colCache.n2l(colNumber) + rowNumber,
    row: rowNumber,
    col: colNumber
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  var row = sheet &#x26;&#x26; sheet[rowNumber];
  return row &#x26;&#x26; row[colNumber];
},
addCellEx: function addCellEx(address) {
  if (address.top) {
    for (var row = address.top; row &#x3c;= address.bottom; row++) {
      for (var col = address.left; col &#x3c;= address.right; col++) {
        this.<span class="apidocCodeKeywordSpan">getCellAt</span>(address.sheetName, row, col);
      }
    }
  } else {
    this.findCellEx(address, true);
  }
},
getCellEx: function getCellEx(address) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.cell_matrix.prototype.getCellEx" id="apidoc.element.exceljs.cell_matrix.prototype.getCellEx">
        function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>getCellEx
        <span class="apidocSignatureSpan">(address)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getCellEx = function (address) {
  return this.findCellEx(address, true);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.cell_matrix.prototype.map" id="apidoc.element.exceljs.cell_matrix.prototype.map">
        function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>map
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">map = function (callback) {
  var results = [];
  this.forEach(function(cell) { results.push(callback(cell)); });
  return results;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (special !== undefined) {
      return special;
    }
    return datum;
  };

  var csvStream = csv(options).on(&#x27;data&#x27;, function (data) {
    worksheet.addRow(data.<span class="apidocCodeKeywordSpan">map</span>(map));
  }).on(&#x27;end&#x27;, function () {
    csvStream.emit(&#x27;worksheet&#x27;, worksheet);
  });
  return csvStream;
},

write: function write(stream, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.cell_matrix.prototype.removeCellEx" id="apidoc.element.exceljs.cell_matrix.prototype.removeCellEx">
        function <span class="apidocSignatureSpan">exceljs.cell_matrix.prototype.</span>removeCellEx
        <span class="apidocSignatureSpan">(address)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">removeCellEx = function (address) {
  var sheet = this.findSheet(address);
  if (!sheet) { return; }
  var row = this.findSheetRow(sheet, address);
  if (!row) { return; }
  delete row[address.col];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

remove: function remove(locStr, name) {
  var location = colCache.decodeEx(locStr);
  this.removeEx(location, name);
},
removeEx: function removeEx(location, name) {
  var matrix = this.getMatrix(name);
  matrix.<span class="apidocCodeKeywordSpan">removeCellEx</span>(location);
},
removeAllNames: function removeAllNames(location) {
  _.each(this.matrixMap, function (matrix) {
    matrix.removeCellEx(location);
  });
},
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.col_cache" id="apidoc.module.exceljs.col_cache">module exceljs.col_cache</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.col_cache._fill" id="apidoc.element.exceljs.col_cache._fill">
        function <span class="apidocSignatureSpan">exceljs.col_cache.</span>_fill
        <span class="apidocSignatureSpan">(level)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_fill = function (level) {
  var c, v, l1, l2, l3;
  var n = 1;
  if (level &#x3e;= 1) {
    while (n &#x3c;= 26) {
      c = this._dictionary[n-1];
      this._n2l[n] = c;
      this._l2n[c] = n;
      n++;
    }
  }
  if (level &#x3e;= 2) {
    while (n &#x3c;= 26 + 26 * 26) {
      v = n-(26+1);
      l1 = v % 26;
      l2 = Math.floor(v / 26);
      c = this._dictionary[l2] + this._dictionary[l1];
      this._n2l[n] = c;
      this._l2n[c] = n;
      n++;
    }
  }
  if (level &#x3e;= 3) {
    while (n &#x3c;= 16384) {
      v = n-(26*26+26+1);
      l1 = v % 26;
      l2 = Math.floor(v / 26) % 26;
      l3 = Math.floor(v / (26*26));
      c = this._dictionary[l3] + this._dictionary[l2] + this._dictionary[l1];
      this._n2l[n] = c;
      this._l2n[c] = n;
      n++;
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      this._l2n[c] = n;
      n++;
    }
  }
},
l2n: function l2n(l) {
  if (!this._l2n[l]) {
    this.<span class="apidocCodeKeywordSpan">_fill</span>(l.length);
  }
  if (!this._l2n[l]) {
    throw new Error(&#x27;Out of bounds. Invalid column letter: &#x27; + l);
  }
  return this._l2n[l];
},
n2l: function n2l(n) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.col_cache._level" id="apidoc.element.exceljs.col_cache._level">
        function <span class="apidocSignatureSpan">exceljs.col_cache.</span>_level
        <span class="apidocSignatureSpan">(n)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_level = function (n) {
  if (n &#x3c;= 26) { return 1; }
  if (n &#x3c;= 26*26) { return 2; }
  return 3;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return this._l2n[l];
},
n2l: function n2l(n) {
  if (n &#x3c; 1 || n &#x3e; 16384) {
    throw new Error(&#x27;&#x27; + n + &#x27; is out of bounds. Excel supports columns from 1 to 16384&#x27;);
  }
  if (!this._n2l[n]) {
    this._fill(this.<span class="apidocCodeKeywordSpan">_level</span>(n));
  }
  return this._n2l[n];
},

// =========================================================================
// Address processing
_hash: {},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.col_cache.decode" id="apidoc.element.exceljs.col_cache.decode">
        function <span class="apidocSignatureSpan">exceljs.col_cache.</span>decode
        <span class="apidocSignatureSpan">(value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">decode = function (value) {
  var parts = value.split(&#x27;:&#x27;);
  if (parts.length == 2) {
    var tl = this.decodeAddress(parts[0]);
    var br = this.decodeAddress(parts[1]);
    var result = {
      top: Math.min(tl.row, br.row),
      left: Math.min(tl.col, br.col),
      bottom: Math.max(tl.row, br.row),
      right: Math.max(tl.col, br.col)
    };
    // reconstruct tl, br and dimensions
    result.tl = this.n2l(result.left) + result.top;
    result.br = this.n2l(result.right) + result.bottom;
    result.dimensions = result.tl + &#x27;:&#x27; + result.br;
    return result;
  } else {
    return this.decodeAddress(value);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 */
&#x27;use strict&#x27;;

var colCache = require(&#x27;./../utils/col-cache&#x27;);

// used by worksheet to calculate sheet dimensions
var Range = module.exports = function () {
this.<span class="apidocCodeKeywordSpan">decode</span>(arguments);
};

Range.prototype = {
_set_tlbr: function _set_tlbr(t, l, b, r, s) {
  this.model = {
    top: Math.min(t, b),
    left: Math.min(l, r),
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.col_cache.decodeAddress" id="apidoc.element.exceljs.col_cache.decodeAddress">
        function <span class="apidocSignatureSpan">exceljs.col_cache.</span>decodeAddress
        <span class="apidocSignatureSpan">(value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">decodeAddress = function (value) {
  var addr = this._hash[value];
  if (addr) {
    return addr;
  }

  var col = value.match(/[A-Z]+/)[0];
  var colNumber = this.l2n(col);
  var row = value.match(/\d+/)[0];
  var rowNumber = parseInt(row);

  // in case $row$col
  value = col + row;

  var address = {
    address: value,
    col: colNumber,
    row: rowNumber,
    $col$row: &#x27;$&#x27; + col + &#x27;$&#x27; + row
  };

  // mem fix - cache only the tl 100x100 square
  if ((colNumber &#x3c;= 100) &#x26;&#x26; (rowNumber &#x3c;= 100)) {
    this._hash[value] = address;
    this._hash[address.$col$row] = address;
  }

  return address;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    left: Math.min(l, r),
    bottom: Math.max(t, b),
    right: Math.max(l, r),
    sheetName: s
  };
},
_set_tl_br: function _set_tl_br(tl, br, s) {
  tl = colCache.<span class="apidocCodeKeywordSpan">decodeAddress</span>(tl);
  br = colCache.decodeAddress(br);
  this._set_tlbr(tl.row, tl.col, br.row, br.col, s);
},
decode: function decode(argv) {
  switch (argv.length) {
    case 5:
      // [t,l,b,r,s]
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.col_cache.decodeEx" id="apidoc.element.exceljs.col_cache.decodeEx">
        function <span class="apidocSignatureSpan">exceljs.col_cache.</span>decodeEx
        <span class="apidocSignatureSpan">(value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">decodeEx = function (value) {
  var groups = value.match(/(?:(?:(?:&#x27;((?:[^&#x27;]|&#x27;&#x27;)*)&#x27;)|([^&#x27;^ ^!]*))!)?(.*)/);

  var sheetName = groups[1] || groups[2]; // Qouted and unqouted groups
  var reference = groups[3]; // Remaining address

  var parts = reference.split(&#x27;:&#x27;);
  if (parts.length &#x3e; 1) {
    var tl = this.decodeAddress(parts[0]);
    var br = this.decodeAddress(parts[1]);
    var top = Math.min(tl.row, br.row);
    var left = Math.min(tl.col, br.col);
    var bottom = Math.max(tl.row, br.row);
    var right = Math.max(tl.col, br.col);

    tl = this.n2l(left) + top;
    br = this.n2l(right) + bottom;

    return {
      top: top, left: left, bottom: bottom, right: right,
      sheetName: sheetName,
      tl: { address: tl, col: left, row: top, $col$row: &#x27;$&#x27; + this.n2l(left) + &#x27;$&#x27; + top, sheetName: sheetName },
      br: { address: br, col: right, row: bottom, $col$row: &#x27;$&#x27; + this.n2l(right) + &#x27;$&#x27; + bottom, sheetName: sheetName },
      dimensions: tl + &#x27;:&#x27; + br
    };
  } else if (reference.startsWith(&#x27;#&#x27;)) {
    return sheetName ? {sheetName: sheetName, error: reference} : {error: reference};
  } else {
    var address = this.decodeAddress(reference);
    return sheetName ? Object.assign({sheetName: sheetName}, address) : address;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
DefinedNames.prototype = {
getMatrix: function getMatrix(name) {
  return this.matrixMap[name] || (this.matrixMap[name] = new CellMatrix());
},

// add a name to a cell. locStr in the form SheetName!$col$row or SheetName!$c1$r1:$c2:$r2
add: function add(locStr, name) {
  var location = colCache.<span class="apidocCodeKeywordSpan">decodeEx</span>(locStr);
  this.addEx(location, name);
},
addEx: function addEx(location, name) {
  var matrix = this.getMatrix(name);
  if (location.top) {
    for (var col = location.left; col &#x3c;= location.right; col++) {
      for (var row = location.top; row &#x3c;= location.bottom; row++) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.col_cache.encode" id="apidoc.element.exceljs.col_cache.encode">
        function <span class="apidocSignatureSpan">exceljs.col_cache.</span>encode
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">encode = function () {
  switch(arguments.length) {
    case 2:
      return colCache.encodeAddress(arguments[0], arguments[1]);
    case 4:
      return colCache.encodeAddress(arguments[0], arguments[1]) + &#x27;:&#x27; + colCache.encodeAddress(arguments[2], arguments[3]);
    default:
      throw new Error(&#x27;Can only encode with 2 or 4 arguments&#x27;);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.col_cache.encodeAddress" id="apidoc.element.exceljs.col_cache.encodeAddress">
        function <span class="apidocSignatureSpan">exceljs.col_cache.</span>encodeAddress
        <span class="apidocSignatureSpan">(row, col)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">encodeAddress = function (row, col) {
  return colCache.n2l(col) + row;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (column) {
      col = column.number;
    } else {
      col = colCache.l2n(col);
    }
  }
  return this._cells[col - 1] || this._getCell({
    address: colCache.<span class="apidocCodeKeywordSpan">encodeAddress</span>(this._number, col),
    row: this._number,
    col: col
  });
},

// remove cell(s) and shift all higher cells down by count
splice: function splice(start, count) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.col_cache.getAddress" id="apidoc.element.exceljs.col_cache.getAddress">
        function <span class="apidocSignatureSpan">exceljs.col_cache.</span>getAddress
        <span class="apidocSignatureSpan">(r, c)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getAddress = function (r, c) {
  if (c) {
    var address = this.n2l(c) + r;
    return this.decodeAddress(address);
  } else {
    return this.decodeAddress(r);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
},

// =========================================================================
// Cells

// returns the cell at [r,c] or address given by r. If not found, return undefined
findCell: function findCell(r, c) {
  var address = colCache.<span class="apidocCodeKeywordSpan">getAddress</span>(r, c);
  var row = this._rows[address.row - 1];
  return row ? row.findCell(address.col) : undefined;
},

// return the cell at [r,c] or address given by r. If not found, create a new one.
getCell: function getCell(r, c) {
  var address = colCache.getAddress(r, c);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.col_cache.l2n" id="apidoc.element.exceljs.col_cache.l2n">
        function <span class="apidocSignatureSpan">exceljs.col_cache.</span>l2n
        <span class="apidocSignatureSpan">(l)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">l2n = function (l) {
  if (!this._l2n[l]) {
    this._fill(l.length);
  }
  if (!this._l2n[l]) {
    throw new Error(&#x27;Out of bounds. Invalid column letter: &#x27; + l);
  }
  return this._l2n[l];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  getCell: function getCell(col) {
if (typeof col == &#x27;string&#x27;) {
  // is it a key?
  var column = this._worksheet._keys[col];
  if (column) {
    col = column.number;
  } else {
    col = colCache.<span class="apidocCodeKeywordSpan">l2n</span>(col);
  }
}
return this._cells[col - 1] || this._getCell({
  address: colCache.encodeAddress(this._number, col),
  row: this._number,
  col: col
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.col_cache.n2l" id="apidoc.element.exceljs.col_cache.n2l">
        function <span class="apidocSignatureSpan">exceljs.col_cache.</span>n2l
        <span class="apidocSignatureSpan">(n)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">n2l = function (n) {
  if ((n &#x3c; 1) || (n &#x3e; 16384)) {
    throw new Error(&#x27;&#x27; + n + &#x27; is out of bounds. Excel supports columns from 1 to 16384&#x27;);
  }
  if (!this._n2l[n]) {
    this._fill(this._level(n));
  }
  return this._n2l[n];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
get number() {
  return this._number;
},
get worksheet() {
  return this._worksheet;
},
get letter() {
  return colCache.<span class="apidocCodeKeywordSpan">n2l</span>(this._number);
},
get isCustomWidth() {
  return this.width !== undefined &#x26;&#x26; this.width !== 8;
},
get defn() {
  return {
    header: this._header,
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.col_cache.validateAddress" id="apidoc.element.exceljs.col_cache.validateAddress">
        function <span class="apidocSignatureSpan">exceljs.col_cache.</span>validateAddress
        <span class="apidocSignatureSpan">(value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateAddress = function (value) {
  if (!value.match(/^[A-Z]+\d+$/)) {
    throw new Error(&#x27;Invalid Address: &#x27; + value);
  }
  return true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (!row || !column) {
  throw new Error(&#x27;A Cell needs a Row&#x27;);
}

this._row = row;
this._column = column;

colCache.<span class="apidocCodeKeywordSpan">validateAddress</span>(address);
this._address = address;

// TODO: lazy evaluation of this._value
this._value = Value.create(Cell.Types.Null, this);

this.style = this._mergeStyle(row.style, column.style, {});
...</pre></li>
    </ul>










</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.composite_xform" id="apidoc.module.exceljs.composite_xform">module exceljs.composite_xform</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.composite_xform.composite_xform" id="apidoc.element.exceljs.composite_xform.composite_xform">
        function <span class="apidocSignatureSpan">exceljs.</span>composite_xform
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">composite_xform = function (options) {
  this.tag = options.tag;
  this.attrs = options.attrs;
  this.children = options.children;
  this.map = this.children.reduce(function(map, child) {
    var name = child.name || child.tag;
    var tag = child.tag || child.name;
    map[tag] = child;
    child.name = name;
    child.tag = tag;
    return map;
  }, {});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.composite_xform.super_" id="apidoc.element.exceljs.composite_xform.super_">
        function <span class="apidocSignatureSpan">exceljs.composite_xform.</span>super_
        <span class="apidocSignatureSpan">(model, name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">super_ = function (model, name) {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.composite_xform.prototype" id="apidoc.module.exceljs.composite_xform.prototype">module exceljs.composite_xform.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.composite_xform.prototype.parseClose" id="apidoc.element.exceljs.composite_xform.prototype.parseClose">
        function <span class="apidocSignatureSpan">exceljs.composite_xform.prototype.</span>parseClose
        <span class="apidocSignatureSpan">(name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parseClose = function (name) {
  if (this.parser) {
    if (!this.parser.xform.parseClose(name)) {
      this.model[this.parser.name] = this.parser.xform.model;
      this.parser = undefined;
    }
    return true;
  } else {
    return false;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
parser.on(&#x27;opentag&#x27;, function (node) {
  self.parseOpen(node);
});
parser.on(&#x27;text&#x27;, function (text) {
  self.parseText(text);
});
parser.on(&#x27;closetag&#x27;, function (name) {
  if (!self.<span class="apidocCodeKeywordSpan">parseClose</span>(name)) {
    resolve(self.model);
  }
});
parser.on(&#x27;end&#x27;, function () {
  resolve(self.model);
});
parser.on(&#x27;error&#x27;, function (error) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.composite_xform.prototype.parseOpen" id="apidoc.element.exceljs.composite_xform.prototype.parseOpen">
        function <span class="apidocSignatureSpan">exceljs.composite_xform.prototype.</span>parseOpen
        <span class="apidocSignatureSpan">(node)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parseOpen = function (node) {
  if (this.parser) {
    this.parser.xform.parseOpen(node);
    return true;
  } else {
    switch(node.name) {
      case this.tag:
        this.model = {};
        return true;
      default:
        this.parser = this.map[node.name];
        if (this.parser) {
          this.parser.xform.parseOpen(node);
          return true;
        }
    }
    return false;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  // to make sure parses don&#x27;t bleed to next iteration
  this.model = model;
},
parse: function parse(parser) {
  var self = this;
  return new PromishLib.Promish(function (resolve, reject) {
    parser.on(&#x27;opentag&#x27;, function (node) {
      self.<span class="apidocCodeKeywordSpan">parseOpen</span>(node);
    });
    parser.on(&#x27;text&#x27;, function (text) {
      self.parseText(text);
    });
    parser.on(&#x27;closetag&#x27;, function (name) {
      if (!self.parseClose(name)) {
        resolve(self.model);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.composite_xform.prototype.parseText" id="apidoc.element.exceljs.composite_xform.prototype.parseText">
        function <span class="apidocSignatureSpan">exceljs.composite_xform.prototype.</span>parseText
        <span class="apidocSignatureSpan">(text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parseText = function (text) {
  if (this.parser) {
    this.parser.xform.parseText(text);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  parse: function parse(parser) {
var self = this;
return new PromishLib.Promish(function (resolve, reject) {
  parser.on(&#x27;opentag&#x27;, function (node) {
    self.parseOpen(node);
  });
  parser.on(&#x27;text&#x27;, function (text) {
    self.<span class="apidocCodeKeywordSpan">parseText</span>(text);
  });
  parser.on(&#x27;closetag&#x27;, function (name) {
    if (!self.parseClose(name)) {
      resolve(self.model);
    }
  });
  parser.on(&#x27;end&#x27;, function () {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.composite_xform.prototype.prepare" id="apidoc.element.exceljs.composite_xform.prototype.prepare">
        function <span class="apidocSignatureSpan">exceljs.composite_xform.prototype.</span>prepare
        <span class="apidocSignatureSpan">(model, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">prepare = function (model, options) {
  this.children.forEach(function (child) {
    child.xform.prepare(model[child.tag], options);
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

utils.inherits(ListXform, BaseXform, {
prepare: function prepare(model, options) {
  var childXform = this.childXform;
  if (model) {
    model.forEach(function (childModel) {
      childXform.<span class="apidocCodeKeywordSpan">prepare</span>(childModel, options);
    });
  }
},

render: function render(xmlStream, model) {
  if (model &#x26;&#x26; model.length) {
    xmlStream.openNode(this.tag, this.$);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.composite_xform.prototype.reconcile" id="apidoc.element.exceljs.composite_xform.prototype.reconcile">
        function <span class="apidocSignatureSpan">exceljs.composite_xform.prototype.</span>reconcile
        <span class="apidocSignatureSpan">(model, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">reconcile = function (model, options) {
  this.children.forEach(function (child) {
    child.xform.prepare(model[child.tag], options);
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      return false;
    }
  },
  reconcile: function reconcile(model, options) {
    if (model) {
      var childXform = this.childXform;
      model.forEach(function (childModel) {
        childXform.<span class="apidocCodeKeywordSpan">reconcile</span>(childModel, options);
      });
    }
  }
});


},{&#x22;../../utils/utils&#x22;:20,&#x22;./base-xform&#x22;:25}],39:[function(require,module,exports){
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.composite_xform.prototype.render" id="apidoc.element.exceljs.composite_xform.prototype.render">
        function <span class="apidocSignatureSpan">exceljs.composite_xform.prototype.</span>render
        <span class="apidocSignatureSpan">(xmlStream, model)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">render = function (xmlStream, model) {
  xmlStream.openNode(this.tag, this.attrs);
  this.children.forEach(function (child) {
    child.xform.render(xmlStream, model[child.name]);
  });
  xmlStream.closeNode();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    // convenience function to get the xml of this.model
    // useful for manager types that are built during the prepare phase
    return this.toXml(this.model);
  },

  toXml: function toXml(model) {
    var xmlStream = new XmlStream();
    this.<span class="apidocCodeKeywordSpan">render</span>(xmlStream, model);
    return xmlStream.xml;
  }
};


},{&#x22;../../utils/promish&#x22;:15,&#x22;../../utils/xml-stream&#x22;:21,&#x22;sax&#x22;:188}],26:[function(require,module,exports
){
/**
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.config" id="apidoc.module.exceljs.config">module exceljs.config</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.config.setValue" id="apidoc.element.exceljs.config.setValue">
        function <span class="apidocSignatureSpan">exceljs.config.</span>setValue
        <span class="apidocSignatureSpan">(key, value, overwrite)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function setValue(key, value, overwrite) {
  if (overwrite === undefined) {
    // only avoid overwrite if explicitly disabled
    overwrite = true;
  }
  switch(key.toLowerCase()) {
    case &#x27;promise&#x27;:
      if (!overwrite &#x26;&#x26; PromishLib.Promish) return;
      PromishLib.Promish = value;
      break;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

# Config

ExcelJS now supports dependency injection for the promise library.
 You can restore Bluebird promises by including the following code in your module...

```javascript
ExcelJS.config.<span class="apidocCodeKeywordSpan">setValue</span>(&#x27;promise&#x27;, require(&#x27;bluebird&#x27;));
```

Please note: I have tested ExcelJS with bluebird specifically (since up until recently this was the library it used).
 From the tests I have done it will not work with Q.

# Known Issues
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.csv" id="apidoc.module.exceljs.csv">module exceljs.csv</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.csv.csv" id="apidoc.element.exceljs.csv.csv">
        function <span class="apidocSignatureSpan">exceljs.</span>csv
        <span class="apidocSignatureSpan">(workbook)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">csv = function (workbook) {
  this.workbook = workbook;
  this.worksheet = null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.csv.prototype" id="apidoc.module.exceljs.csv.prototype">module exceljs.csv.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.csv.prototype.createInputStream" id="apidoc.element.exceljs.csv.prototype.createInputStream">
        function <span class="apidocSignatureSpan">exceljs.csv.prototype.</span>createInputStream
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createInputStream = function (options) {
  options = options || {};
  var worksheet = this.workbook.addWorksheet(options.sheetName);

  var dateFormats = options.dateFormats || [
      moment.ISO_8601,
      &#x27;MM-DD-YYYY&#x27;,
      &#x27;YYYY-MM-DD&#x27;
    ];
  var map = options.map || function(datum) {
      if (datum == &#x27;&#x27;) {
        return null;
      }
      if (!isNaN(datum)) {
        return parseFloat(datum);
      }
      var dt = moment(datum, dateFormats, true);
      if (dt.isValid()) {
        return new Date(dt.valueOf());
      }
      var special =  SpecialValues[datum];
      if (special !== undefined) {
        return special;
      }
      return datum;
    };

  var csvStream = csv(options)
    .on(&#x27;data&#x27;, function(data){
      worksheet.addRow(data.map(map));
    })
    .on(&#x27;end&#x27;, function() {
      csvStream.emit(&#x27;worksheet&#x27;, worksheet);
    });
  return csvStream;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
workbook.xlsx.readFile(filename)
    .then(function() {
        // use workbook
    });

// pipe from stream
var workbook = new Excel.Workbook();
stream.pipe(workbook.xlsx.<span class="apidocCodeKeywordSpan">createInputStream</span>());
```

#### Writing XLSX

```javascript
// write to a file
var workbook = createAndFillWorkbook();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.csv.prototype.read" id="apidoc.element.exceljs.csv.prototype.read">
        function <span class="apidocSignatureSpan">exceljs.csv.prototype.</span>read
        <span class="apidocSignatureSpan">(stream, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">read = function (stream, options) {
  options = options || {};
  var self = this;
  return new PromishLib.Promish(function(resolve, reject) {

    var csvStream = self.createInputStream(options)
      .on(&#x27;worksheet&#x27;, function(worksheet) {
        resolve(worksheet);
      })
      .on(&#x27;error&#x27;, function(error) {
        reject(error);
      });

    stream.pipe(csvStream);

  });

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
workbook.csv.readFile(filename)
    .then(function(worksheet) {
        // use workbook or worksheet
    });

// read from a stream
var workbook = new Excel.Workbook();
workbook.csv.<span class="apidocCodeKeywordSpan">read</span>(stream)
    .then(function(worksheet) {
        // use workbook or worksheet
    });

// pipe from stream
var workbook = new Excel.Workbook();
stream.pipe(workbook.csv.createInputStream());
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.csv.prototype.readFile" id="apidoc.element.exceljs.csv.prototype.readFile">
        function <span class="apidocSignatureSpan">exceljs.csv.prototype.</span>readFile
        <span class="apidocSignatureSpan">(filename, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">readFile = function (filename, options) {
  var self = this;
  options = options || {};
  var stream;
  return utils.fs.exists(filename)
    .then(function(exists) {
      if (!exists) {
        throw new Error(&#x27;File not found: &#x27; + filename);
      }
      stream = fs.createReadStream(filename);
      return self.read(stream, options);
    })
    .then(function(worksheet) {
      stream.close();
      return worksheet;
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
### XLSX

#### Reading XLSX

```javascript
// read from a file
var workbook = new Excel.Workbook();
workbook.xlsx.<span class="apidocCodeKeywordSpan">readFile</span>(filename)
    .then(function() {
        // use workbook
    });

// pipe from stream
var workbook = new Excel.Workbook();
stream.pipe(workbook.xlsx.createInputStream());
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.csv.prototype.write" id="apidoc.element.exceljs.csv.prototype.write">
        function <span class="apidocSignatureSpan">exceljs.csv.prototype.</span>write
        <span class="apidocSignatureSpan">(stream, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">write = function (stream, options) {

  var self = this;

  return new PromishLib.Promish(function(resolve, reject) {
    options = options || {};
    //var encoding = options.encoding || &#x27;utf8&#x27;;
    //var separator = options.separator || &#x27;,&#x27;;
    //var quoteChar = options.quoteChar || &#x27;\&#x27;&#x27;;

    var worksheet = self.workbook.getWorksheet(options.sheetName || options.sheetId);

    var csvStream = csv.createWriteStream(options);
    stream.on(&#x27;finish&#x27;, function() {
      resolve();
    });
    csvStream.on(&#x27;error&#x27;, function(error) {
      reject(error);
    });
    csvStream.pipe(stream);

    var dateFormat = options.dateFormat;
    var map = options.map || function(value) {
        if (value) {
          if (value.text || value.hyperlink) {
            return value.hyperlink || value.text || &#x27;&#x27;;
          }
          if (value.formula || value.result) {
            return value.result || &#x27;&#x27;;
          }
          if (value instanceof Date) {
            return dateFormat ? moment(value).format(dateFormat) : moment(value).format();
          }
          if (value.error) {
            return value.error;
          }
          if (typeof value === &#x27;object&#x27;) {
            return JSON.stringify(value);
          }
        }
        return value;
      };

    var includeEmptyRows = (options.includeEmptyRows === undefined) || options.includeEmptyRows;
    var lastRow = 1;
    if (worksheet) {
      worksheet.eachRow(function (row, rowNumber) {
        if (includeEmptyRows) {
          while (lastRow++ &#x3c; rowNumber - 1) {
            csvStream.write([]);
          }
        }
        var values = row.values;
        values.shift();
        csvStream.write(values.map(map));
        lastRow = rowNumber;
      });
    }
    csvStream.end();
  });

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var workbook = createAndFillWorkbook();
workbook.xlsx.writeFile(filename)
    .then(function() {
        // done
    });

// write to a stream
workbook.xlsx.<span class="apidocCodeKeywordSpan">write</span>(stream)
    .then(function() {
        // done
    });
```

### CSV
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.csv.prototype.writeFile" id="apidoc.element.exceljs.csv.prototype.writeFile">
        function <span class="apidocSignatureSpan">exceljs.csv.prototype.</span>writeFile
        <span class="apidocSignatureSpan">(filename, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">writeFile = function (filename, options) {
  options = options || {};

  var streamOptions = {
    encoding: options.encoding || &#x27;utf8&#x27;
  };
  var stream = fs.createWriteStream(filename, options);

  return this.write(stream, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

#### Writing XLSX

```javascript
// write to a file
var workbook = createAndFillWorkbook();
workbook.xlsx.<span class="apidocCodeKeywordSpan">writeFile</span>(filename)
.then(function() {
    // done
});

// write to a stream
workbook.xlsx.write(stream)
.then(function() {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.exceljs_browser" id="apidoc.module.exceljs.exceljs_browser">module exceljs.exceljs_browser</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.exceljs_browser.Workbook" id="apidoc.element.exceljs.exceljs_browser.Workbook">
        function <span class="apidocSignatureSpan">exceljs.exceljs_browser.</span>Workbook
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">Workbook = function () {
  this.created = new Date();
  this.modified = this.created;
  this.properties = {};
  this._worksheets = [];
  this.views = [];
  this._definedNames = new DefinedNames();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```javascript
var Excel = require(&#x27;exceljs&#x27;);
```

## Create a Workbook

```javascript
var workbook = new Excel.<span class="apidocCodeKeywordSpan">Workbook</span>();
```

## Set Workbook Properties

```javascript
workbook.creator = &#x27;Me&#x27;;
workbook.lastModifiedBy = &#x27;Her&#x27;;
...</pre></li>
    </ul>














</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.exceljs_nodejs" id="apidoc.module.exceljs.exceljs_nodejs">module exceljs.exceljs_nodejs</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.exceljs_nodejs.ModelContainer" id="apidoc.element.exceljs.exceljs_nodejs.ModelContainer">
        function <span class="apidocSignatureSpan">exceljs.exceljs_nodejs.</span>ModelContainer
        <span class="apidocSignatureSpan">(model)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ModelContainer = function (model) {
  this.model = model;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.exceljs_nodejs.Workbook" id="apidoc.element.exceljs.exceljs_nodejs.Workbook">
        function <span class="apidocSignatureSpan">exceljs.exceljs_nodejs.</span>Workbook
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">Workbook = function () {
  this.created = new Date();
  this.modified = this.created;
  this.properties = {};
  this._worksheets = [];
  this.views = [];
  this._definedNames = new DefinedNames();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```javascript
var Excel = require(&#x27;exceljs&#x27;);
```

## Create a Workbook

```javascript
var workbook = new Excel.<span class="apidocCodeKeywordSpan">Workbook</span>();
```

## Set Workbook Properties

```javascript
workbook.creator = &#x27;Me&#x27;;
workbook.lastModifiedBy = &#x27;Her&#x27;;
...</pre></li>
    </ul>


















</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.flow_control" id="apidoc.module.exceljs.flow_control">module exceljs.flow_control</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.flow_control.flow_control" id="apidoc.element.exceljs.flow_control.flow_control">
        function <span class="apidocSignatureSpan">exceljs.</span>flow_control
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">flow_control = function (options) {
  this.options = options = options || {};

  // Buffer queue
  this.queue = [];

  // Consumer streams
  this.pipes = [];

  // Down-stream flow-control instances
  this.children = [];

  // Up-stream flow-control instances
  this.parent = options.parent;

  // Ensure we don&#x27;t flush more than once at a time
  this.flushing = false;

  // determine timeout for flow control delays
  if (options.gc) {
    var gc = options.gc;
    if (gc.getTimeout) {
      this.getTimeout = gc.getTimeout;
    } else {
      // heap size below which we don&#x27;t bother delaying
      var threshold = gc.threshold !== undefined ? gc.threshold : 150000000;
      // convert from heapsize to ms timeout
      var divisor = gc.divisor !== undefined ? gc.divisor : 500000;
      this.getTimeout = function() {
        var memory = process.memoryUsage();
        var heapSize = memory.heapTotal;
        return (heapSize &#x3c; threshold) ? 0 : Math.floor(heapSize / divisor);
      };
    }
  } else {
    this.getTimeout = null;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.flow_control.super_" id="apidoc.element.exceljs.flow_control.super_">
        function <span class="apidocSignatureSpan">exceljs.flow_control.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.flow_control.prototype" id="apidoc.module.exceljs.flow_control.prototype">module exceljs.flow_control.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.flow_control.prototype._animate" id="apidoc.element.exceljs.flow_control.prototype._animate">
        function <span class="apidocSignatureSpan">exceljs.flow_control.prototype.</span>_animate
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_animate = function () {
  var count = 0;
  var seq = [&#x27;|&#x27;, &#x27;/&#x27;, &#x27;-&#x27;, &#x27;\\&#x27;];
  //var cr = &#x27;\033[0G&#x27;;
  var cr = &#x27;\u001b[0G&#x27;;
  return setInterval(function() {
    process.stdout.write(seq[count++ % 4] + cr);
  }, 100);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
},
_delay: function() {
  // in certain situations it may be useful to delay processing (e.g. for GC)
  var timeout = this.getTimeout &#x26;&#x26; this.getTimeout();
  var self = this;
  if (timeout) {
    return new PromishLib.Promish(function(resolve, reject) {
      var anime = self.<span class="apidocCodeKeywordSpan">_animate</span>();
      setTimeout(function() {
        clearInterval(anime);
        resolve();
      }, timeout);
    });
  } else {
    return PromishLib.Promish.resolve();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.flow_control.prototype._delay" id="apidoc.element.exceljs.flow_control.prototype._delay">
        function <span class="apidocSignatureSpan">exceljs.flow_control.prototype.</span>_delay
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_delay = function () {
  // in certain situations it may be useful to delay processing (e.g. for GC)
  var timeout = this.getTimeout &#x26;&#x26; this.getTimeout();
  var self = this;
  if (timeout) {
    return new PromishLib.Promish(function(resolve, reject) {
      var anime = self._animate();
      setTimeout(function() {
        clearInterval(anime);
        resolve();
      }, timeout);
    });
  } else {
    return PromishLib.Promish.resolve();
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  _flush: function() {
// If/while not corked and we have buffers to send, send them
var self = this;

if (this.queue &#x26;&#x26; !this.flushing &#x26;&#x26; !this.corked) {
  if (this.queue.length) {
    this.flushing = true;
    self.<span class="apidocCodeKeywordSpan">_delay</span>()
      .then(function() {
        return self._pipe(self.queue.shift());
      })
      .then(function() {
        setImmediate(function() {
          self.flushing = false;
          self._flush();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.flow_control.prototype._flush" id="apidoc.element.exceljs.flow_control.prototype._flush">
        function <span class="apidocSignatureSpan">exceljs.flow_control.prototype.</span>_flush
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_flush = function () {
  // If/while not corked and we have buffers to send, send them
  var self = this;

  if (this.queue &#x26;&#x26; !this.flushing &#x26;&#x26; !this.corked) {
    if (this.queue.length) {
      this.flushing = true;
      self._delay()
        .then(function() {
          return self._pipe(self.queue.shift());
        })
        .then(function() {
          setImmediate(function() {
            self.flushing = false;
            self._flush();
          });
        });
    }

    if (!this.stem) {
      // Signal up-stream that we&#x27;re ready for more data
      self.emit(&#x27;drain&#x27;);
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    while (this.buffers.length) {
      this._pipe(this.buffers.shift());
    }
  }
},
uncork: function uncork() {
  this.corked = false;
  this.<span class="apidocCodeKeywordSpan">_flush</span>();
},
end: function end(chunk, encoding, callback) {
  var self = this;
  var writeComplete = function writeComplete(error) {
    if (error) {
      callback(error);
    } else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.flow_control.prototype._pipe" id="apidoc.element.exceljs.flow_control.prototype._pipe">
        function <span class="apidocSignatureSpan">exceljs.flow_control.prototype.</span>_pipe
        <span class="apidocSignatureSpan">(chunk)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_pipe = function (chunk) {
  var self = this;

  // Write chunk to all pipes. A chunk with no data is the end
  var promises = [];
  this.pipes.forEach(function(pipe) {
    if (chunk.data) {
      if (pipe.sync) {
        pipe.stream.write(chunk.data, chunk.encoding);
      } else {
        promises.push(self._write(pipe.stream, chunk.data, chunk.encoding));
      }
    } else {
      pipe.stream.end();
    }
  });
  if (!promises.length) {
    promises.push(PromishLib.Promish.resolve());
  }
  return PromishLib.Promish.all(promises)
    .then(function() {
      try {
        chunk.callback();
      }
      catch(e) {
      }
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

// now, do something with the chunk
if (this.pipes.length) {
  if (this.batch) {
    this._writeToBuffers(chunk);
    while (!this.corked &#x26;&#x26; this.buffers.length &#x3e; 1) {
      this.<span class="apidocCodeKeywordSpan">_pipe</span>(this.buffers.shift());
    }
  } else {
    if (!this.corked) {
      this._pipe(chunk).then(callback);
    } else {
      this._writeToBuffers(chunk);
      process.nextTick(callback);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.flow_control.prototype._write" id="apidoc.element.exceljs.flow_control.prototype._write">
        function <span class="apidocSignatureSpan">exceljs.flow_control.prototype.</span>_write
        <span class="apidocSignatureSpan">(dst, data, encoding)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_write = function (dst, data, encoding) {
  // Write to a single destination and return a promise

  return new PromishLib.Promish(function(resolve, reject) {
    dst.write(data, encoding, function(error) {
      if (error) {
        reject(error);
      } else {
        resolve();
      }
    });
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// Write chunk to all pipes. A chunk with no data is the end
var promises = [];
this.pipes.forEach(function(pipe) {
  if (chunk.data) {
    if (pipe.sync) {
      pipe.stream.write(chunk.data, chunk.encoding);
    } else {
      promises.push(self.<span class="apidocCodeKeywordSpan">_write</span>(pipe.stream, chunk.data, chunk.encoding));
    }
  } else {
    pipe.stream.end();
  }
});
if (!promises.length) {
  promises.push(PromishLib.Promish.resolve());
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.flow_control.prototype.createChild" id="apidoc.element.exceljs.flow_control.prototype.createChild">
        function <span class="apidocSignatureSpan">exceljs.flow_control.prototype.</span>createChild
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createChild = function () {
  // Create a down-stream flow-control
  var self = this;
  var options = Object.assign({parent: this}, this.options);
  var child = new FlowControl(options);
  this.children.push(child);

  child.on(&#x27;drain&#x27;, function() {
    // a child is ready for more
    self._flush();
  });

  child.on(&#x27;finish&#x27;, function() {
    // One child has finished it&#x27;s stream. Remove it and continue
    self.children = self.children.filter(function(item) {
      return item !== child;
    });
    self._flush();
  });

  return child;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
            }
        });
        parser.on(&#x27;end&#x27;, function() {
            self.emit(&#x27;finished&#x27;);
        });

        // create a down-stream flow-control to regulate the stream
        var flowControl = this.workbook.flowControl.<span class="apidocCodeKeywordSpan">createChild</span>();
        flowControl.pipe(parser, {sync: true});
        entry.pipe(flowControl);
    }
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.flow_control.prototype.end" id="apidoc.element.exceljs.flow_control.prototype.end">
        function <span class="apidocSignatureSpan">exceljs.flow_control.prototype.</span>end
        <span class="apidocSignatureSpan">(chunk, encoding, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">end = function (chunk, encoding, callback) {
  // Signal from up-stream
  var self = this;
  this.queue.push({
    callback: function() {
      self.queue = null;
      self.emit(&#x27;finish&#x27;);
    }
  });
  this._flush();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      }
      var values = row.values;
      values.shift();
      csvStream.write(values.map(map));
      lastRow = rowNumber;
    });
  }
  csvStream.<span class="apidocCodeKeywordSpan">end</span>();
});
  },
  writeFile: function writeFile(filename, options) {
options = options || {};

var streamOptions = {
  encoding: options.encoding || &#x27;utf8&#x27;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.flow_control.prototype.pipe" id="apidoc.element.exceljs.flow_control.prototype.pipe">
        function <span class="apidocSignatureSpan">exceljs.flow_control.prototype.</span>pipe
        <span class="apidocSignatureSpan">(stream, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pipe = function (stream, options) {
  options = options || {};

  // some streams don&#x27;t call callbacks
  var sync = options.sync || false;

  this.pipes.push({
    stream: stream,
    sync: sync
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
workbook.xlsx.readFile(filename)
    .then(function() {
        // use workbook
    });

// pipe from stream
var workbook = new Excel.Workbook();
stream.<span class="apidocCodeKeywordSpan">pipe</span>(workbook.xlsx.createInputStream());
```

#### Writing XLSX

```javascript
// write to a file
var workbook = createAndFillWorkbook();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.flow_control.prototype.unpipe" id="apidoc.element.exceljs.flow_control.prototype.unpipe">
        function <span class="apidocSignatureSpan">exceljs.flow_control.prototype.</span>unpipe
        <span class="apidocSignatureSpan">(stream)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">unpipe = function (stream) {
  this.pipes = this.pipes.filter(function(pipe) {
    return pipe.stream !== stream;
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
isPaused: function isPaused() {
  return this.stream.isPaused();
},
pipe: function pipe(destination, options) {
  return this.stream.pipe(destination, options);
},
unpipe: function unpipe(destination) {
  return this.stream.<span class="apidocCodeKeywordSpan">unpipe</span>(destination);
},
unshift: function unshift(chunk) {
  return this.stream.unshift(chunk);
},
wrap: function wrap(stream) {
  return this.stream.wrap(stream);
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.flow_control.prototype.write" id="apidoc.element.exceljs.flow_control.prototype.write">
        function <span class="apidocSignatureSpan">exceljs.flow_control.prototype.</span>write
        <span class="apidocSignatureSpan">(data, encoding, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">write = function (data, encoding, callback) {
  // Called by up-stream pipe
  if (encoding instanceof Function) {
    callback = encoding;
    encoding = &#x27;utf8&#x27;;
  }
  callback = callback || utils.nop;

  if (!this.queue) {
    throw new Error(&#x27;Cannot write to stream after end&#x27;);
  }

  // Always queue chunks and then flush
  this.queue.push({
    data: data,
    encoding: encoding,
    callback: callback
  });
  this._flush();

  // restrict further incoming data if we have backed up buffers or
  // the children are still busy
  var stemFlow = this.corked || (this.queue.length &#x3e; 3);
  return !stemFlow;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var workbook = createAndFillWorkbook();
workbook.xlsx.writeFile(filename)
    .then(function() {
        // done
    });

// write to a stream
workbook.xlsx.<span class="apidocCodeKeywordSpan">write</span>(stream)
    .then(function() {
        // done
    });
```

### CSV
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.hyperlink_reader" id="apidoc.module.exceljs.hyperlink_reader">module exceljs.hyperlink_reader</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.hyperlink_reader.hyperlink_reader" id="apidoc.element.exceljs.hyperlink_reader.hyperlink_reader">
        function <span class="apidocSignatureSpan">exceljs.</span>hyperlink_reader
        <span class="apidocSignatureSpan">(workbook, id)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hyperlink_reader = function (workbook, id) {
    // in a workbook, each sheet will have a number
    this.id = id;

    this._workbook = workbook;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.hyperlink_reader.super_" id="apidoc.element.exceljs.hyperlink_reader.super_">
        function <span class="apidocSignatureSpan">exceljs.hyperlink_reader.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.hyperlink_reader.prototype" id="apidoc.module.exceljs.hyperlink_reader.prototype">module exceljs.hyperlink_reader.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.hyperlink_reader.prototype.each" id="apidoc.element.exceljs.hyperlink_reader.prototype.each">
        function <span class="apidocSignatureSpan">exceljs.hyperlink_reader.prototype.</span>each
        <span class="apidocSignatureSpan">(fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">each = function (fn) {
    return this.hyperlinks.forEach(fn);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  this.removeEx(location, name);
},
removeEx: function removeEx(location, name) {
  var matrix = this.getMatrix(name);
  matrix.removeCellEx(location);
},
removeAllNames: function removeAllNames(location) {
  _.<span class="apidocCodeKeywordSpan">each</span>(this.matrixMap, function (matrix) {
    matrix.removeCellEx(location);
  });
},

forEach: function forEach(callback) {
  _.each(this.matrixMap, function (matrix, name) {
    matrix.forEach(function (cell) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.hyperlink_reader.prototype.read" id="apidoc.element.exceljs.hyperlink_reader.prototype.read">
        function <span class="apidocSignatureSpan">exceljs.hyperlink_reader.prototype.</span>read
        <span class="apidocSignatureSpan">(entry, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">read = function (entry, options) {
    var self = this;
    var emitHyperlinks = false;
    var hyperlinks = null;
    switch(options.hyperlinks) {
        case &#x27;emit&#x27;:
            emitHyperlinks = true;
            break;
        case &#x27;cache&#x27;:
            this.hyperlinks = hyperlinks = {};
            break;
    }
    if (!emitHyperlinks &#x26;&#x26; !hyperlinks) {
        entry.autodrain();
        return;
    }

    var parser = Sax.createStream(true, {});
    parser.on(&#x27;opentag&#x27;, function(node) {
        if (node.name === &#x27;Relationship&#x27;) {
            var rId = node.attributes.Id;
            switch (node.attributes.Type) {
                case XLSX.RelType.Hyperlink:
                    var relationship = {
                        type: Enums.RelationshipType.Styles,
                        rId: rId,
                        target: node.attributes.Target,
                        targetMode: node.attributes.TargetMode
                    };
                    if (emitHyperlinks) {
                        self.emit(&#x27;hyperlink&#x27;, relationship);
                    } else {
                        hyperlinks[relationship.rId] = relationship;
                    }
                    break;
            }
        }
    });
    parser.on(&#x27;end&#x27;, function() {
        self.emit(&#x27;finished&#x27;);
    });

    // create a down-stream flow-control to regulate the stream
    var flowControl = this.workbook.flowControl.createChild();
    flowControl.pipe(parser, {sync: true});
    entry.pipe(flowControl);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
workbook.csv.readFile(filename)
    .then(function(worksheet) {
        // use workbook or worksheet
    });

// read from a stream
var workbook = new Excel.Workbook();
workbook.csv.<span class="apidocCodeKeywordSpan">read</span>(stream)
    .then(function(worksheet) {
        // use workbook or worksheet
    });

// pipe from stream
var workbook = new Excel.Workbook();
stream.pipe(workbook.csv.createInputStream());
...</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.hyperlink_writer" id="apidoc.module.exceljs.hyperlink_writer">module exceljs.hyperlink_writer</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.hyperlink_writer.hyperlink_writer" id="apidoc.element.exceljs.hyperlink_writer.hyperlink_writer">
        function <span class="apidocSignatureSpan">exceljs.</span>hyperlink_writer
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hyperlink_writer = function (options) {
  // in a workbook, each sheet will have a number
  this.id = options.id;

  // keep record of all hyperlinks
  this._hyperlinks = [];

  this._workbook = options.workbook;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.hyperlink_writer.prototype" id="apidoc.module.exceljs.hyperlink_writer.prototype">module exceljs.hyperlink_writer.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.hyperlink_writer.prototype._writeClose" id="apidoc.element.exceljs.hyperlink_writer.prototype._writeClose">
        function <span class="apidocSignatureSpan">exceljs.hyperlink_writer.prototype.</span>_writeClose
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_writeClose = function () {
  this.stream.write(&#x27;&#x3c;/Relationships&#x3e;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  // and write to stream
  this._writeRelationship(hyperlink);
},

commit: function() {
  if (this._hyperlinks.length) {
    // write xml utro
    this.<span class="apidocCodeKeywordSpan">_writeClose</span>();
    // and close stream
    this.stream.end();
  }
},

// ================================================================================
_writeOpen: function() {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.hyperlink_writer.prototype._writeOpen" id="apidoc.element.exceljs.hyperlink_writer.prototype._writeOpen">
        function <span class="apidocSignatureSpan">exceljs.hyperlink_writer.prototype.</span>_writeOpen
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_writeOpen = function () {
  this.stream.write(
    &#x27;&#x3c;?xml version=&#x22;1.0&#x22; encoding=&#x22;UTF-8&#x22; standalone=&#x22;yes&#x22;?&#x3e;&#x27; +
    &#x27;&#x3c;Relationships xmlns=&#x22;http://schemas.openxmlformats.org/package/2006/relationships&#x22;&#x3e;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  each: function(fn) {
return this._hyperlinks.forEach(fn);
  },

  push: function(hyperlink) {
// if first hyperlink, must open stream and write xml intro
if (!this._hyperlinks.length) {
  this.<span class="apidocCodeKeywordSpan">_writeOpen</span>();
}

// store sheet stuff for later
this._hyperlinks.push({
  address: hyperlink.address,
  rId: hyperlink.rId
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.hyperlink_writer.prototype._writeRelationship" id="apidoc.element.exceljs.hyperlink_writer.prototype._writeRelationship">
        function <span class="apidocSignatureSpan">exceljs.hyperlink_writer.prototype.</span>_writeRelationship
        <span class="apidocSignatureSpan">(hyperlink)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_writeRelationship = function (hyperlink) {
  this.stream.write(
    &#x27;&#x3c;Relationship&#x27; +
    &#x27; Id=&#x22;&#x27; + hyperlink.rId + &#x27;&#x22;&#x27; +
    &#x27; Type=&#x22;&#x27; + hyperlink.type + &#x27;&#x22;&#x27; +
    &#x27; Target=&#x22;&#x27; + utils.xmlEncode(hyperlink.target) + &#x27;&#x22;&#x27; +
    &#x27; TargetMode=&#x22;&#x27; + hyperlink.targetMode + &#x27;&#x22;&#x27; +
    &#x27;/&#x3e;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  // store sheet stuff for later
  this._hyperlinks.push({
    address: hyperlink.address,
    rId: hyperlink.rId
  });

  // and write to stream
  this.<span class="apidocCodeKeywordSpan">_writeRelationship</span>(hyperlink);
},

commit: function() {
  if (this._hyperlinks.length) {
    // write xml utro
    this._writeClose();
    // and close stream
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.hyperlink_writer.prototype.commit" id="apidoc.element.exceljs.hyperlink_writer.prototype.commit">
        function <span class="apidocSignatureSpan">exceljs.hyperlink_writer.prototype.</span>commit
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">commit = function () {
  if (this._hyperlinks.length) {
    // write xml utro
    this._writeClose();
    // and close stream
    this.stream.end();
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// Note: this operation will not affect other rows
row.splice(3,2);

// remove one cell and insert two more (cells to the right of the cut cell will be shifted right)
row.splice(4,1,&#x27;new value 1&#x27;, &#x27;new value 2&#x27;);

// Commit a completed row to stream
row.<span class="apidocCodeKeywordSpan">commit</span>();

// row metrics
var rowSize = row.cellCount;
var numValues = row.actualCellCount;
```

## Handling Individual Cells
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.hyperlink_writer.prototype.each" id="apidoc.element.exceljs.hyperlink_writer.prototype.each">
        function <span class="apidocSignatureSpan">exceljs.hyperlink_writer.prototype.</span>each
        <span class="apidocSignatureSpan">(fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">each = function (fn) {
  return this._hyperlinks.forEach(fn);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  this.removeEx(location, name);
},
removeEx: function removeEx(location, name) {
  var matrix = this.getMatrix(name);
  matrix.removeCellEx(location);
},
removeAllNames: function removeAllNames(location) {
  _.<span class="apidocCodeKeywordSpan">each</span>(this.matrixMap, function (matrix) {
    matrix.removeCellEx(location);
  });
},

forEach: function forEach(callback) {
  _.each(this.matrixMap, function (matrix, name) {
    matrix.forEach(function (cell) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.hyperlink_writer.prototype.push" id="apidoc.element.exceljs.hyperlink_writer.prototype.push">
        function <span class="apidocSignatureSpan">exceljs.hyperlink_writer.prototype.</span>push
        <span class="apidocSignatureSpan">(hyperlink)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">push = function (hyperlink) {
  // if first hyperlink, must open stream and write xml intro
  if (!this._hyperlinks.length) {
    this._writeOpen();
  }

  // store sheet stuff for later
  this._hyperlinks.push({
    address: hyperlink.address,
    rId: hyperlink.rId
  });

  // and write to stream
  this._writeRelationship(hyperlink);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
          width: column.width,
          style: column.style,
          isCustomWidth: column.isCustomWidth,
          hidden: column.hidden,
          outlineLevel: column.outlineLevel,
          collapsed: column.collapsed
        };
        cols.<span class="apidocCodeKeywordSpan">push</span>(col);
      } else {
        col.max = index + 1;
      }
    }
  });
}
return cols.length ? cols : undefined;
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.line_buffer" id="apidoc.module.exceljs.line_buffer">module exceljs.line_buffer</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.line_buffer.line_buffer" id="apidoc.element.exceljs.line_buffer.line_buffer">
        function <span class="apidocSignatureSpan">exceljs.</span>line_buffer
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">line_buffer = function (options) {
  events.EventEmitter.call(this);
  this.encoding = options.encoding;

  this.buffer = null;

  // part of cork/uncork
  this.corked = false;
  this.queue = [];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.line_buffer.super_" id="apidoc.element.exceljs.line_buffer.super_">
        function <span class="apidocSignatureSpan">exceljs.line_buffer.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.line_buffer.prototype" id="apidoc.module.exceljs.line_buffer.prototype">module exceljs.line_buffer.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.line_buffer.prototype._flush" id="apidoc.element.exceljs.line_buffer.prototype._flush">
        function <span class="apidocSignatureSpan">exceljs.line_buffer.prototype.</span>_flush
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_flush = function () {
  if (!this.corked) {
    this.queue.forEach(function(line) {
      this.emit(&#x27;line&#x27;, line);
    });
    this.queue = [];
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    while (this.buffers.length) {
      this._pipe(this.buffers.shift());
    }
  }
},
uncork: function uncork() {
  this.corked = false;
  this.<span class="apidocCodeKeywordSpan">_flush</span>();
},
end: function end(chunk, encoding, callback) {
  var self = this;
  var writeComplete = function writeComplete(error) {
    if (error) {
      callback(error);
    } else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.line_buffer.prototype.cork" id="apidoc.element.exceljs.line_buffer.prototype.cork">
        function <span class="apidocSignatureSpan">exceljs.line_buffer.prototype.</span>cork
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">cork = function () {
  this.corked = true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

// ==========================================================================
// Stream.Writable interface
write: function write(data, encoding, callback) {
  return this.stream.write(data, encoding, callback);
},
cork: function cork() {
  return this.stream.<span class="apidocCodeKeywordSpan">cork</span>();
},
uncork: function uncork() {
  return this.stream.uncork();
},
end: function end() {
  return this.stream.end();
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.line_buffer.prototype.end" id="apidoc.element.exceljs.line_buffer.prototype.end">
        function <span class="apidocSignatureSpan">exceljs.line_buffer.prototype.</span>end
        <span class="apidocSignatureSpan">(chunk, encoding, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">end = function (chunk, encoding, callback) {
  if (this.buffer) {
    this.emit(&#x27;line&#x27;, this.buffer);
    this.buffer = null;
  }
  this.emit(&#x27;done&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      }
      var values = row.values;
      values.shift();
      csvStream.write(values.map(map));
      lastRow = rowNumber;
    });
  }
  csvStream.<span class="apidocCodeKeywordSpan">end</span>();
});
  },
  writeFile: function writeFile(filename, options) {
options = options || {};

var streamOptions = {
  encoding: options.encoding || &#x27;utf8&#x27;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.line_buffer.prototype.setDefaultEncoding" id="apidoc.element.exceljs.line_buffer.prototype.setDefaultEncoding">
        function <span class="apidocSignatureSpan">exceljs.line_buffer.prototype.</span>setDefaultEncoding
        <span class="apidocSignatureSpan">(encoding)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setDefaultEncoding = function (encoding) {
  // ?
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.line_buffer.prototype.uncork" id="apidoc.element.exceljs.line_buffer.prototype.uncork">
        function <span class="apidocSignatureSpan">exceljs.line_buffer.prototype.</span>uncork
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">uncork = function () {
  this.corked = false;
  this._flush();

  // tell the source I&#x27;m ready again
  this.emit(&#x27;drain&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  write: function write(data, encoding, callback) {
    return this.stream.write(data, encoding, callback);
  },
  cork: function cork() {
    return this.stream.cork();
  },
  uncork: function uncork() {
    return this.stream.<span class="apidocCodeKeywordSpan">uncork</span>();
  },
  end: function end() {
    return this.stream.end();
  }
});

// =============================================================================
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.line_buffer.prototype.write" id="apidoc.element.exceljs.line_buffer.prototype.write">
        function <span class="apidocSignatureSpan">exceljs.line_buffer.prototype.</span>write
        <span class="apidocSignatureSpan">(chunk, encoding, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">write = function (chunk, encoding, callback) {

  // find line or lines in chunk and emit them if not corked
  // or queue them if corked
  var data = this.buffer ? this.buffer + chunk : chunk;
  var lines = data.split(/\r?\n/g);

  // save the last line
  this.buffer = lines.pop();

  lines.forEach(function(line) {
    if (this.corked) {
      this.queue.push(line);
    } else {
      this.emit(&#x27;line&#x27;, line);
    }
  });

  return !this.corked;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var workbook = createAndFillWorkbook();
workbook.xlsx.writeFile(filename)
    .then(function() {
        // done
    });

// write to a stream
workbook.xlsx.<span class="apidocCodeKeywordSpan">write</span>(stream)
    .then(function() {
        // done
    });
```

### CSV
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.list_xform" id="apidoc.module.exceljs.list_xform">module exceljs.list_xform</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.list_xform.list_xform" id="apidoc.element.exceljs.list_xform.list_xform">
        function <span class="apidocSignatureSpan">exceljs.</span>list_xform
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">list_xform = function (options) {
  this.tag = options.tag;
  this.count = options.count;
  this.empty = options.empty;
  this.$count = options.$count || &#x27;count&#x27;;
  this.$ = options.$;
  this.childXform = options.childXform;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.list_xform.super_" id="apidoc.element.exceljs.list_xform.super_">
        function <span class="apidocSignatureSpan">exceljs.list_xform.</span>super_
        <span class="apidocSignatureSpan">(model, name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">super_ = function (model, name) {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.list_xform.prototype" id="apidoc.module.exceljs.list_xform.prototype">module exceljs.list_xform.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.list_xform.prototype.parseClose" id="apidoc.element.exceljs.list_xform.prototype.parseClose">
        function <span class="apidocSignatureSpan">exceljs.list_xform.prototype.</span>parseClose
        <span class="apidocSignatureSpan">(name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parseClose = function (name) {
  if (this.parser) {
    if (!this.parser.parseClose(name)) {
      this.model.push(this.parser.model);
      this.parser = undefined;
    }
    return true;
  } else {
    return false;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
parser.on(&#x27;opentag&#x27;, function (node) {
  self.parseOpen(node);
});
parser.on(&#x27;text&#x27;, function (text) {
  self.parseText(text);
});
parser.on(&#x27;closetag&#x27;, function (name) {
  if (!self.<span class="apidocCodeKeywordSpan">parseClose</span>(name)) {
    resolve(self.model);
  }
});
parser.on(&#x27;end&#x27;, function () {
  resolve(self.model);
});
parser.on(&#x27;error&#x27;, function (error) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.list_xform.prototype.parseOpen" id="apidoc.element.exceljs.list_xform.prototype.parseOpen">
        function <span class="apidocSignatureSpan">exceljs.list_xform.prototype.</span>parseOpen
        <span class="apidocSignatureSpan">(node)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parseOpen = function (node) {
  if (this.parser) {
    this.parser.parseOpen(node);
    return true;
  } else {
    switch(node.name) {
      case this.tag:
        this.model = [];
        return true;
      default:
        if (this.childXform.parseOpen(node)) {
          this.parser = this.childXform;
          return true;
        } else {
          return false;
        }
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  // to make sure parses don&#x27;t bleed to next iteration
  this.model = model;
},
parse: function parse(parser) {
  var self = this;
  return new PromishLib.Promish(function (resolve, reject) {
    parser.on(&#x27;opentag&#x27;, function (node) {
      self.<span class="apidocCodeKeywordSpan">parseOpen</span>(node);
    });
    parser.on(&#x27;text&#x27;, function (text) {
      self.parseText(text);
    });
    parser.on(&#x27;closetag&#x27;, function (name) {
      if (!self.parseClose(name)) {
        resolve(self.model);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.list_xform.prototype.parseText" id="apidoc.element.exceljs.list_xform.prototype.parseText">
        function <span class="apidocSignatureSpan">exceljs.list_xform.prototype.</span>parseText
        <span class="apidocSignatureSpan">(text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parseText = function (text) {
  if (this.parser) {
    this.parser.parseText(text);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  parse: function parse(parser) {
var self = this;
return new PromishLib.Promish(function (resolve, reject) {
  parser.on(&#x27;opentag&#x27;, function (node) {
    self.parseOpen(node);
  });
  parser.on(&#x27;text&#x27;, function (text) {
    self.<span class="apidocCodeKeywordSpan">parseText</span>(text);
  });
  parser.on(&#x27;closetag&#x27;, function (name) {
    if (!self.parseClose(name)) {
      resolve(self.model);
    }
  });
  parser.on(&#x27;end&#x27;, function () {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.list_xform.prototype.prepare" id="apidoc.element.exceljs.list_xform.prototype.prepare">
        function <span class="apidocSignatureSpan">exceljs.list_xform.prototype.</span>prepare
        <span class="apidocSignatureSpan">(model, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">prepare = function (model, options) {
  var childXform = this.childXform;
  if (model) {
    model.forEach(function (childModel) {
      childXform.prepare(childModel, options);
    });
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

utils.inherits(ListXform, BaseXform, {
prepare: function prepare(model, options) {
  var childXform = this.childXform;
  if (model) {
    model.forEach(function (childModel) {
      childXform.<span class="apidocCodeKeywordSpan">prepare</span>(childModel, options);
    });
  }
},

render: function render(xmlStream, model) {
  if (model &#x26;&#x26; model.length) {
    xmlStream.openNode(this.tag, this.$);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.list_xform.prototype.reconcile" id="apidoc.element.exceljs.list_xform.prototype.reconcile">
        function <span class="apidocSignatureSpan">exceljs.list_xform.prototype.</span>reconcile
        <span class="apidocSignatureSpan">(model, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">reconcile = function (model, options) {
  if (model) {
    var childXform = this.childXform;
    model.forEach(function (childModel) {
      childXform.reconcile(childModel, options);
    });
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      return false;
    }
  },
  reconcile: function reconcile(model, options) {
    if (model) {
      var childXform = this.childXform;
      model.forEach(function (childModel) {
        childXform.<span class="apidocCodeKeywordSpan">reconcile</span>(childModel, options);
      });
    }
  }
});


},{&#x22;../../utils/utils&#x22;:20,&#x22;./base-xform&#x22;:25}],39:[function(require,module,exports){
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.list_xform.prototype.render" id="apidoc.element.exceljs.list_xform.prototype.render">
        function <span class="apidocSignatureSpan">exceljs.list_xform.prototype.</span>render
        <span class="apidocSignatureSpan">(xmlStream, model)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">render = function (xmlStream, model) {
  if (model &#x26;&#x26; model.length) {
    xmlStream.openNode(this.tag, this.$);
    if (this.count) {
      xmlStream.addAttribute(this.$count, model.length);
    }

    var childXform = this.childXform;
    model.forEach(function (childModel) {
      childXform.render(xmlStream, childModel);
    });

    xmlStream.closeNode();
  } else if (this.empty) {
    xmlStream.leafNode(this.tag);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    // convenience function to get the xml of this.model
    // useful for manager types that are built during the prepare phase
    return this.toXml(this.model);
  },

  toXml: function toXml(model) {
    var xmlStream = new XmlStream();
    this.<span class="apidocCodeKeywordSpan">render</span>(xmlStream, model);
    return xmlStream.xml;
  }
};


},{&#x22;../../utils/promish&#x22;:15,&#x22;../../utils/xml-stream&#x22;:21,&#x22;sax&#x22;:188}],26:[function(require,module,exports
){
/**
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.promish" id="apidoc.module.exceljs.promish">module exceljs.promish</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.promish.Promish" id="apidoc.element.exceljs.promish.Promish">
        function <span class="apidocSignatureSpan">exceljs.promish.</span>Promish
        <span class="apidocSignatureSpan">(f)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">class Promish extends Base {
  constructor(f) {
    if (f instanceof Promish) {
      return f;
    } else if ((f instanceof Promise) || (f.then instanceof Function)) {
      super((resolve, reject) =&#x3e; f.then(resolve, reject));
    } else if (f instanceof Error) {
      // sugar for &#x27;rethrow&#x27;
      super((resolve, reject) =&#x3e; reject(f));
    } else if (f instanceof Function) {
      super(f);
    } else {
      // anything else, resolve with value
      super(resolve =&#x3e; resolve(f));
    }
  }

  finally(h) {
    return this.then(
      value =&#x3e; Promish.resolve(h()).then(() =&#x3e; value),
      error =&#x3e; Promish.resolve(h()).then(() =&#x3e; Promish.reject(error))
    );
  }

  catch() {
    // extend catch with type-aware or matcher handling
    var args = Array.from(arguments);
    var h = args.pop();
    return this.then(undefined, function(error) {
      // default catch - no matchers. Just return handler result
      if (!args.length) {
        return h(error);
      }

      //console.log(&#x27;catch matcher&#x27;, error)
      // search for a match in argument order and return handler result if found
      for (var i = 0; i &#x3c; args.length; i++) {
        var matcher = args[i];
        if (isErrorClass(matcher)) {
          if (error instanceof matcher) {
            return h(error);
          }
        } else if (matcher instanceof Function) {
          //console.log(&#x27;matcher function&#x27;)
          if (matcher(error)) {
            //console.log(&#x27;matched!!&#x27;)
            return h(error);
          }
        }
      }

      // no match was found send this error to the next promise handler in the chain
      return new Promish((resolve, reject) =&#x3e; reject(error));
    });
  }

  delay(timeout) {
    return this.then(function(value) {
      return new Promish(function(resolve) {
        setTimeout(function() {
          resolve(value);
        }, timeout);
      });
    });
  }

  map(f) {
    return this.then(function(values) {
      return Promish.map(values, f);
    });
  }

  static map(values, f) {
    return Promish.all(
      values.map((v,i) =&#x3e; Promish.resolve(v).then(v2 =&#x3e; f(v2, i, values.length)))
    );
  }

  reduce(f, val0) {
    return this.then(function(values) {
      return Promish.reduce(values, f, val0);
    });
  }

  static reduce(values, f, val0) {
    var promise;
    var count = 0;
    if (val0 !== undefined) {
      promise = Promish.resolve(val0);
    } else if (values.length &#x3e; 1) {
      promise = Promish.resolve(values[count++]);
    } else {
      return Promish.resolve(values[0]);
    }
    while (count &#x3c; values.length) (function(i) {
      promise = promise.then(function(value) {
        return Promish.resolve(values[i]).then(v2 =&#x3e; f(value, v2, i));
      });
    })(count++);
    return promise;
  }

  spread(f) {
    return this.then(function(values) {
      return Promish.all(values);
    }).then(function(values) {
      return f.apply(undefined, values);
    });
  }

  static delay(timeout, value) {
    return new Promish(resolve =&#x3e; {
      setTimeout(function() {
        resolve(value);
      }, timeout);
    });
  }

  static resolve(value) {
    return new Promish(resolve =&#x3e; {
      resolve(value);
    });
  }

  static reject(error) {
    return new Promish((resolve, reject) =&#x3e; {
      reject(error);
    });
  }

  // Wrap a synchronous method and resolve with its return value
  static method(f) {
    return function() {
      var self = this; // is this necessary?
      var args = Array.from(arguments);
      return new Promish(resolve =&#x3e; resolve(f.apply(self, args)));
    };
  }

  //
  static apply(f, args) {
    // take a copy of args because a) might not be Array and b) no side-effects
    args = Array.from(args);
    return new Promish(function(resolve, reject) {
      args.push(function () {
        var error = Array.prototype.shift.apply(arguments);
        if (error) {
          reject(error);
        } else {
          if (arguments.length === 1) { ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...
stream.close();
return worksheet;
    });
  },
  read: function read(stream, options) {
    options = options || {};
    var self = this;
    return new PromishLib.<span class="apidocCodeKeywordSpan">Promish</span>(function (resolve, reject) {

var csvStream = self.createInputStream(options).on(&#x27;worksheet&#x27;, function (worksheet) {
  resolve(worksheet);
}).on(&#x27;error&#x27;, function (error) {
  reject(error);
});
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.shared_formula" id="apidoc.module.exceljs.shared_formula">module exceljs.shared_formula</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.shared_formula.slideFormula" id="apidoc.element.exceljs.shared_formula.slideFormula">
        function <span class="apidocSignatureSpan">exceljs.shared_formula.</span>slideFormula
        <span class="apidocSignatureSpan">(formula, fromCell, toCell)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">slideFormula = function (formula, fromCell, toCell) {
  var offset = colCache.decode(fromCell);
  var to = colCache.decode(toCell);
  return formula.replace(replacementCandidateRx, function(refMatch, sheet, sheetMaybe, addrPart, trailingParen) {
    if (trailingParen) {
      return refMatch;
    }
    var match = CRrx.exec(addrPart)
    if (match) {
      var colDollar = match[1];
      var colStr = match[2].toUpperCase();
      var rowDollar = match[3];
      var rowStr = match[4];
      if (colStr.length &#x3e; 3 || (colStr.length === 3 &#x26;&#x26; colStr &#x3e; &#x27;XFD&#x27;)) {
        // &#x3e; XFD is the highest col number in excel 2007 and beyond, so this is a named range
        return refMatch;
      }
      var col = colCache.l2n(colStr);
      var row = parseInt(rowStr, 10);
      if (!colDollar) {
        col += to.col - offset.col;
      }
      if (!rowDollar) {
        row += to.row - offset.row;
      }
      var res = (sheet || &#x27;&#x27;) + (colDollar || &#x27;&#x27;) + colCache.n2l(col) + (rowDollar || &#x27;&#x27;) + row;
      return res;
    }
    return refMatch;
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.shared_strings" id="apidoc.module.exceljs.shared_strings">module exceljs.shared_strings</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.shared_strings.shared_strings" id="apidoc.element.exceljs.shared_strings.shared_strings">
        function <span class="apidocSignatureSpan">exceljs.</span>shared_strings
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">shared_strings = function () {
  this._values = [];
  this._totalRefs = 0;
  this._hash = {}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.shared_strings.prototype" id="apidoc.module.exceljs.shared_strings.prototype">module exceljs.shared_strings.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.shared_strings.prototype.add" id="apidoc.element.exceljs.shared_strings.prototype.add">
        function <span class="apidocSignatureSpan">exceljs.shared_strings.prototype.</span>add
        <span class="apidocSignatureSpan">(value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">add = function (value) {
  var index = this._hash[value];
  if (index === undefined) {
    index = this._hash[value] = this._values.length;
    this._values.push(value);
  }
  this._totalRefs++;
  return index;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
},

get dataValidation() {
  return this._dataValidations.find(this.address);
},

set dataValidation(value) {
  this._dataValidations.<span class="apidocCodeKeywordSpan">add</span>(this.address, value);
},

// =========================================================================
// Model stuff

get model() {
  var model = this._value.model;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.shared_strings.prototype.getString" id="apidoc.element.exceljs.shared_strings.prototype.getString">
        function <span class="apidocSignatureSpan">exceljs.shared_strings.prototype.</span>getString
        <span class="apidocSignatureSpan">(index)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getString = function (index) {
  return this._values[index];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (model.styleId !== undefined) {
  model.styleId = undefined;
}

switch (model.type) {
  case Enums.ValueType.String:
    if (typeof model.value === &#x27;number&#x27;) {
      model.value = options.sharedStrings.<span class="apidocCodeKeywordSpan">getString</span>(model.value);
    }
    if (model.value.richText) {
      model.type = Enums.ValueType.RichText;
    }
    break;
  case Enums.ValueType.Number:
    if (style &#x26;&#x26; utils.isDateFmt(style.numFmt)) {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.static_xform" id="apidoc.module.exceljs.static_xform">module exceljs.static_xform</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.static_xform.static_xform" id="apidoc.element.exceljs.static_xform.static_xform">
        function <span class="apidocSignatureSpan">exceljs.</span>static_xform
        <span class="apidocSignatureSpan">(model)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">static_xform = function (model) {
  // This class is an optimisation for static (unimportant and unchanging) xml
  // It is stateless - apart from its static model and so can be used as a singleton
  // Being stateless - it will only track entry to and exit from it&#x27;s root xml tag during parsing and nothing else
  // Known issues:
  //    since stateless - parseOpen always returns true. Parent xform must know when to start using this xform
  //    if the root tag is recursive, the parsing will behave unpredictably
  this._model = model;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.static_xform.super_" id="apidoc.element.exceljs.static_xform.super_">
        function <span class="apidocSignatureSpan">exceljs.static_xform.</span>super_
        <span class="apidocSignatureSpan">(model, name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">super_ = function (model, name) {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.static_xform.prototype" id="apidoc.module.exceljs.static_xform.prototype">module exceljs.static_xform.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.static_xform.prototype.parseClose" id="apidoc.element.exceljs.static_xform.prototype.parseClose">
        function <span class="apidocSignatureSpan">exceljs.static_xform.prototype.</span>parseClose
        <span class="apidocSignatureSpan">(name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parseClose = function (name) {
  switch(name) {
    case this._model.tag:
      return false;
    default:
      return true;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
parser.on(&#x27;opentag&#x27;, function (node) {
  self.parseOpen(node);
});
parser.on(&#x27;text&#x27;, function (text) {
  self.parseText(text);
});
parser.on(&#x27;closetag&#x27;, function (name) {
  if (!self.<span class="apidocCodeKeywordSpan">parseClose</span>(name)) {
    resolve(self.model);
  }
});
parser.on(&#x27;end&#x27;, function () {
  resolve(self.model);
});
parser.on(&#x27;error&#x27;, function (error) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.static_xform.prototype.parseOpen" id="apidoc.element.exceljs.static_xform.prototype.parseOpen">
        function <span class="apidocSignatureSpan">exceljs.static_xform.prototype.</span>parseOpen
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parseOpen = function () {
  return true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  // to make sure parses don&#x27;t bleed to next iteration
  this.model = model;
},
parse: function parse(parser) {
  var self = this;
  return new PromishLib.Promish(function (resolve, reject) {
    parser.on(&#x27;opentag&#x27;, function (node) {
      self.<span class="apidocCodeKeywordSpan">parseOpen</span>(node);
    });
    parser.on(&#x27;text&#x27;, function (text) {
      self.parseText(text);
    });
    parser.on(&#x27;closetag&#x27;, function (name) {
      if (!self.parseClose(name)) {
        resolve(self.model);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.static_xform.prototype.parseText" id="apidoc.element.exceljs.static_xform.prototype.parseText">
        function <span class="apidocSignatureSpan">exceljs.static_xform.prototype.</span>parseText
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parseText = function () {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  parse: function parse(parser) {
var self = this;
return new PromishLib.Promish(function (resolve, reject) {
  parser.on(&#x27;opentag&#x27;, function (node) {
    self.parseOpen(node);
  });
  parser.on(&#x27;text&#x27;, function (text) {
    self.<span class="apidocCodeKeywordSpan">parseText</span>(text);
  });
  parser.on(&#x27;closetag&#x27;, function (name) {
    if (!self.parseClose(name)) {
      resolve(self.model);
    }
  });
  parser.on(&#x27;end&#x27;, function () {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.static_xform.prototype.render" id="apidoc.element.exceljs.static_xform.prototype.render">
        function <span class="apidocSignatureSpan">exceljs.static_xform.prototype.</span>render
        <span class="apidocSignatureSpan">(xmlStream)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">render = function (xmlStream) {
  if (!this._xml) {
    var stream = new XmlStream();
    build(stream, this._model);
    this._xml = stream.xml;
  }
  xmlStream.writeXml(this._xml);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    // convenience function to get the xml of this.model
    // useful for manager types that are built during the prepare phase
    return this.toXml(this.model);
  },

  toXml: function toXml(model) {
    var xmlStream = new XmlStream();
    this.<span class="apidocCodeKeywordSpan">render</span>(xmlStream, model);
    return xmlStream.xml;
  }
};


},{&#x22;../../utils/promish&#x22;:15,&#x22;../../utils/xml-stream&#x22;:21,&#x22;sax&#x22;:188}],26:[function(require,module,exports
){
/**
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.stream_base64" id="apidoc.module.exceljs.stream_base64">module exceljs.stream_base64</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.stream_base64.stream_base64" id="apidoc.element.exceljs.stream_base64.stream_base64">
        function <span class="apidocSignatureSpan">exceljs.</span>stream_base64
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">stream_base64 = function (options) {
  options = options || {};

  // consuming pipe streams go here
  this.pipes = [];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_base64.super_" id="apidoc.element.exceljs.stream_base64.super_">
        function <span class="apidocSignatureSpan">exceljs.stream_base64.</span>super_
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Duplex(options) {
  if (!(this instanceof Duplex))
    return new Duplex(options);

  Readable.call(this, options);
  Writable.call(this, options);

  if (options &#x26;&#x26; options.readable === false)
    this.readable = false;

  if (options &#x26;&#x26; options.writable === false)
    this.writable = false;

  this.allowHalfOpen = true;
  if (options &#x26;&#x26; options.allowHalfOpen === false)
    this.allowHalfOpen = false;

  this.once(&#x27;end&#x27;, onend);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.stream_base64.prototype" id="apidoc.module.exceljs.stream_base64.prototype">module exceljs.stream_base64.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.stream_base64.prototype.cork" id="apidoc.element.exceljs.stream_base64.prototype.cork">
        function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>cork
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">cork = function () {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

// ==========================================================================
// Stream.Writable interface
write: function write(data, encoding, callback) {
  return this.stream.write(data, encoding, callback);
},
cork: function cork() {
  return this.stream.<span class="apidocCodeKeywordSpan">cork</span>();
},
uncork: function uncork() {
  return this.stream.uncork();
},
end: function end() {
  return this.stream.end();
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_base64.prototype.end" id="apidoc.element.exceljs.stream_base64.prototype.end">
        function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>end
        <span class="apidocSignatureSpan">(chunk, encoding, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">end = function (chunk, encoding, callback) {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      }
      var values = row.values;
      values.shift();
      csvStream.write(values.map(map));
      lastRow = rowNumber;
    });
  }
  csvStream.<span class="apidocCodeKeywordSpan">end</span>();
});
  },
  writeFile: function writeFile(filename, options) {
options = options || {};

var streamOptions = {
  encoding: options.encoding || &#x27;utf8&#x27;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_base64.prototype.isPaused" id="apidoc.element.exceljs.stream_base64.prototype.isPaused">
        function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>isPaused
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isPaused = function () {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
pause: function pause() {
  return this.stream.pause();
},
resume: function resume() {
  return this.stream.resume();
},
isPaused: function isPaused() {
  return this.stream.<span class="apidocCodeKeywordSpan">isPaused</span>();
},
pipe: function pipe(destination, options) {
  return this.stream.pipe(destination, options);
},
unpipe: function unpipe(destination) {
  return this.stream.unpipe(destination);
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_base64.prototype.pause" id="apidoc.element.exceljs.stream_base64.prototype.pause">
        function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>pause
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pause = function () {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
read: function read(size) {
  return this.stream.read(size);
},
setEncoding: function setEncoding(encoding) {
  return this.stream.setEncoding(encoding);
},
pause: function pause() {
  return this.stream.<span class="apidocCodeKeywordSpan">pause</span>();
},
resume: function resume() {
  return this.stream.resume();
},
isPaused: function isPaused() {
  return this.stream.isPaused();
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_base64.prototype.pipe" id="apidoc.element.exceljs.stream_base64.prototype.pipe">
        function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>pipe
        <span class="apidocSignatureSpan">(destination, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pipe = function (destination, options) {
  // add destination to pipe list &#x26; write current buffer
  this.pipes.push(destination);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
workbook.xlsx.readFile(filename)
    .then(function() {
        // use workbook
    });

// pipe from stream
var workbook = new Excel.Workbook();
stream.<span class="apidocCodeKeywordSpan">pipe</span>(workbook.xlsx.createInputStream());
```

#### Writing XLSX

```javascript
// write to a file
var workbook = createAndFillWorkbook();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_base64.prototype.read" id="apidoc.element.exceljs.stream_base64.prototype.read">
        function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>read
        <span class="apidocSignatureSpan">(size)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">read = function (size) {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
workbook.csv.readFile(filename)
    .then(function(worksheet) {
        // use workbook or worksheet
    });

// read from a stream
var workbook = new Excel.Workbook();
workbook.csv.<span class="apidocCodeKeywordSpan">read</span>(stream)
    .then(function(worksheet) {
        // use workbook or worksheet
    });

// pipe from stream
var workbook = new Excel.Workbook();
stream.pipe(workbook.csv.createInputStream());
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_base64.prototype.resume" id="apidoc.element.exceljs.stream_base64.prototype.resume">
        function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>resume
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">resume = function () {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
setEncoding: function setEncoding(encoding) {
  return this.stream.setEncoding(encoding);
},
pause: function pause() {
  return this.stream.pause();
},
resume: function resume() {
  return this.stream.<span class="apidocCodeKeywordSpan">resume</span>();
},
isPaused: function isPaused() {
  return this.stream.isPaused();
},
pipe: function pipe(destination, options) {
  return this.stream.pipe(destination, options);
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_base64.prototype.setEncoding" id="apidoc.element.exceljs.stream_base64.prototype.setEncoding">
        function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>setEncoding
        <span class="apidocSignatureSpan">(encoding)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setEncoding = function (encoding) {
  // causes stream.read or stream.on(&#x27;data) to return strings of encoding instead of Buffer objects
  this.encoding = encoding;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

// ==========================================================================
// Stream.Readable interface
read: function read(size) {
  return this.stream.read(size);
},
setEncoding: function setEncoding(encoding) {
  return this.stream.<span class="apidocCodeKeywordSpan">setEncoding</span>(encoding);
},
pause: function pause() {
  return this.stream.pause();
},
resume: function resume() {
  return this.stream.resume();
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_base64.prototype.uncork" id="apidoc.element.exceljs.stream_base64.prototype.uncork">
        function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>uncork
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">uncork = function () {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  write: function write(data, encoding, callback) {
    return this.stream.write(data, encoding, callback);
  },
  cork: function cork() {
    return this.stream.cork();
  },
  uncork: function uncork() {
    return this.stream.<span class="apidocCodeKeywordSpan">uncork</span>();
  },
  end: function end() {
    return this.stream.end();
  }
});

// =============================================================================
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_base64.prototype.unpipe" id="apidoc.element.exceljs.stream_base64.prototype.unpipe">
        function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>unpipe
        <span class="apidocSignatureSpan">(destination)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">unpipe = function (destination) {
  // remove destination from pipe list
  this.pipes = this.pipes.filter(function(pipe) {
    return pipe !== destination;
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
isPaused: function isPaused() {
  return this.stream.isPaused();
},
pipe: function pipe(destination, options) {
  return this.stream.pipe(destination, options);
},
unpipe: function unpipe(destination) {
  return this.stream.<span class="apidocCodeKeywordSpan">unpipe</span>(destination);
},
unshift: function unshift(chunk) {
  return this.stream.unshift(chunk);
},
wrap: function wrap(stream) {
  return this.stream.wrap(stream);
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_base64.prototype.unshift" id="apidoc.element.exceljs.stream_base64.prototype.unshift">
        function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>unshift
        <span class="apidocSignatureSpan">(chunk)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">unshift = function (chunk) {
  // some numpty has read some data that&#x27;s not for them and they want to put it back!
  // Might implement this some day
  throw new Error(&#x27;Not Implemented&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  pipe: function pipe(destination, options) {
    return this.stream.pipe(destination, options);
  },
  unpipe: function unpipe(destination) {
    return this.stream.unpipe(destination);
  },
  unshift: function unshift(chunk) {
    return this.stream.<span class="apidocCodeKeywordSpan">unshift</span>(chunk);
  },
  wrap: function wrap(stream) {
    return this.stream.wrap(stream);
  }
});

// =============================================================================
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_base64.prototype.wrap" id="apidoc.element.exceljs.stream_base64.prototype.wrap">
        function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>wrap
        <span class="apidocSignatureSpan">(stream)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">wrap = function (stream) {
  // not implemented
  throw new Error(&#x27;Not Implemented&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
unpipe: function unpipe(destination) {
  return this.stream.unpipe(destination);
},
unshift: function unshift(chunk) {
  return this.stream.unshift(chunk);
},
wrap: function wrap(stream) {
  return this.stream.<span class="apidocCodeKeywordSpan">wrap</span>(stream);
}
});

// =============================================================================

module.exports = {
ZipReader: ZipReader,
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_base64.prototype.write" id="apidoc.element.exceljs.stream_base64.prototype.write">
        function <span class="apidocSignatureSpan">exceljs.stream_base64.prototype.</span>write
        <span class="apidocSignatureSpan">(data, encoding, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">write = function (data, encoding, callback) {
  if (encoding instanceof Function) {
    callback = encoding;
    encoding = &#x27;utf8&#x27;;
  }
  callback = callback || utils.nop;

  return true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var workbook = createAndFillWorkbook();
workbook.xlsx.writeFile(filename)
    .then(function() {
        // done
    });

// write to a stream
workbook.xlsx.<span class="apidocCodeKeywordSpan">write</span>(stream)
    .then(function() {
        // done
    });
```

### CSV
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.stream_buf" id="apidoc.module.exceljs.stream_buf">module exceljs.stream_buf</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.stream_buf.stream_buf" id="apidoc.element.exceljs.stream_buf.stream_buf">
        function <span class="apidocSignatureSpan">exceljs.</span>stream_buf
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">stream_buf = function (options) {
  options = options || {};
  this.bufSize = options.bufSize || 1024 * 1024;
  this.buffers = [];

  // batch mode fills a buffer completely before passing the data on
  // to pipes or &#x27;readable&#x27; event listeners
  this.batch = options.batch || false;

  this.corked = false;
  // where in the current writable buffer we&#x27;re up to
  this.inPos = 0;

  // where in the current readable buffer we&#x27;ve read up to
  this.outPos = 0;

  // consuming pipe streams go here
  this.pipes = [];

  // controls emit(&#x27;data&#x27;)
  this.paused = false;

  this.encoding = null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_buf.super_" id="apidoc.element.exceljs.stream_buf.super_">
        function <span class="apidocSignatureSpan">exceljs.stream_buf.</span>super_
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Duplex(options) {
  if (!(this instanceof Duplex))
    return new Duplex(options);

  Readable.call(this, options);
  Writable.call(this, options);

  if (options &#x26;&#x26; options.readable === false)
    this.readable = false;

  if (options &#x26;&#x26; options.writable === false)
    this.writable = false;

  this.allowHalfOpen = true;
  if (options &#x26;&#x26; options.allowHalfOpen === false)
    this.allowHalfOpen = false;

  this.once(&#x27;end&#x27;, onend);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.stream_buf.prototype" id="apidoc.module.exceljs.stream_buf.prototype">module exceljs.stream_buf.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.stream_buf.prototype._flush" id="apidoc.element.exceljs.stream_buf.prototype._flush">
        function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>_flush
        <span class="apidocSignatureSpan">(destination)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_flush = function (destination) {
  // if we have comsumers...
  if (this.pipes.length) {
    // and there&#x27;s stuff not written
    while (this.buffers.length) {
      this._pipe(this.buffers.shift());
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    while (this.buffers.length) {
      this._pipe(this.buffers.shift());
    }
  }
},
uncork: function uncork() {
  this.corked = false;
  this.<span class="apidocCodeKeywordSpan">_flush</span>();
},
end: function end(chunk, encoding, callback) {
  var self = this;
  var writeComplete = function writeComplete(error) {
    if (error) {
      callback(error);
    } else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_buf.prototype._getWritableBuffer" id="apidoc.element.exceljs.stream_buf.prototype._getWritableBuffer">
        function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>_getWritableBuffer
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_getWritableBuffer = function () {
  if (this.buffers.length) {
    var last = this.buffers[this.buffers.length - 1];
    if (!last.full) {
      return last;
    }
  }
  var buf = new ReadWriteBuf(this.bufSize);
  this.buffers.push(buf);
  return buf;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return promises.length ? PromishLib.Promish.all(promises).then(utils.nop) : PromishLib.Promish.resolve();
},
_writeToBuffers: function _writeToBuffers(chunk) {
  var inPos = 0;
  var inLen = chunk.length;
  while (inPos &#x3c; inLen) {
    // find writable buffer
    var buffer = this.<span class="apidocCodeKeywordSpan">_getWritableBuffer</span>();

    // write some data
    inPos += buffer.write(chunk, inPos, inLen - inPos);
  }
},
write: function write(data, encoding, callback) {
  if (encoding instanceof Function) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_buf.prototype._pipe" id="apidoc.element.exceljs.stream_buf.prototype._pipe">
        function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>_pipe
        <span class="apidocSignatureSpan">(chunk)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_pipe = function (chunk) {
  var write = function(pipe) {
    return new PromishLib.Promish(function(resolve, reject) {
      pipe.write(chunk.toBuffer(), function() {
        resolve();
      });
    });
  };
  var promises = this.pipes.map(write);
  return promises.length ?
    PromishLib.Promish.all(promises).then(utils.nop) :
    PromishLib.Promish.resolve();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

// now, do something with the chunk
if (this.pipes.length) {
  if (this.batch) {
    this._writeToBuffers(chunk);
    while (!this.corked &#x26;&#x26; this.buffers.length &#x3e; 1) {
      this.<span class="apidocCodeKeywordSpan">_pipe</span>(this.buffers.shift());
    }
  } else {
    if (!this.corked) {
      this._pipe(chunk).then(callback);
    } else {
      this._writeToBuffers(chunk);
      process.nextTick(callback);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_buf.prototype._writeToBuffers" id="apidoc.element.exceljs.stream_buf.prototype._writeToBuffers">
        function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>_writeToBuffers
        <span class="apidocSignatureSpan">(chunk)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_writeToBuffers = function (chunk) {
  var inPos = 0;
  var inLen = chunk.length;
  while (inPos &#x3c; inLen) {
    // find writable buffer
    var buffer = this._getWritableBuffer();

    // write some data
    inPos += buffer.write(chunk, inPos, inLen - inPos);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  // assume string
  chunk = new StringChunk(data, encoding);
}

// now, do something with the chunk
if (this.pipes.length) {
  if (this.batch) {
    this.<span class="apidocCodeKeywordSpan">_writeToBuffers</span>(chunk);
    while (!this.corked &#x26;&#x26; this.buffers.length &#x3e; 1) {
      this._pipe(this.buffers.shift());
    }
  } else {
    if (!this.corked) {
      this._pipe(chunk).then(callback);
    } else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_buf.prototype.cork" id="apidoc.element.exceljs.stream_buf.prototype.cork">
        function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>cork
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">cork = function () {
  this.corked = true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

// ==========================================================================
// Stream.Writable interface
write: function write(data, encoding, callback) {
  return this.stream.write(data, encoding, callback);
},
cork: function cork() {
  return this.stream.<span class="apidocCodeKeywordSpan">cork</span>();
},
uncork: function uncork() {
  return this.stream.uncork();
},
end: function end() {
  return this.stream.end();
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_buf.prototype.end" id="apidoc.element.exceljs.stream_buf.prototype.end">
        function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>end
        <span class="apidocSignatureSpan">(chunk, encoding, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">end = function (chunk, encoding, callback) {
  var self = this;
  var writeComplete = function(error) {
    if (error) {
      callback(error);
    } else {
      self._flush();
      self.pipes.forEach(function(pipe) {
        pipe.end();
      });
      self.emit(&#x27;finish&#x27;);
    }
  };
  if (chunk) {
    this.write(chunk, encoding, writeComplete);
  } else {
    writeComplete();
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      }
      var values = row.values;
      values.shift();
      csvStream.write(values.map(map));
      lastRow = rowNumber;
    });
  }
  csvStream.<span class="apidocCodeKeywordSpan">end</span>();
});
  },
  writeFile: function writeFile(filename, options) {
options = options || {};

var streamOptions = {
  encoding: options.encoding || &#x27;utf8&#x27;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_buf.prototype.isPaused" id="apidoc.element.exceljs.stream_buf.prototype.isPaused">
        function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>isPaused
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isPaused = function () {
  return this.paused ? true : false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
pause: function pause() {
  return this.stream.pause();
},
resume: function resume() {
  return this.stream.resume();
},
isPaused: function isPaused() {
  return this.stream.<span class="apidocCodeKeywordSpan">isPaused</span>();
},
pipe: function pipe(destination, options) {
  return this.stream.pipe(destination, options);
},
unpipe: function unpipe(destination) {
  return this.stream.unpipe(destination);
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_buf.prototype.pause" id="apidoc.element.exceljs.stream_buf.prototype.pause">
        function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>pause
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pause = function () {
  this.paused = true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
read: function read(size) {
  return this.stream.read(size);
},
setEncoding: function setEncoding(encoding) {
  return this.stream.setEncoding(encoding);
},
pause: function pause() {
  return this.stream.<span class="apidocCodeKeywordSpan">pause</span>();
},
resume: function resume() {
  return this.stream.resume();
},
isPaused: function isPaused() {
  return this.stream.isPaused();
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_buf.prototype.pipe" id="apidoc.element.exceljs.stream_buf.prototype.pipe">
        function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>pipe
        <span class="apidocSignatureSpan">(destination, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pipe = function (destination, options) {
  // add destination to pipe list &#x26; write current buffer
  this.pipes.push(destination);
  if (!this.paused &#x26;&#x26; this.buffers.length) {
    this.end();
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
workbook.xlsx.readFile(filename)
    .then(function() {
        // use workbook
    });

// pipe from stream
var workbook = new Excel.Workbook();
stream.<span class="apidocCodeKeywordSpan">pipe</span>(workbook.xlsx.createInputStream());
```

#### Writing XLSX

```javascript
// write to a file
var workbook = createAndFillWorkbook();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_buf.prototype.read" id="apidoc.element.exceljs.stream_buf.prototype.read">
        function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>read
        <span class="apidocSignatureSpan">(size)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">read = function (size) {
  // read min(buffer, size || infinity)
  if (size) {
    var buffers = [];
    while (size &#x26;&#x26; this.buffers.length &#x26;&#x26; !this.buffers[0].eod) {
      var first = this.buffers[0];
      var buffer = first.read(size);
      size -= buffer.length;
      buffers.push(buffer);
      if (first.eod &#x26;&#x26; first.full) {
        this.buffers.shift();
      }
    }
    return Buffer.concat(buffers);
  } else {
    var buffers = this.buffers.map(function(buffer) {
      return buffer.toBuffer();
    }).filter(function(data) {
      return data;
    });
    this.buffers = [];
    return Buffer.concat(buffers);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
workbook.csv.readFile(filename)
    .then(function(worksheet) {
        // use workbook or worksheet
    });

// read from a stream
var workbook = new Excel.Workbook();
workbook.csv.<span class="apidocCodeKeywordSpan">read</span>(stream)
    .then(function(worksheet) {
        // use workbook or worksheet
    });

// pipe from stream
var workbook = new Excel.Workbook();
stream.pipe(workbook.csv.createInputStream());
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_buf.prototype.resume" id="apidoc.element.exceljs.stream_buf.prototype.resume">
        function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>resume
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">resume = function () {
  this.paused = false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
setEncoding: function setEncoding(encoding) {
  return this.stream.setEncoding(encoding);
},
pause: function pause() {
  return this.stream.pause();
},
resume: function resume() {
  return this.stream.<span class="apidocCodeKeywordSpan">resume</span>();
},
isPaused: function isPaused() {
  return this.stream.isPaused();
},
pipe: function pipe(destination, options) {
  return this.stream.pipe(destination, options);
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_buf.prototype.setEncoding" id="apidoc.element.exceljs.stream_buf.prototype.setEncoding">
        function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>setEncoding
        <span class="apidocSignatureSpan">(encoding)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setEncoding = function (encoding) {
  // causes stream.read or stream.on(&#x27;data) to return strings of encoding instead of Buffer objects
  this.encoding = encoding;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

// ==========================================================================
// Stream.Readable interface
read: function read(size) {
  return this.stream.read(size);
},
setEncoding: function setEncoding(encoding) {
  return this.stream.<span class="apidocCodeKeywordSpan">setEncoding</span>(encoding);
},
pause: function pause() {
  return this.stream.pause();
},
resume: function resume() {
  return this.stream.resume();
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_buf.prototype.uncork" id="apidoc.element.exceljs.stream_buf.prototype.uncork">
        function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>uncork
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">uncork = function () {
  this.corked = false;
  this._flush();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  write: function write(data, encoding, callback) {
    return this.stream.write(data, encoding, callback);
  },
  cork: function cork() {
    return this.stream.cork();
  },
  uncork: function uncork() {
    return this.stream.<span class="apidocCodeKeywordSpan">uncork</span>();
  },
  end: function end() {
    return this.stream.end();
  }
});

// =============================================================================
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_buf.prototype.unpipe" id="apidoc.element.exceljs.stream_buf.prototype.unpipe">
        function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>unpipe
        <span class="apidocSignatureSpan">(destination)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">unpipe = function (destination) {
  // remove destination from pipe list
  this.pipes = this.pipes.filter(function(pipe) {
    return pipe !== destination;
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
isPaused: function isPaused() {
  return this.stream.isPaused();
},
pipe: function pipe(destination, options) {
  return this.stream.pipe(destination, options);
},
unpipe: function unpipe(destination) {
  return this.stream.<span class="apidocCodeKeywordSpan">unpipe</span>(destination);
},
unshift: function unshift(chunk) {
  return this.stream.unshift(chunk);
},
wrap: function wrap(stream) {
  return this.stream.wrap(stream);
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_buf.prototype.unshift" id="apidoc.element.exceljs.stream_buf.prototype.unshift">
        function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>unshift
        <span class="apidocSignatureSpan">(chunk)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">unshift = function (chunk) {
  // some numpty has read some data that&#x27;s not for them and they want to put it back!
  // Might implement this some day
  throw new Error(&#x27;Not Implemented&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  pipe: function pipe(destination, options) {
    return this.stream.pipe(destination, options);
  },
  unpipe: function unpipe(destination) {
    return this.stream.unpipe(destination);
  },
  unshift: function unshift(chunk) {
    return this.stream.<span class="apidocCodeKeywordSpan">unshift</span>(chunk);
  },
  wrap: function wrap(stream) {
    return this.stream.wrap(stream);
  }
});

// =============================================================================
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_buf.prototype.wrap" id="apidoc.element.exceljs.stream_buf.prototype.wrap">
        function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>wrap
        <span class="apidocSignatureSpan">(stream)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">wrap = function (stream) {
  // not implemented
  throw new Error(&#x27;Not Implemented&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
unpipe: function unpipe(destination) {
  return this.stream.unpipe(destination);
},
unshift: function unshift(chunk) {
  return this.stream.unshift(chunk);
},
wrap: function wrap(stream) {
  return this.stream.<span class="apidocCodeKeywordSpan">wrap</span>(stream);
}
});

// =============================================================================

module.exports = {
ZipReader: ZipReader,
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_buf.prototype.write" id="apidoc.element.exceljs.stream_buf.prototype.write">
        function <span class="apidocSignatureSpan">exceljs.stream_buf.prototype.</span>write
        <span class="apidocSignatureSpan">(data, encoding, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">write = function (data, encoding, callback) {
  if (encoding instanceof Function) {
    callback = encoding;
    encoding = &#x27;utf8&#x27;;
  }
  callback = callback || utils.nop;

  // encapsulate data into a chunk
  var chunk;
  if (data instanceof StringBuf) {
    chunk = new StringBufChunk(data);
  } else if (data instanceof Buffer) {
    chunk = new BufferChunk(data);
  } else {
    // assume string
    chunk = new StringChunk(data, encoding);
  }

  // now, do something with the chunk
  if (this.pipes.length) {
    if (this.batch) {
      this._writeToBuffers(chunk);
      while (!this.corked &#x26;&#x26; (this.buffers.length &#x3e; 1)) {
        this._pipe(this.buffers.shift());
      }
    } else {
      if (!this.corked) {
        this._pipe(chunk).then(callback);
      } else {
        this._writeToBuffers(chunk);
        process.nextTick(callback);
      }
    }
  } else {
    if (!this.paused) {
      this.emit(&#x27;data&#x27;, chunk.toBuffer());
    }

    this._writeToBuffers(chunk);
    this.emit(&#x27;readable&#x27;);
  }

  return true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var workbook = createAndFillWorkbook();
workbook.xlsx.writeFile(filename)
    .then(function() {
        // done
    });

// write to a stream
workbook.xlsx.<span class="apidocCodeKeywordSpan">write</span>(stream)
    .then(function() {
        // done
    });
```

### CSV
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.stream_converter" id="apidoc.module.exceljs.stream_converter">module exceljs.stream_converter</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.stream_converter.stream_converter" id="apidoc.element.exceljs.stream_converter.stream_converter">
        function <span class="apidocSignatureSpan">exceljs.</span>stream_converter
        <span class="apidocSignatureSpan">(inner, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">stream_converter = function (inner, options) {

    this.inner = inner;

    options = options || {};
    this.innerEncoding = (options.innerEncoding || &#x27;UTF8&#x27;).toUpperCase();
    this.outerEncoding = (options.outerEncoding || &#x27;UTF8&#x27;).toUpperCase();

    this.innerBOM = options.innerBOM || null;
    this.outerBOM = options.outerBOM || null;

    this.writeStarted = false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.stream_converter.prototype" id="apidoc.module.exceljs.stream_converter.prototype">module exceljs.stream_converter.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.stream_converter.prototype.addListener" id="apidoc.element.exceljs.stream_converter.prototype.addListener">
        function <span class="apidocSignatureSpan">exceljs.stream_converter.prototype.</span>addListener
        <span class="apidocSignatureSpan">(event, handler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addListener = function (event, handler) {
    this.inner.addListener(event, handler);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (this.innerEncoding != this.outerEncoding) {
        data = jconv.convert(data, this.innerEncoding, this.outerEncoding);
    }
    return data;
};

StreamConverter.prototype.addListener = function(event, handler) {
    this.inner.<span class="apidocCodeKeywordSpan">addListener</span>(event, handler);
};

StreamConverter.prototype.removeListener = function(event, handler) {
    this.inner.removeListener(event, handler);
}

StreamConverter.prototype.write = function(data, encoding, callback) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_converter.prototype.close" id="apidoc.element.exceljs.stream_converter.prototype.close">
        function <span class="apidocSignatureSpan">exceljs.stream_converter.prototype.</span>close
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">close = function () {
    this.inner.close();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return utils.fs.exists(filename).then(function (exists) {
    if (!exists) {
      throw new Error(&#x27;File not found: &#x27; + filename);
    }
    stream = fs.createReadStream(filename);
    return self.read(stream, options);
  }).then(function (worksheet) {
    stream.<span class="apidocCodeKeywordSpan">close</span>();
    return worksheet;
  });
},
read: function read(stream, options) {
  options = options || {};
  var self = this;
  return new PromishLib.Promish(function (resolve, reject) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_converter.prototype.convertInwards" id="apidoc.element.exceljs.stream_converter.prototype.convertInwards">
        function <span class="apidocSignatureSpan">exceljs.stream_converter.prototype.</span>convertInwards
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">convertInwards = function (data) {
    var self = this;
    if (data) {
        if (typeof(data) == &#x27;string&#x27;) {
            data = new Buffer(data, this.outerEncoding);
        }

        if (this.innerEncoding != this.outerEncoding) {
            data = jconv.convert(data, this.outerEncoding, this.innerEncoding);
        }
    }

    return data;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
            data = bomless;
        }

        this.writeStarted = true;
    }

    this.inner.write(
        this.<span class="apidocCodeKeywordSpan">convertInwards</span>(data),
        encoding ? this.innerEncoding : undefined,
        callback);
};

StreamConverter.prototype.read = function() {
    // TBD
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_converter.prototype.convertOutwards" id="apidoc.element.exceljs.stream_converter.prototype.convertOutwards">
        function <span class="apidocSignatureSpan">exceljs.stream_converter.prototype.</span>convertOutwards
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">convertOutwards = function (data) {
    var self = this;
    if (typeof(data) == &#x27;string&#x27;) {
        data = new Buffer(data, this.innerEncoding);
    }

    if (this.innerEncoding != this.outerEncoding) {
        data = jconv.convert(data, this.innerEncoding, this.outerEncoding);
    }
    return data;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

StreamConverter.prototype.on = function(type, callback) {
    var self = this;
    switch (type) {
        case &#x27;data&#x27;:
            this.inner.on(&#x27;data&#x27;, function(chunk) {
                callback(self.<span class="apidocCodeKeywordSpan">convertOutwards</span>(chunk));
            });
            return this;
        default:
            this.inner.on(type, callback);
            return this;
    }
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_converter.prototype.emit" id="apidoc.element.exceljs.stream_converter.prototype.emit">
        function <span class="apidocSignatureSpan">exceljs.stream_converter.prototype.</span>emit
        <span class="apidocSignatureSpan">(type, value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">emit = function (type, value) {
    this.inner.emit(type, value);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  }
  return datum;
};

var csvStream = csv(options).on(&#x27;data&#x27;, function (data) {
  worksheet.addRow(data.map(map));
}).on(&#x27;end&#x27;, function () {
  csvStream.<span class="apidocCodeKeywordSpan">emit</span>(&#x27;worksheet&#x27;, worksheet);
});
return csvStream;
  },

  write: function write(stream, options) {

var self = this;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_converter.prototype.end" id="apidoc.element.exceljs.stream_converter.prototype.end">
        function <span class="apidocSignatureSpan">exceljs.stream_converter.prototype.</span>end
        <span class="apidocSignatureSpan">(chunk, encoding, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">end = function (chunk, encoding, callback) {
    this.inner.end(
        this.convertInwards(chunk),
        this.innerEncoding,
        callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      }
      var values = row.values;
      values.shift();
      csvStream.write(values.map(map));
      lastRow = rowNumber;
    });
  }
  csvStream.<span class="apidocCodeKeywordSpan">end</span>();
});
  },
  writeFile: function writeFile(filename, options) {
options = options || {};

var streamOptions = {
  encoding: options.encoding || &#x27;utf8&#x27;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_converter.prototype.on" id="apidoc.element.exceljs.stream_converter.prototype.on">
        function <span class="apidocSignatureSpan">exceljs.stream_converter.prototype.</span>on
        <span class="apidocSignatureSpan">(type, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">on = function (type, callback) {
    var self = this;
    switch (type) {
        case &#x27;data&#x27;:
            this.inner.on(&#x27;data&#x27;, function(chunk) {
                callback(self.convertOutwards(chunk));
            });
            return this;
        default:
            this.inner.on(type, callback);
            return this;
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
});
  },
  read: function read(stream, options) {
options = options || {};
var self = this;
return new PromishLib.Promish(function (resolve, reject) {

  var csvStream = self.createInputStream(options).<span class="apidocCodeKeywordSpan">on</span>(&#x27;worksheet&#x27;, function (
worksheet) {
    resolve(worksheet);
  }).on(&#x27;error&#x27;, function (error) {
    reject(error);
  });

  stream.pipe(csvStream);
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_converter.prototype.once" id="apidoc.element.exceljs.stream_converter.prototype.once">
        function <span class="apidocSignatureSpan">exceljs.stream_converter.prototype.</span>once
        <span class="apidocSignatureSpan">(type, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">once = function (type, callback) {
    this.inner.once(type, callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    default:
        this.inner.on(type, callback);
        return this;
}
};

StreamConverter.prototype.once = function(type, callback) {
this.inner.<span class="apidocCodeKeywordSpan">once</span>(type, callback);
};

StreamConverter.prototype.end = function(chunk, encoding, callback) {
this.inner.end(
    this.convertInwards(chunk),
    this.innerEncoding,
    callback);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_converter.prototype.pipe" id="apidoc.element.exceljs.stream_converter.prototype.pipe">
        function <span class="apidocSignatureSpan">exceljs.stream_converter.prototype.</span>pipe
        <span class="apidocSignatureSpan">(destination, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pipe = function (destination, options) {
    var reverseConverter = new StreamConverter(destination, {
        innerEncoding: this.outerEncoding,
        outerEncoding: this.innerEncoding,
        innerBOM: this.outerBOM,
        outerBOM: this.innerBOM
    });

    this.inner.pipe(reverseConverter, options)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
workbook.xlsx.readFile(filename)
    .then(function() {
        // use workbook
    });

// pipe from stream
var workbook = new Excel.Workbook();
stream.<span class="apidocCodeKeywordSpan">pipe</span>(workbook.xlsx.createInputStream());
```

#### Writing XLSX

```javascript
// write to a file
var workbook = createAndFillWorkbook();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_converter.prototype.read" id="apidoc.element.exceljs.stream_converter.prototype.read">
        function <span class="apidocSignatureSpan">exceljs.stream_converter.prototype.</span>read
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">read = function () {
    // TBD
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
workbook.csv.readFile(filename)
    .then(function(worksheet) {
        // use workbook or worksheet
    });

// read from a stream
var workbook = new Excel.Workbook();
workbook.csv.<span class="apidocCodeKeywordSpan">read</span>(stream)
    .then(function(worksheet) {
        // use workbook or worksheet
    });

// pipe from stream
var workbook = new Excel.Workbook();
stream.pipe(workbook.csv.createInputStream());
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_converter.prototype.removeListener" id="apidoc.element.exceljs.stream_converter.prototype.removeListener">
        function <span class="apidocSignatureSpan">exceljs.stream_converter.prototype.</span>removeListener
        <span class="apidocSignatureSpan">(event, handler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">removeListener = function (event, handler) {
    this.inner.removeListener(event, handler);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

StreamConverter.prototype.addListener = function(event, handler) {
this.inner.addListener(event, handler);
};

StreamConverter.prototype.removeListener = function(event, handler) {
this.inner.<span class="apidocCodeKeywordSpan">removeListener</span>(event, handler);
}

StreamConverter.prototype.write = function(data, encoding, callback) {
if (encoding instanceof Function) {
    callback = encoding;
    encoding = undefined;
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stream_converter.prototype.write" id="apidoc.element.exceljs.stream_converter.prototype.write">
        function <span class="apidocSignatureSpan">exceljs.stream_converter.prototype.</span>write
        <span class="apidocSignatureSpan">(data, encoding, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">write = function (data, encoding, callback) {
    if (encoding instanceof Function) {
        callback = encoding;
        encoding = undefined;
    }

    if (!this.writeStarted) {

        // if inner encoding has BOM, write it now
        if (this.innerBOM) {
            this.inner.write(this.innerBOM);
        }

        // if outer encoding has BOM, delete it now
        if (this.outerBOM) {
            if (data.length &#x3c;= this.outerBOM.length) {
                if (callback) { callback(); }
                return;
            }
            var bomless = new Buffer(data.length - this.outerBOM.length);
            data.copy(bomless, 0, this.outerBOM.length, data.length);
            data = bomless;
        }

        this.writeStarted = true;
    }

    this.inner.write(
        this.convertInwards(data),
        encoding ? this.innerEncoding : undefined,
        callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var workbook = createAndFillWorkbook();
workbook.xlsx.writeFile(filename)
    .then(function() {
        // done
    });

// write to a stream
workbook.xlsx.<span class="apidocCodeKeywordSpan">write</span>(stream)
    .then(function() {
        // done
    });
```

### CSV
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.string_buf" id="apidoc.module.exceljs.string_buf">module exceljs.string_buf</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.string_buf.string_buf" id="apidoc.element.exceljs.string_buf.string_buf">
        function <span class="apidocSignatureSpan">exceljs.</span>string_buf
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">string_buf = function (options) {
  this._buf = new Buffer((options &#x26;&#x26; options.size) || 16384);
  this._encoding = (options &#x26;&#x26; options.encoding) || &#x27;utf8&#x27;;

  // where in the buffer we are at
  this._inPos = 0;

  // for use by toBuffer()
  this._buffer = undefined;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.string_buf.prototype" id="apidoc.module.exceljs.string_buf.prototype">module exceljs.string_buf.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.string_buf.prototype._grow" id="apidoc.element.exceljs.string_buf.prototype._grow">
        function <span class="apidocSignatureSpan">exceljs.string_buf.prototype.</span>_grow
        <span class="apidocSignatureSpan">(min)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_grow = function (min) {
  for (var size = this._buf.length * 2; size &#x3c; min; size *= 2);
  var buf = new Buffer(size);
  this._buf.copy(buf, 0);
  this._buf = buf;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
addText: function addText(text) {
  this._buffer = undefined;

  var inPos = this._inPos + this._buf.write(text, this._inPos, this._encoding);

  // if we&#x27;ve hit (or nearing capacity), grow the buf
  while (inPos &#x3e;= this._buf.length - 4) {
    this.<span class="apidocCodeKeywordSpan">_grow</span>(this._inPos + text.length);

    // keep trying to write until we&#x27;ve completely written the text
    inPos = this._inPos + this._buf.write(text, this._inPos, this._encoding);
  }

  this._inPos = inPos;
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.string_buf.prototype.addStringBuf" id="apidoc.element.exceljs.string_buf.prototype.addStringBuf">
        function <span class="apidocSignatureSpan">exceljs.string_buf.prototype.</span>addStringBuf
        <span class="apidocSignatureSpan">(inBuf)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addStringBuf = function (inBuf) {
  if (inBuf.length) {
    this._buffer = undefined;

    if (this.length + inBuf.length &#x3e; this.capacity) {
      this._grow(this.length + inBuf.length);
    }
    inBuf._buf.copy(this._buf, this._inPos, 0, inBuf.length);
    this._inPos += inBuf.length;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.string_buf.prototype.addText" id="apidoc.element.exceljs.string_buf.prototype.addText">
        function <span class="apidocSignatureSpan">exceljs.string_buf.prototype.</span>addText
        <span class="apidocSignatureSpan">(text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addText = function (text) {
  this._buffer = undefined;

  var inPos = this._inPos + this._buf.write(text, this._inPos, this._encoding);

  // if we&#x27;ve hit (or nearing capacity), grow the buf
  while (inPos &#x3e;= this._buf.length - 4) {
    this._grow(this._inPos + text.length);

    // keep trying to write until we&#x27;ve completely written the text
    inPos = this._inPos + this._buf.write(text, this._inPos, this._encoding);
  }

  this._inPos = inPos;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  // index merge
  this._merges.push(dimensions);
},

// ================================================================================
_write: function(text) {
  xml.reset();
  xml.<span class="apidocCodeKeywordSpan">addText</span>(text);
  this.stream.write(xml);
},
_writeSheetProperties: function(xmlBuf, properties, pageSetup) {
  var sheetPropertiesModel = {
    tabColor: properties &#x26;&#x26; properties.tabColor,
    pageSetup: pageSetup &#x26;&#x26; pageSetup.fitToPage ? {
      fitToPage: pageSetup.fitToPage
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.string_buf.prototype.reset" id="apidoc.element.exceljs.string_buf.prototype.reset">
        function <span class="apidocSignatureSpan">exceljs.string_buf.prototype.</span>reset
        <span class="apidocSignatureSpan">(position)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">reset = function (position) {
  position = position || 0;
  this._buffer = undefined;
  this._inPos = position;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
},

parseOpen: function parseOpen(node) {
  if (this.parser) {
    this.parser.parseOpen(node);
    return true;
  } else if (node.name === this.tag) {
    this.map.tabColor.<span class="apidocCodeKeywordSpan">reset</span>();
    this.map.pageSetUpPr.reset();
    return true;
  } else if (this.map[node.name]) {
    this.parser = this.map[node.name];
    this.parser.parseOpen(node);
    return true;
  } else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.string_buf.prototype.toBuffer" id="apidoc.element.exceljs.string_buf.prototype.toBuffer">
        function <span class="apidocSignatureSpan">exceljs.string_buf.prototype.</span>toBuffer
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toBuffer = function () {
  // return the current data as a single enclosing buffer
  if (!this._buffer) {
    this._buffer = new Buffer(this.length);
    this._buf.copy(this._buffer, 0, 0, this.length);
  }
  return this._buffer;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// data chunks - encapsulating incoming data
var StringChunk = function StringChunk(data, encoding) {
this._data = data;
this._encoding = encoding;
};
StringChunk.prototype = {
get length() {
  return this.<span class="apidocCodeKeywordSpan">toBuffer</span>().length;
},
// copy to target buffer
copy: function copy(target, targetOffset, offset, length) {
  return this.toBuffer().copy(target, targetOffset, offset, length);
},
toBuffer: function toBuffer() {
  if (!this._buffer) {
...</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.string_builder" id="apidoc.module.exceljs.string_builder">module exceljs.string_builder</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.string_builder.string_builder" id="apidoc.element.exceljs.string_builder.string_builder">
        function <span class="apidocSignatureSpan">exceljs.</span>string_builder
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">string_builder = function (options) {
  this.reset();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.string_builder.prototype" id="apidoc.module.exceljs.string_builder.prototype">module exceljs.string_builder.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.string_builder.prototype.addStringBuf" id="apidoc.element.exceljs.string_builder.prototype.addStringBuf">
        function <span class="apidocSignatureSpan">exceljs.string_builder.prototype.</span>addStringBuf
        <span class="apidocSignatureSpan">(inBuf)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addStringBuf = function (inBuf) {
  this._buf.push(inBuf.toString());
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.string_builder.prototype.addText" id="apidoc.element.exceljs.string_builder.prototype.addText">
        function <span class="apidocSignatureSpan">exceljs.string_builder.prototype.</span>addText
        <span class="apidocSignatureSpan">(text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addText = function (text) {
  this._buf.push(text);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  // index merge
  this._merges.push(dimensions);
},

// ================================================================================
_write: function(text) {
  xml.reset();
  xml.<span class="apidocCodeKeywordSpan">addText</span>(text);
  this.stream.write(xml);
},
_writeSheetProperties: function(xmlBuf, properties, pageSetup) {
  var sheetPropertiesModel = {
    tabColor: properties &#x26;&#x26; properties.tabColor,
    pageSetup: pageSetup &#x26;&#x26; pageSetup.fitToPage ? {
      fitToPage: pageSetup.fitToPage
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.string_builder.prototype.reset" id="apidoc.element.exceljs.string_builder.prototype.reset">
        function <span class="apidocSignatureSpan">exceljs.string_builder.prototype.</span>reset
        <span class="apidocSignatureSpan">(position)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">reset = function (position) {
  if (position) {
    while (this._buf.length &#x3e; position) {
      this._buf.pop();
    }
  } else {
    this._buf = [];
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
},

parseOpen: function parseOpen(node) {
  if (this.parser) {
    this.parser.parseOpen(node);
    return true;
  } else if (node.name === this.tag) {
    this.map.tabColor.<span class="apidocCodeKeywordSpan">reset</span>();
    this.map.pageSetUpPr.reset();
    return true;
  } else if (this.map[node.name]) {
    this.parser = this.map[node.name];
    this.parser.parseOpen(node);
    return true;
  } else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.string_builder.prototype.toString" id="apidoc.element.exceljs.string_builder.prototype.toString">
        function <span class="apidocSignatureSpan">exceljs.string_builder.prototype.</span>toString
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toString = function () {
  return this._buf.join(&#x27;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

  this._value.release();

  // assign value
  this._value = Value.create(Value.getType(v), this, v);
},
get text() {
  return this._value.<span class="apidocCodeKeywordSpan">toString</span>();
},
toString: function toString() {
  return this.text;
},

_upgradeToHyperlink: function _upgradeToHyperlink(hyperlink) {
  // if this cell is a string, turn it into a Hyperlink
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.stuttered_pipe" id="apidoc.module.exceljs.stuttered_pipe">module exceljs.stuttered_pipe</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.stuttered_pipe.stuttered_pipe" id="apidoc.element.exceljs.stuttered_pipe.stuttered_pipe">
        function <span class="apidocSignatureSpan">exceljs.</span>stuttered_pipe
        <span class="apidocSignatureSpan">(readable, writable, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">stuttered_pipe = function (readable, writable, options) {
  var self = this;
  options = options || {};

  this.readable = readable;
  this.writable = writable;
  this.bufSize = options.bufSize || 16384;
  this.autoPause = options.autoPause || false;

  this.paused = false;
  this.eod = false;
  this.scheduled = null;

  readable.on(&#x27;end&#x27;, function() {
    self.eod = true;
    writable.end();
  });

  // need to have some way to communicate speed of stream
  // back from the consumer
  readable.on(&#x27;readable&#x27;, function() {
    if (!self.paused) {
      self.resume();
    }
  });
  this._schedule();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stuttered_pipe.super_" id="apidoc.element.exceljs.stuttered_pipe.super_">
        function <span class="apidocSignatureSpan">exceljs.stuttered_pipe.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.stuttered_pipe.prototype" id="apidoc.module.exceljs.stuttered_pipe.prototype">module exceljs.stuttered_pipe.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.stuttered_pipe.prototype._schedule" id="apidoc.element.exceljs.stuttered_pipe.prototype._schedule">
        function <span class="apidocSignatureSpan">exceljs.stuttered_pipe.prototype.</span>_schedule
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_schedule = function () {
  var self = this;
  this.scheduled = setImmediate(function() {
    self.scheduled = null;
    if (!self.eod &#x26;&#x26; !self.paused) {
      var data = self.readable.read(self.bufSize);
      if (data &#x26;&#x26; data.length) {
        self.writable.write(data);

        if (!self.paused &#x26;&#x26; !self.autoPause) {
          self._schedule();
        }
      } else {
        if (!self.paused) {
          self._schedule();
        }
      }
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// need to have some way to communicate speed of stream
// back from the consumer
readable.on(&#x27;readable&#x27;, function() {
  if (!self.paused) {
    self.resume();
  }
});
this.<span class="apidocCodeKeywordSpan">_schedule</span>();
};

utils.inherits(StutteredPipe, events.EventEmitter, {
pause: function() {
  this.paused = true;
},
resume: function() {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stuttered_pipe.prototype.pause" id="apidoc.element.exceljs.stuttered_pipe.prototype.pause">
        function <span class="apidocSignatureSpan">exceljs.stuttered_pipe.prototype.</span>pause
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pause = function () {
  this.paused = true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
read: function read(size) {
  return this.stream.read(size);
},
setEncoding: function setEncoding(encoding) {
  return this.stream.setEncoding(encoding);
},
pause: function pause() {
  return this.stream.<span class="apidocCodeKeywordSpan">pause</span>();
},
resume: function resume() {
  return this.stream.resume();
},
isPaused: function isPaused() {
  return this.stream.isPaused();
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.stuttered_pipe.prototype.resume" id="apidoc.element.exceljs.stuttered_pipe.prototype.resume">
        function <span class="apidocSignatureSpan">exceljs.stuttered_pipe.prototype.</span>resume
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">resume = function () {
  if (!this.eod) {
    if (this.scheduled !== null) {
      clearImmediate(this.scheduled);
    }
    this._schedule();
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
setEncoding: function setEncoding(encoding) {
  return this.stream.setEncoding(encoding);
},
pause: function pause() {
  return this.stream.pause();
},
resume: function resume() {
  return this.stream.<span class="apidocCodeKeywordSpan">resume</span>();
},
isPaused: function isPaused() {
  return this.stream.isPaused();
},
pipe: function pipe(destination, options) {
  return this.stream.pipe(destination, options);
},
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.typed_stack" id="apidoc.module.exceljs.typed_stack">module exceljs.typed_stack</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.typed_stack.typed_stack" id="apidoc.element.exceljs.typed_stack.typed_stack">
        function <span class="apidocSignatureSpan">exceljs.</span>typed_stack
        <span class="apidocSignatureSpan">(type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">typed_stack = function (type) {
  this._type = type;
  this._stack = [];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.typed_stack.prototype" id="apidoc.module.exceljs.typed_stack.prototype">module exceljs.typed_stack.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.typed_stack.prototype.pop" id="apidoc.element.exceljs.typed_stack.prototype.pop">
        function <span class="apidocSignatureSpan">exceljs.typed_stack.prototype.</span>pop
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pop = function () {
  var tos = this._stack.pop();
  return tos || new (this._type)();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  },
  set model(value) {
    // value is [ { name, ranges }, ... ]
    var matrixMap = this.matrixMap = {};
    value.forEach(function (definedName) {
      var matrix = matrixMap[definedName.name] = new CellMatrix();
      definedName.ranges.forEach(function (rangeStr) {
        if (rangeRegexp.test(rangeStr.split(&#x27;!&#x27;).<span class="apidocCodeKeywordSpan">pop</span>() || &#x27;&#x27;)) {
          matrix.addCell(rangeStr);
        }
      });
    });
  }
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.typed_stack.prototype.push" id="apidoc.element.exceljs.typed_stack.prototype.push">
        function <span class="apidocSignatureSpan">exceljs.typed_stack.prototype.</span>push
        <span class="apidocSignatureSpan">(instance)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">push = function (instance) {
  if (!(instance instanceof this._type)) {
    throw new Error(&#x27;Invalid type pushed to TypedStack&#x27;);
  }
  this._stack.push(instance);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
          width: column.width,
          style: column.style,
          isCustomWidth: column.isCustomWidth,
          hidden: column.hidden,
          outlineLevel: column.outlineLevel,
          collapsed: column.collapsed
        };
        cols.<span class="apidocCodeKeywordSpan">push</span>(col);
      } else {
        col.max = index + 1;
      }
    }
  });
}
return cols.length ? cols : undefined;
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.under_dash" id="apidoc.module.exceljs.under_dash">module exceljs.under_dash</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.under_dash.each" id="apidoc.element.exceljs.under_dash.each">
        function <span class="apidocSignatureSpan">exceljs.under_dash.</span>each
        <span class="apidocSignatureSpan">(obj, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function each(obj, cb) {
  if (obj) {
    if (Array.isArray(obj)) {
      obj.forEach(cb);
    } else {
      Object.keys(obj).forEach(function (key) {
        cb(obj[key], key);
      });
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  this.removeEx(location, name);
},
removeEx: function removeEx(location, name) {
  var matrix = this.getMatrix(name);
  matrix.removeCellEx(location);
},
removeAllNames: function removeAllNames(location) {
  _.<span class="apidocCodeKeywordSpan">each</span>(this.matrixMap, function (matrix) {
    matrix.removeCellEx(location);
  });
},

forEach: function forEach(callback) {
  _.each(this.matrixMap, function (matrix, name) {
    matrix.forEach(function (cell) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.under_dash.every" id="apidoc.element.exceljs.under_dash.every">
        function <span class="apidocSignatureSpan">exceljs.under_dash.</span>every
        <span class="apidocSignatureSpan">(obj, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function every(obj, cb) {
  if (obj) {
    if (Array.isArray(obj)) {
      return obj.every(cb);
    } else {
      return Object.keys(obj).every(function (key) {
        return cb(obj[key], key);
      });
    }
  } else {
    return true;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }
  }
},

every: function every(obj, cb) {
  if (obj) {
    if (Array.isArray(obj)) {
      return obj.<span class="apidocCodeKeywordSpan">every</span>(cb);
    } else {
      return Object.keys(obj).every(function (key) {
        return cb(obj[key], key);
      });
    }
  } else {
    return true;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.under_dash.isEqual" id="apidoc.element.exceljs.under_dash.isEqual">
        function <span class="apidocSignatureSpan">exceljs.under_dash.</span>isEqual
        <span class="apidocSignatureSpan">(a, b)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function isEqual(a, b) {
  var aType = typeof a;
  var bType = typeof b;
  var aArray = Array.isArray(a);
  var bArray = Array.isArray(b);

  if (aType !== bType) return false;
  switch(typeof a) {
    case &#x27;object&#x27;:
      if (aArray || bArray) {
        if (aArray &#x26;&#x26; bArray) {
          return (a.length === b.length) &#x26;&#x26;
            a.every(function(aValue, index) {
              var bValue = b[index];
              return _.isEqual(aValue, bValue);
            });
        } else {
          return false;
        }
      } else {
        return _.every(a, function(aValue, key) {
          var bValue = b[key];
          return _.isEqual(aValue, bValue);
        });
      }

    default:
      return a === b;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return JSON.stringify({
    key: this.key,
    width: this.width,
    headers: this.headers.length ? this.headers : undefined
  });
},
equivalentTo: function equivalentTo(other) {
  return this.width == other.width &#x26;&#x26; this.hidden == other.hidden &#x26;&#x26; this.outlineLevel == other.outlineLevel
 &#x26;&#x26; _.<span class="apidocCodeKeywordSpan">isEqual</span>(this.style, other.style);
},
get isDefault() {
  if (this.isCustomWidth) {
    return false;
  }
  if (this.hidden) {
    return false;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.under_dash.map" id="apidoc.element.exceljs.under_dash.map">
        function <span class="apidocSignatureSpan">exceljs.under_dash.</span>map
        <span class="apidocSignatureSpan">(obj, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function map(obj, cb) {
  if (obj) {
    if (Array.isArray(obj)) {
      return obj.map(cb);
    } else {
      return Object.keys(obj).map(function (key) {
        return cb(obj[key], key);
      });
    }
  } else {
    return [];
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (special !== undefined) {
      return special;
    }
    return datum;
  };

  var csvStream = csv(options).on(&#x27;data&#x27;, function (data) {
    worksheet.addRow(data.<span class="apidocCodeKeywordSpan">map</span>(map));
  }).on(&#x27;end&#x27;, function () {
    csvStream.emit(&#x27;worksheet&#x27;, worksheet);
  });
  return csvStream;
},

write: function write(stream, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.under_dash.some" id="apidoc.element.exceljs.under_dash.some">
        function <span class="apidocSignatureSpan">exceljs.under_dash.</span>some
        <span class="apidocSignatureSpan">(obj, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function some(obj, cb) {
  if (obj) {
    if (Array.isArray(obj)) {
      return obj.some(cb);
    } else {
      return Object.keys(obj).some(function (key) {
        return cb(obj[key], key);
      });
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      }
    });
  }
},

// returns true if the row includes at least one cell with a value
get hasValues() {
  return _.<span class="apidocCodeKeywordSpan">some</span>(this._cells, function (cell) {
    return cell &#x26;&#x26; cell.type != Enums.ValueType.Null;
  });
},

get cellCount() {
  return this._cells.length;
},
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.utils" id="apidoc.module.exceljs.utils">module exceljs.utils</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.utils.dateToExcel" id="apidoc.element.exceljs.utils.dateToExcel">
        function <span class="apidocSignatureSpan">exceljs.utils.</span>dateToExcel
        <span class="apidocSignatureSpan">(d, date1904)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dateToExcel = function (d, date1904) {
  return 25569 + d.getTime() / (24 * 3600 * 1000) - (date1904 ? 1462 : 0);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    case Enums.ValueType.Error:
      xmlStream.addAttribute(&#x27;t&#x27;, &#x27;e&#x27;);
      xmlStream.leafNode(&#x27;f&#x27;, attrs, model.formula);
      xmlStream.leafNode(&#x27;v&#x27;, null, model.result.error);
      break;
    case Enums.ValueType.Date:
      xmlStream.leafNode(&#x27;f&#x27;, attrs, model.formula);
      xmlStream.leafNode(&#x27;v&#x27;, null, utils.<span class="apidocCodeKeywordSpan">dateToExcel</span>(model.result, model.date1904
));
      break;
    // case Enums.ValueType.Hyperlink: // ??
    // case Enums.ValueType.Formula:
    default:
      throw new Error(&#x27;I could not understand type of value&#x27;);
  }
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.utils.excelToDate" id="apidoc.element.exceljs.utils.excelToDate">
        function <span class="apidocSignatureSpan">exceljs.utils.</span>excelToDate
        <span class="apidocSignatureSpan">(v, date1904)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">excelToDate = function (v, date1904) {
  return new Date((v - 25569 + (date1904 ? 1462 : 0)) * 24 * 3600 * 1000);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (model.value.richText) {
    model.type = Enums.ValueType.RichText;
  }
  break;
case Enums.ValueType.Number:
  if (style &#x26;&#x26; utils.isDateFmt(style.numFmt)) {
    model.type = Enums.ValueType.Date;
    model.value = utils.<span class="apidocCodeKeywordSpan">excelToDate</span>(model.value, options.date1904);
  }
  break;
case Enums.ValueType.Formula:
  if (model.result !== undefined &#x26;&#x26; style &#x26;&#x26; utils.isDateFmt(style.numFmt)) {
    model.result = utils.excelToDate(model.result, options.date1904);
  }
  if (model.sharedFormula) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.utils.getRelsPath" id="apidoc.element.exceljs.utils.getRelsPath">
        function <span class="apidocSignatureSpan">exceljs.utils.</span>getRelsPath
        <span class="apidocSignatureSpan">(filepath)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getRelsPath = function (filepath) {
  var path = utils.parsePath(filepath);
  return path.path + &#x27;/_rels/&#x27; + path.name + &#x27;.rels&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.utils.inherits" id="apidoc.element.exceljs.utils.inherits">
        function <span class="apidocSignatureSpan">exceljs.utils.</span>inherits
        <span class="apidocSignatureSpan">(cls, superCtor, statics, prototype)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inherits = function (cls, superCtor, statics, prototype) {
  cls.super_ = superCtor;

  if (!prototype) {
    prototype = statics;
    statics = null;
  }

  if (statics) {
    for (var i in statics) {
      Object.defineProperty(cls, i, Object.getOwnPropertyDescriptor(statics, i));
    }
  }

  var properties = {
    constructor: {
      value: cls,
      enumerable: false,
      writable: false,
      configurable: true
    }
  };
  if (prototype) {
    for (var i in prototype) {
      properties[i] = Object.getOwnPropertyDescriptor(prototype, i);
    }
  }

  cls.prototype = Object.create(superCtor.prototype, properties);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

// controls emit(&#x27;data&#x27;)
this.paused = false;

this.encoding = null;
};

utils.<span class="apidocCodeKeywordSpan">inherits</span>(StreamBuf, Stream.Duplex, {
// writable
// event drain - if write returns false (which it won&#x27;t), indicates when safe to write again.
// finish - end() has been called
// pipe(src) - pipe() has been called on readable
// unpipe(src) - unpipe() has been called on readable
// error - duh
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.utils.isDateFmt" id="apidoc.element.exceljs.utils.isDateFmt">
        function <span class="apidocSignatureSpan">exceljs.utils.</span>isDateFmt
        <span class="apidocSignatureSpan">(fmt)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isDateFmt = function (fmt) {
  if (!fmt) { return false; }

  // must remove all chars inside quotes and []
  fmt = fmt.replace(/[\[][^\]]*[\]]/g,&#x27;&#x27;);
  fmt = fmt.replace(/&#x22;[^&#x22;]*&#x22;/g,&#x27;&#x27;);
  // then check for date formatting chars
  var result = fmt.match(/[ymdhMsb]+/) !== null;
  return result;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    model.value = options.sharedStrings.getString(model.value);
  }
  if (model.value.richText) {
    model.type = Enums.ValueType.RichText;
  }
  break;
case Enums.ValueType.Number:
  if (style &#x26;&#x26; utils.<span class="apidocCodeKeywordSpan">isDateFmt</span>(style.numFmt)) {
    model.type = Enums.ValueType.Date;
    model.value = utils.excelToDate(model.value, options.date1904);
  }
  break;
case Enums.ValueType.Formula:
  if (model.result !== undefined &#x26;&#x26; style &#x26;&#x26; utils.isDateFmt(style.numFmt)) {
    model.result = utils.excelToDate(model.result, options.date1904);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.utils.nop" id="apidoc.element.exceljs.utils.nop">
        function <span class="apidocSignatureSpan">exceljs.utils.</span>nop
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">nop = function () {}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.utils.parsePath" id="apidoc.element.exceljs.utils.parsePath">
        function <span class="apidocSignatureSpan">exceljs.utils.</span>parsePath
        <span class="apidocSignatureSpan">(filepath)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parsePath = function (filepath) {
  var last = filepath.lastIndexOf(&#x27;/&#x27;);
  return {
    path: filepath.substring(0, last),
    name: filepath.substring(last + 1)
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  var last = filepath.lastIndexOf(&#x27;/&#x27;);
  return {
    path: filepath.substring(0, last),
    name: filepath.substring(last + 1)
  };
},
getRelsPath: function getRelsPath(filepath) {
  var path = utils.<span class="apidocCodeKeywordSpan">parsePath</span>(filepath);
  return path.path + &#x27;/_rels/&#x27; + path.name + &#x27;.rels&#x27;;
},
xmlEncode: function xmlEncode(text) {
  return text.replace(/[&#x3c;&#x3e;&#x26;&#x27;&#x22;\x7F\x00-\x08\x0A-\x0C\x0E-\x1F]/g, function (c) {
    switch (c) {
      case &#x27;&#x3c;&#x27;:
        return &#x27;&#x26;lt;&#x27;;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.utils.promiseImmediate" id="apidoc.element.exceljs.utils.promiseImmediate">
        function <span class="apidocSignatureSpan">exceljs.utils.</span>promiseImmediate
        <span class="apidocSignatureSpan">(value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">promiseImmediate = function (value) {
  return new PromishLib.Promish(function(resolve, reject) {
    if (global.setImmediate) {
      setImmediate(function() {
        resolve(value);
      });
    } else {
      // poorman&#x27;s setImmediate - must wait at least 1ms
      setTimeout(function() {
        resolve(value);
      },1);
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.utils.toIsoDateString" id="apidoc.element.exceljs.utils.toIsoDateString">
        function <span class="apidocSignatureSpan">exceljs.utils.</span>toIsoDateString
        <span class="apidocSignatureSpan">(dt)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toIsoDateString = function (dt) {
  return dt.toIsoString().subsstr(0,10);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.utils.validInt" id="apidoc.element.exceljs.utils.validInt">
        function <span class="apidocSignatureSpan">exceljs.utils.</span>validInt
        <span class="apidocSignatureSpan">(value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validInt = function (value) {
  var i = parseInt(value);
  return !isNaN(i) ? i : 0;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.utils.xmlDecode" id="apidoc.element.exceljs.utils.xmlDecode">
        function <span class="apidocSignatureSpan">exceljs.utils.</span>xmlDecode
        <span class="apidocSignatureSpan">(text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">xmlDecode = function (text) {
  return text.replace(/&#x26;([a-z]*);/, function(c) {
    switch (c) {
      case &#x27;&#x26;lt;&#x27;: return &#x27;&#x3c;&#x27;;
      case &#x27;&#x26;gt;&#x27;: return &#x27;&#x3e;&#x27;;
      case &#x27;&#x26;amp;&#x27;: return &#x27;&#x26;&#x27;;
      case &#x27;&#x26;apos;&#x27;: return &#x27;\&#x27;&#x27;;
      case &#x27;&#x26;quot;&#x27;: return &#x27;&#x22;&#x27;;
      default: return c;
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    &#x27;r:id&#x27;: model.rId
  });
},

parseOpen: function parseOpen(node) {
  if (node.name === &#x27;sheet&#x27;) {
    this.model = {
      name: utils.<span class="apidocCodeKeywordSpan">xmlDecode</span>(node.attributes.name),
      id: parseInt(node.attributes.sheetId),
      rId: node.attributes[&#x27;r:id&#x27;]
    };
    return true;
  } else {
    return false;
  }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.utils.xmlEncode" id="apidoc.element.exceljs.utils.xmlEncode">
        function <span class="apidocSignatureSpan">exceljs.utils.</span>xmlEncode
        <span class="apidocSignatureSpan">(text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">xmlEncode = function (text) {
  return text.replace(/[&#x3c;&#x3e;&#x26;&#x27;&#x22;\x7F\x00-\x08\x0A-\x0C\x0E-\x1F]/g, function (c) {
    switch (c) {
      case &#x27;&#x3c;&#x27;: return &#x27;&#x26;lt;&#x27;;
      case &#x27;&#x3e;&#x27;: return &#x27;&#x26;gt;&#x27;;
      case &#x27;&#x26;&#x27;: return &#x27;&#x26;amp;&#x27;;
      case &#x27;\&#x27;&#x27;: return &#x27;&#x26;apos;&#x27;;
      case &#x27;&#x22;&#x27;: return &#x27;&#x26;quot;&#x27;;
      default: return &#x27;&#x27;;
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var QUOTE = &#x27;&#x22;&#x27;;
var SPACE = &#x27; &#x27;;

function pushAttribute(xml, name, value) {
xml.push(SPACE);
xml.push(name);
xml.push(EQUALS_QUOTE);
xml.push(utils.<span class="apidocCodeKeywordSpan">xmlEncode</span>(value.toString()));
xml.push(QUOTE);
}
function pushAttributes(xml, attributes) {
if (attributes) {
  _.each(attributes, function (value, name) {
    if (value !== undefined) {
      pushAttribute(xml, name, value);
...</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.workbook_reader" id="apidoc.module.exceljs.workbook_reader">module exceljs.workbook_reader</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.workbook_reader.workbook_reader" id="apidoc.element.exceljs.workbook_reader.workbook_reader">
        function <span class="apidocSignatureSpan">exceljs.</span>workbook_reader
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">workbook_reader = function (options) {
  this.options = options = options || {};

  // until we actually parse a styles.xml file, just assume we&#x27;re not handling styles
  // (but we do need to handle dates)
  this.styles = new StyleManager.Mock();

  // worksheet readers, indexed by sheetNo
  this.worksheetReaders = {};

  // hyperlink readers, indexed by sheetNo
  this.hyperlinkReaders = {};

  // count the open readers
  this.readers = 0;

  // end of stream check
  this.atEnd = false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.workbook_reader.super_" id="apidoc.element.exceljs.workbook_reader.super_">
        function <span class="apidocSignatureSpan">exceljs.workbook_reader.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.workbook_reader.prototype" id="apidoc.module.exceljs.workbook_reader.prototype">module exceljs.workbook_reader.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.workbook_reader.prototype._emitEntry" id="apidoc.element.exceljs.workbook_reader.prototype._emitEntry">
        function <span class="apidocSignatureSpan">exceljs.workbook_reader.prototype.</span>_emitEntry
        <span class="apidocSignatureSpan">(options, payload)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_emitEntry = function (options, payload) {
  if (options.entries === &#x27;emit&#x27;) {
    this.emit(&#x27;entry&#x27;, payload);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
},
_emitEntry: function(options, payload) {
  if (options.entries === &#x27;emit&#x27;) {
    this.emit(&#x27;entry&#x27;, payload);
  }
},
_parseSharedStrings: function(entry, options) {
  this.<span class="apidocCodeKeywordSpan">_emitEntry</span>(options, {type: &#x27;shared-strings&#x27;});
  var self = this;
  var sharedStrings = null;
  switch(options.sharedStrings) {
    case &#x27;cache&#x27;:
      sharedStrings = this.sharedStrings = [];
      break;
    case &#x27;emit&#x27;:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.workbook_reader.prototype._getReader" id="apidoc.element.exceljs.workbook_reader.prototype._getReader">
        function <span class="apidocSignatureSpan">exceljs.workbook_reader.prototype.</span>_getReader
        <span class="apidocSignatureSpan">(Type, collection, sheetNo)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_getReader = function (Type, collection, sheetNo) {
  var self = this;
  var reader = collection[sheetNo];
  if (!reader) {
    reader = new Type(this, sheetNo);
    self.readers++;
    reader.on(&#x27;finished&#x27;, function() {
      if (!--self.readers) {
        if (self.atEnd) {
          self.emit(&#x27;finished&#x27;);
        }
      }
    });
    collection[sheetNo] = reader;
  }
  return reader;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    });
    collection[sheetNo] = reader;
  }
  return reader;
},
_parseWorksheet: function(entry, sheetNo, options) {
  this._emitEntry(options, {type: &#x27;worksheet&#x27;, id: sheetNo});
  var worksheetReader = this.<span class="apidocCodeKeywordSpan">_getReader</span>(WorksheetReader, this.worksheetReaders, sheetNo
);
  if (options.worksheets === &#x27;emit&#x27;) {
    this.emit(&#x27;worksheet&#x27;, worksheetReader);
  }
  worksheetReader.read(entry, options, this.hyperlinkReaders[sheetNo]);
},
_parseHyperlinks: function(entry, sheetNo, options) {
  this._emitEntry(options, {type: &#x27;hyerlinks&#x27;, id: sheetNo});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.workbook_reader.prototype._getStream" id="apidoc.element.exceljs.workbook_reader.prototype._getStream">
        function <span class="apidocSignatureSpan">exceljs.workbook_reader.prototype.</span>_getStream
        <span class="apidocSignatureSpan">(input)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_getStream = function (input) {
  if (input instanceof Stream.Readable) {
    return input;
  }
  if (typeof input === &#x27;string&#x27;) {
    return fs.createReadStream(input);
  }
  throw new Error(&#x27;Could not recognise input&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
sharedStrings: [&#x27;cache&#x27;, &#x27;emit&#x27;],
styles: [&#x27;cache&#x27;],
hyperlinks: [&#x27;cache&#x27;, &#x27;emit&#x27;],
worksheets: [&#x27;emit&#x27;]
  },
  read: function(input, options) {
var self = this;
var stream = this.stream = this.<span class="apidocCodeKeywordSpan">_getStream</span>(input);
var zip = this.zip = unzip.Parse();

zip.on(&#x27;entry&#x27;,function (entry) {
  var match, sheetNo;
  switch(entry.path) {
    case &#x27;_rels/.rels&#x27;:
    case &#x27;xl/workbook.xml&#x27;:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.workbook_reader.prototype._parseHyperlinks" id="apidoc.element.exceljs.workbook_reader.prototype._parseHyperlinks">
        function <span class="apidocSignatureSpan">exceljs.workbook_reader.prototype.</span>_parseHyperlinks
        <span class="apidocSignatureSpan">(entry, sheetNo, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_parseHyperlinks = function (entry, sheetNo, options) {
  this._emitEntry(options, {type: &#x27;hyerlinks&#x27;, id: sheetNo});
  var hyperlinksReader = this._getReader(HyperlinkReader, this.hyperlinkReaders, sheetNo);
  if (options.hyperlinks === &#x27;emit&#x27;) {
    this.emit(&#x27;hyperlinks&#x27;, hyperlinksReader);
  }
  hyperlinksReader.read(entry, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      if (entry.path.match(/xl\/worksheets\/sheet\d+\.xml/)) {
        match = entry.path.match(/xl\/worksheets\/sheet(\d+)\.xml/);
        sheetNo = match[1];
        self._parseWorksheet(entry, sheetNo, options);
      } else if (entry.path.match(/xl\/worksheets\/_rels\/sheet\d+\.xml.rels/)) {
        match = entry.path.match(/xl\/worksheets\/_rels\/sheet(\d+)\.xml.rels/);
        sheetNo = match[1];
        self.<span class="apidocCodeKeywordSpan">_parseHyperlinks</span>(entry, sheetNo, options);
      } else {
        entry.autodrain();
      }
      break;
  }
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.workbook_reader.prototype._parseSharedStrings" id="apidoc.element.exceljs.workbook_reader.prototype._parseSharedStrings">
        function <span class="apidocSignatureSpan">exceljs.workbook_reader.prototype.</span>_parseSharedStrings
        <span class="apidocSignatureSpan">(entry, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_parseSharedStrings = function (entry, options) {
  this._emitEntry(options, {type: &#x27;shared-strings&#x27;});
  var self = this;
  var sharedStrings = null;
  switch(options.sharedStrings) {
    case &#x27;cache&#x27;:
      sharedStrings = this.sharedStrings = [];
      break;
    case &#x27;emit&#x27;:
      break;
    default:
      entry.autodrain();
      return;
  }

  var parser = Sax.createStream(true, {});
  var inT = false;
  var t = null;
  var index = 0;
  parser.on(&#x27;opentag&#x27;, function(node) {
    if (node.name === &#x27;t&#x27;) {
      t = null;
      inT = true;
    }
  });
  parser.on(&#x27;closetag&#x27;, function (name) {
    if (inT &#x26;&#x26; (name === &#x27;t&#x27;)) {
      if (sharedStrings) {
        sharedStrings.push(t);
      } else {
        self.emit(&#x27;shared-string&#x27;, { index: index++, text: t});
      }
      t = null;
    }
  });
  parser.on(&#x27;text&#x27;, function (text) {
    t = t ? t + text : text;
  });
  parser.on(&#x27;error&#x27;, function (error) {
    self.emit(&#x27;error&#x27;, error);
  });
  entry.pipe(parser);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      switch(entry.path) {
case &#x27;_rels/.rels&#x27;:
case &#x27;xl/workbook.xml&#x27;:
case &#x27;xl/_rels/workbook.xml.rels&#x27;:
  entry.autodrain();
  break;
case &#x27;xl/sharedStrings.xml&#x27;:
  self.<span class="apidocCodeKeywordSpan">_parseSharedStrings</span>(entry, options);
  break;
case &#x27;xl/styles.xml&#x27;:
  self._parseStyles(entry, options);
  break;
default:
  if (entry.path.match(/xl\/worksheets\/sheet\d+\.xml/)) {
    match = entry.path.match(/xl\/worksheets\/sheet(\d+)\.xml/);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.workbook_reader.prototype._parseStyles" id="apidoc.element.exceljs.workbook_reader.prototype._parseStyles">
        function <span class="apidocSignatureSpan">exceljs.workbook_reader.prototype.</span>_parseStyles
        <span class="apidocSignatureSpan">(entry, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_parseStyles = function (entry, options) {
  this._emitEntry(options, {type: &#x27;styles&#x27;});
  if (options.styles !== &#x27;cache&#x27;) {
    entry.autodrain();
    return;
  }
  this.styles = new StyleManager();
  this.styles.parse(entry);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
case &#x27;xl/_rels/workbook.xml.rels&#x27;:
  entry.autodrain();
  break;
case &#x27;xl/sharedStrings.xml&#x27;:
  self._parseSharedStrings(entry, options);
  break;
case &#x27;xl/styles.xml&#x27;:
  self.<span class="apidocCodeKeywordSpan">_parseStyles</span>(entry, options);
  break;
default:
  if (entry.path.match(/xl\/worksheets\/sheet\d+\.xml/)) {
    match = entry.path.match(/xl\/worksheets\/sheet(\d+)\.xml/);
    sheetNo = match[1];
    self._parseWorksheet(entry, sheetNo, options);
  } else if (entry.path.match(/xl\/worksheets\/_rels\/sheet\d+\.xml.rels/)) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.workbook_reader.prototype._parseWorksheet" id="apidoc.element.exceljs.workbook_reader.prototype._parseWorksheet">
        function <span class="apidocSignatureSpan">exceljs.workbook_reader.prototype.</span>_parseWorksheet
        <span class="apidocSignatureSpan">(entry, sheetNo, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_parseWorksheet = function (entry, sheetNo, options) {
  this._emitEntry(options, {type: &#x27;worksheet&#x27;, id: sheetNo});
  var worksheetReader = this._getReader(WorksheetReader, this.worksheetReaders, sheetNo);
  if (options.worksheets === &#x27;emit&#x27;) {
    this.emit(&#x27;worksheet&#x27;, worksheetReader);
  }
  worksheetReader.read(entry, options, this.hyperlinkReaders[sheetNo]);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
case &#x27;xl/styles.xml&#x27;:
  self._parseStyles(entry, options);
  break;
default:
  if (entry.path.match(/xl\/worksheets\/sheet\d+\.xml/)) {
    match = entry.path.match(/xl\/worksheets\/sheet(\d+)\.xml/);
    sheetNo = match[1];
    self.<span class="apidocCodeKeywordSpan">_parseWorksheet</span>(entry, sheetNo, options);
  } else if (entry.path.match(/xl\/worksheets\/_rels\/sheet\d+\.xml.rels/)) {
    match = entry.path.match(/xl\/worksheets\/_rels\/sheet(\d+)\.xml.rels/);
    sheetNo = match[1];
    self._parseHyperlinks(entry, sheetNo, options);
  } else {
    entry.autodrain();
  }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.workbook_reader.prototype.read" id="apidoc.element.exceljs.workbook_reader.prototype.read">
        function <span class="apidocSignatureSpan">exceljs.workbook_reader.prototype.</span>read
        <span class="apidocSignatureSpan">(input, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">read = function (input, options) {
  var self = this;
  var stream = this.stream = this._getStream(input);
  var zip = this.zip = unzip.Parse();

  zip.on(&#x27;entry&#x27;,function (entry) {
    var match, sheetNo;
    switch(entry.path) {
      case &#x27;_rels/.rels&#x27;:
      case &#x27;xl/workbook.xml&#x27;:
      case &#x27;xl/_rels/workbook.xml.rels&#x27;:
        entry.autodrain();
        break;
      case &#x27;xl/sharedStrings.xml&#x27;:
        self._parseSharedStrings(entry, options);
        break;
      case &#x27;xl/styles.xml&#x27;:
        self._parseStyles(entry, options);
        break;
      default:
        if (entry.path.match(/xl\/worksheets\/sheet\d+\.xml/)) {
          match = entry.path.match(/xl\/worksheets\/sheet(\d+)\.xml/);
          sheetNo = match[1];
          self._parseWorksheet(entry, sheetNo, options);
        } else if (entry.path.match(/xl\/worksheets\/_rels\/sheet\d+\.xml.rels/)) {
          match = entry.path.match(/xl\/worksheets\/_rels\/sheet(\d+)\.xml.rels/);
          sheetNo = match[1];
          self._parseHyperlinks(entry, sheetNo, options);
        } else {
          entry.autodrain();
        }
        break;
    }
  });

  zip.on(&#x27;close&#x27;, function () {
    self.emit(&#x27;end&#x27;);
    self.atEnd = true;
    if (!self.readers) {
      self.emit(&#x27;finished&#x27;);
    }
  });

  // Pipe stream into top flow-control
  // this.flowControl.pipe(zip);
  stream.pipe(zip);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
workbook.csv.readFile(filename)
    .then(function(worksheet) {
        // use workbook or worksheet
    });

// read from a stream
var workbook = new Excel.Workbook();
workbook.csv.<span class="apidocCodeKeywordSpan">read</span>(stream)
    .then(function(worksheet) {
        // use workbook or worksheet
    });

// pipe from stream
var workbook = new Excel.Workbook();
stream.pipe(workbook.csv.createInputStream());
...</pre></li>
    </ul>








</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.workbook_writer" id="apidoc.module.exceljs.workbook_writer">module exceljs.workbook_writer</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.workbook_writer.workbook_writer" id="apidoc.element.exceljs.workbook_writer.workbook_writer">
        function <span class="apidocSignatureSpan">exceljs.</span>workbook_writer
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">workbook_writer = function (options) {
  options = options || {};

  this.created = options.created || new Date();
  this.modified = options.modified || this.created;
  this.creator = options.creator || &#x27;ExcelJS&#x27;;
  this.lastModifiedBy = options.lastModifiedBy || &#x27;ExcelJS&#x27;;
  this.lastPrinted = options.lastPrinted;

  // using shared strings creates a smaller xlsx file but may use more memory
  this.useSharedStrings = options.useSharedStrings || false;
  this.sharedStrings = new SharedStrings();

  // style manager
  this.styles = options.useStyles ? new StylesXform(true) : new StylesXform.Mock(true);

  // defined names
  this._definedNames = new DefinedNames();

  this._worksheets = [];
  this.views = [];

  this.zip = Archiver(&#x27;zip&#x27;);
  if (options.stream) {
    this.stream = options.stream;
  } else if (options.filename) {
    this.stream = fs.createWriteStream(options.filename);
  } else {
    this.stream = new StreamBuf();
  }
  this.zip.pipe(this.stream);

  // these bits can be added right now
  this.promise = PromishLib.Promish.all([
    this.addThemes(),
    this.addOfficeRels()
  ]);

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.workbook_writer.prototype" id="apidoc.module.exceljs.workbook_writer.prototype">module exceljs.workbook_writer.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.workbook_writer.prototype._commitWorksheets" id="apidoc.element.exceljs.workbook_writer.prototype._commitWorksheets">
        function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>_commitWorksheets
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_commitWorksheets = function () {
  var commitWorksheet = function(worksheet) {
    if (!worksheet.committed) {
      return new PromishLib.Promish(function(resolve) {
        worksheet.stream.on(&#x27;zipped&#x27;, function() {
          resolve();
        });
        worksheet.commit();
      });
    } else {
      return PromishLib.Promish.resolve();
    }
  };
  // if there are any uncommitted worksheets, commit them now and wait
  var promises = this._worksheets.map(commitWorksheet);
  if (promises.length) {
    return PromishLib.Promish.all(promises);
  } else {
    return PromishLib.Promish.resolve();
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}
  },
  commit: function() {
var self = this;

// commit all worksheets, then add suplimentary files
return this.promise.then(function() {
    return self.<span class="apidocCodeKeywordSpan">_commitWorksheets</span>();
  })
  .then(function() {
    return PromishLib.Promish.all([
      self.addContentTypes(),
      self.addApp(),
      self.addCore(),
      self.addSharedStrings(),
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.workbook_writer.prototype._finalize" id="apidoc.element.exceljs.workbook_writer.prototype._finalize">
        function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>_finalize
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_finalize = function () {
  var self = this;
  return new PromishLib.Promish(function(resolve, reject) {
    self.stream.on(&#x27;error&#x27;, function(error){
      reject(error);
    });
    self.stream.on(&#x27;finish&#x27;, function(){
      resolve(self);
    });
    self.zip.on(&#x27;error&#x27;, function(error){
      reject(error);
    });

    self.zip.finalize();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    ];
    return PromishLib.Promish.all(afters);
  })
  .then(function () {
    return self.addWorkbook(zip, model, workbookXform);
  })
  .then(function () {
    return self.<span class="apidocCodeKeywordSpan">_finalize</span>(zip);
  });
  },
  writeFile: function (filename, options) {
var self = this;
var stream = fs.createWriteStream(filename);

return new PromishLib.Promish(function(resolve, reject) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.workbook_writer.prototype._openStream" id="apidoc.element.exceljs.workbook_writer.prototype._openStream">
        function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>_openStream
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_openStream = function (path) {
  var self = this;
  var stream = new StreamBuf({bufSize: 65536, batch: true});
  self.zip.append(stream, { name: path });
  stream.on(&#x27;finish&#x27;, function() {
    stream.emit(&#x27;zipped&#x27;);
  });
  return stream;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

this._workbook = options.workbook;
};
HyperlinkWriter.prototype = {

get stream() {
  if (!this._stream) {
    this._stream = this._workbook.<span class="apidocCodeKeywordSpan">_openStream</span>(&#x27;/xl/worksheets/_rels/sheet&#x27; +
this.id + &#x27;.xml.rels&#x27;);
  }
  return this._stream;
},

get length() {
  return this._hyperlinks.length;
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.workbook_writer.prototype.addApp" id="apidoc.element.exceljs.workbook_writer.prototype.addApp">
        function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>addApp
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addApp = function () {
  var self = this;
  return new PromishLib.Promish(function(resolve) {
    var model = {
      worksheets: self._worksheets.filter(Boolean)
    };
    var xform = new AppXform();
    var xml = xform.toXml(model);
    self.zip.append(xml, {name: &#x27;docProps/app.xml&#x27;});
    resolve();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
model.worksheets.forEach(function (worksheet) {
  worksheetXform.prepare(worksheet, prepareOptions);
});

// render
var promises = [
  self.addContentTypes(zip, model),
  self.<span class="apidocCodeKeywordSpan">addApp</span>(zip, model),
  self.addCore(zip, model),
  self.addThemes(zip, model),
  self.addOfficeRels(zip, model)
];
return PromishLib.Promish.all(promises)
  .then(function () {
    return self.addWorksheets(zip, model, worksheetXform);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.workbook_writer.prototype.addContentTypes" id="apidoc.element.exceljs.workbook_writer.prototype.addContentTypes">
        function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>addContentTypes
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addContentTypes = function () {
  var self = this;
  return new PromishLib.Promish(function(resolve) {
    var model = {
      worksheets: self._worksheets.filter(Boolean)
    };
    var xform = new ContentTypesXform();
    var xml = xform.toXml(model);
    self.zip.append(xml, {name: &#x27;[Content_Types].xml&#x27;});
    resolve();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
workbookXform.prepare(model);
model.worksheets.forEach(function (worksheet) {
  worksheetXform.prepare(worksheet, prepareOptions);
});

// render
var promises = [
  self.<span class="apidocCodeKeywordSpan">addContentTypes</span>(zip, model),
  self.addApp(zip, model),
  self.addCore(zip, model),
  self.addThemes(zip, model),
  self.addOfficeRels(zip, model)
];
return PromishLib.Promish.all(promises)
  .then(function () {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.workbook_writer.prototype.addCore" id="apidoc.element.exceljs.workbook_writer.prototype.addCore">
        function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>addCore
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addCore = function () {
  var self = this;
  return new PromishLib.Promish(function(resolve) {
    var coreXform = new CoreXform();
    var xml = coreXform.toXml(self);
    self.zip.append(xml, {name: &#x27;docProps/core.xml&#x27;});
    resolve();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  worksheetXform.prepare(worksheet, prepareOptions);
});

// render
var promises = [
  self.addContentTypes(zip, model),
  self.addApp(zip, model),
  self.<span class="apidocCodeKeywordSpan">addCore</span>(zip, model),
  self.addThemes(zip, model),
  self.addOfficeRels(zip, model)
];
return PromishLib.Promish.all(promises)
  .then(function () {
    return self.addWorksheets(zip, model, worksheetXform);
  })
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.workbook_writer.prototype.addOfficeRels" id="apidoc.element.exceljs.workbook_writer.prototype.addOfficeRels">
        function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>addOfficeRels
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addOfficeRels = function () {
  var self = this;
  return new PromishLib.Promish(function(resolve) {
    var xform = new RelationshipsXform();
    var xml = xform.toXml([
      {rId: &#x27;rId1&#x27;, type: RelType.OfficeDocument, target: &#x27;xl/workbook.xml&#x27;}
    ]);
    self.zip.append(xml, {name: &#x27;/_rels/.rels&#x27;});
    resolve();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

// render
var promises = [
  self.addContentTypes(zip, model),
  self.addApp(zip, model),
  self.addCore(zip, model),
  self.addThemes(zip, model),
  self.<span class="apidocCodeKeywordSpan">addOfficeRels</span>(zip, model)
];
return PromishLib.Promish.all(promises)
  .then(function () {
    return self.addWorksheets(zip, model, worksheetXform);
  })
  .then(function () {
    // Some things can only be done after all the worksheets have been processed
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.workbook_writer.prototype.addSharedStrings" id="apidoc.element.exceljs.workbook_writer.prototype.addSharedStrings">
        function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>addSharedStrings
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addSharedStrings = function () {
  var self = this;
  if (this.sharedStrings.count) {
    return new PromishLib.Promish(function(resolve) {
      var sharedStringsXform = new SharedStringsXform();
      var xml = sharedStringsXform.toXml(self.sharedStrings);
      self.zip.append(xml, {name: &#x27;/xl/sharedStrings.xml&#x27;});
      resolve();
    });
  } else {
    return PromishLib.Promish.resolve();
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return PromishLib.Promish.all(promises)
.then(function () {
  return self.addWorksheets(zip, model, worksheetXform);
})
.then(function () {
  // Some things can only be done after all the worksheets have been processed
  var afters = [
    self.<span class="apidocCodeKeywordSpan">addSharedStrings</span>(zip, model),
    self.addStyles(zip, model),
    self.addWorkbookRels(zip, model)
  ];
  return PromishLib.Promish.all(afters);
})
.then(function () {
  return self.addWorkbook(zip, model, workbookXform);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.workbook_writer.prototype.addStyles" id="apidoc.element.exceljs.workbook_writer.prototype.addStyles">
        function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>addStyles
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addStyles = function () {
  var self = this;
  return new PromishLib.Promish(function(resolve) {
    self.zip.append(self.styles.xml, {name: &#x27;xl/styles.xml&#x27;});
    resolve();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
.then(function () {
  return self.addWorksheets(zip, model, worksheetXform);
})
.then(function () {
  // Some things can only be done after all the worksheets have been processed
  var afters = [
    self.addSharedStrings(zip, model),
    self.<span class="apidocCodeKeywordSpan">addStyles</span>(zip, model),
    self.addWorkbookRels(zip, model)
  ];
  return PromishLib.Promish.all(afters);
})
.then(function () {
  return self.addWorkbook(zip, model, workbookXform);
})
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.workbook_writer.prototype.addThemes" id="apidoc.element.exceljs.workbook_writer.prototype.addThemes">
        function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>addThemes
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addThemes = function () {
  var self = this;
  return new PromishLib.Promish(function(resolve) {
    self.zip.append(theme1Xml, { name: &#x27;xl/theme/theme1.xml&#x27; });
    resolve();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
});

// render
var promises = [
  self.addContentTypes(zip, model),
  self.addApp(zip, model),
  self.addCore(zip, model),
  self.<span class="apidocCodeKeywordSpan">addThemes</span>(zip, model),
  self.addOfficeRels(zip, model)
];
return PromishLib.Promish.all(promises)
  .then(function () {
    return self.addWorksheets(zip, model, worksheetXform);
  })
  .then(function () {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.workbook_writer.prototype.addWorkbook" id="apidoc.element.exceljs.workbook_writer.prototype.addWorkbook">
        function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>addWorkbook
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addWorkbook = function () {
  var zip = this.zip;
  var model = {
    worksheets: this._worksheets.filter(Boolean),
    definedNames: this._definedNames.model,
    views: this.views,
    properties: {}
  };

  return new PromishLib.Promish(function(resolve) {
    var xform = new WorkbookXform();
    xform.prepare(model);
    zip.append(xform.toXml(model), {name: &#x27;/xl/workbook.xml&#x27;});
    resolve();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        self.addSharedStrings(zip, model),
        self.addStyles(zip, model),
        self.addWorkbookRels(zip, model)
      ];
      return PromishLib.Promish.all(afters);
    })
    .then(function () {
      return self.<span class="apidocCodeKeywordSpan">addWorkbook</span>(zip, model, workbookXform);
    })
    .then(function () {
      return self._finalize(zip);
    });
},
writeFile: function (filename, options) {
  var self = this;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.workbook_writer.prototype.addWorkbookRels" id="apidoc.element.exceljs.workbook_writer.prototype.addWorkbookRels">
        function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>addWorkbookRels
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addWorkbookRels = function () {
  var self = this;
  var count = 1;
  var relationships = [
    {rId: &#x27;rId&#x27; + (count++), type: RelType.Styles, target: &#x27;styles.xml&#x27;},
    {rId: &#x27;rId&#x27; + (count++), type: RelType.Theme, target: &#x27;theme/theme1.xml&#x27;}
  ];
  if (this.sharedStrings.count) {
    relationships.push(
      {rId: &#x27;rId&#x27; + (count++), type: RelType.SharedStrings, target: &#x27;sharedStrings.xml&#x27;}
    );
  }
  this._worksheets.forEach(function (worksheet) {
    if (worksheet) {
      worksheet.rId = &#x27;rId&#x27; + (count++);
      relationships.push(
        {rId: worksheet.rId, type: RelType.Worksheet, target: &#x27;worksheets/sheet&#x27; + worksheet.id + &#x27;.xml&#x27;}
      );
    }
  });
  return new PromishLib.Promish(function(resolve) {
    var xform = new RelationshipsXform();
    var xml = xform.toXml(relationships);
    self.zip.append(xml, {name: &#x27;/xl/_rels/workbook.xml.rels&#x27;});
    resolve();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return self.addWorksheets(zip, model, worksheetXform);
})
.then(function () {
  // Some things can only be done after all the worksheets have been processed
  var afters = [
    self.addSharedStrings(zip, model),
    self.addStyles(zip, model),
    self.<span class="apidocCodeKeywordSpan">addWorkbookRels</span>(zip, model)
  ];
  return PromishLib.Promish.all(afters);
})
.then(function () {
  return self.addWorkbook(zip, model, workbookXform);
})
.then(function () {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.workbook_writer.prototype.addWorksheet" id="apidoc.element.exceljs.workbook_writer.prototype.addWorksheet">
        function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>addWorksheet
        <span class="apidocSignatureSpan">(name, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addWorksheet = function (name, options) {
  // it&#x27;s possible to add a worksheet with different than default
  // shared string handling
  // in fact, it&#x27;s even possible to switch it mid-sheet
  options = options || {};
  var useSharedStrings = options.useSharedStrings !== undefined ?
    options.useSharedStrings :
    this.useSharedStrings;

  if (options.tabColor) {
    console.trace(&#x27;tabColor option has moved to { properties: tabColor: {...} }&#x27;);
    options.properties  = Object.assign({
      tabColor: options.tabColor
    }, options.properties);
  }

  var id = this.nextId;
  name = name || &#x27;sheet&#x27; + id;

  var worksheet = new WorksheetWriter({
    id: id,
    name: name,
    workbook: this,
    useSharedStrings: useSharedStrings,
    properties: options.properties,
    pageSetup: options.pageSetup,
    views: options.views
  });

  this._worksheets[id] = worksheet;
  return worksheet;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  }
]
```

## Add a Worksheet

```javascript
var sheet = workbook.<span class="apidocCodeKeywordSpan">addWorksheet</span>(&#x27;My Sheet&#x27;);
```

Use the second parameter of the addWorksheet function to specify options for the worksheet.

For Example:

```javascript
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.workbook_writer.prototype.commit" id="apidoc.element.exceljs.workbook_writer.prototype.commit">
        function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>commit
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">commit = function () {
  var self = this;

  // commit all worksheets, then add suplimentary files
  return this.promise.then(function() {
      return self._commitWorksheets();
    })
    .then(function() {
      return PromishLib.Promish.all([
        self.addContentTypes(),
        self.addApp(),
        self.addCore(),
        self.addSharedStrings(),
        self.addStyles(),
        self.addWorkbookRels()
      ]);
    })
    .then(function() {
      return self.addWorkbook();
    })
    .then(function(){
      return self._finalize();
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// Note: this operation will not affect other rows
row.splice(3,2);

// remove one cell and insert two more (cells to the right of the cut cell will be shifted right)
row.splice(4,1,&#x27;new value 1&#x27;, &#x27;new value 2&#x27;);

// Commit a completed row to stream
row.<span class="apidocCodeKeywordSpan">commit</span>();

// row metrics
var rowSize = row.cellCount;
var numValues = row.actualCellCount;
```

## Handling Individual Cells
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.workbook_writer.prototype.getWorksheet" id="apidoc.element.exceljs.workbook_writer.prototype.getWorksheet">
        function <span class="apidocSignatureSpan">exceljs.workbook_writer.prototype.</span>getWorksheet
        <span class="apidocSignatureSpan">(id)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getWorksheet = function (id) {
  if (id === undefined) {
    return this._worksheets.find(function() { return true; });
  } else if (typeof(id) === &#x27;number&#x27;) {
    return this._worksheets[id];
  } else if (typeof id === &#x27;string&#x27;) {
    return this._worksheets.find(function(worksheet) {
      return worksheet &#x26;&#x26; worksheet.name == id;
    });
  } else {
    return undefined;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// Iterate over all sheets
// Note: workbook.worksheets.forEach will still work but this is better
workbook.eachSheet(function(worksheet, sheetId) {
    // ...
});

// fetch sheet by name
var worksheet = workbook.<span class="apidocCodeKeywordSpan">getWorksheet</span>(&#x27;My Sheet&#x27;);

// fetch sheet by id
var worksheet = workbook.getWorksheet(1);
```

## Worksheet Properties
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.worksheet_reader" id="apidoc.module.exceljs.worksheet_reader">module exceljs.worksheet_reader</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.worksheet_reader.worksheet_reader" id="apidoc.element.exceljs.worksheet_reader.worksheet_reader">
        function <span class="apidocSignatureSpan">exceljs.</span>worksheet_reader
        <span class="apidocSignatureSpan">(workbook, id)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">worksheet_reader = function (workbook, id) {
  this.workbook = workbook;
  this.id = id;

  // and a name
  this.name = &#x27;Sheet&#x27; + this.id;

  // column definitions
  this._columns = null;
  this._keys = {};

  // keep a record of dimensions
  this._dimensions = new Dimensions();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_reader.super_" id="apidoc.element.exceljs.worksheet_reader.super_">
        function <span class="apidocSignatureSpan">exceljs.worksheet_reader.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.worksheet_reader.prototype" id="apidoc.module.exceljs.worksheet_reader.prototype">module exceljs.worksheet_reader.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.worksheet_reader.prototype._emitRow" id="apidoc.element.exceljs.worksheet_reader.prototype._emitRow">
        function <span class="apidocSignatureSpan">exceljs.worksheet_reader.prototype.</span>_emitRow
        <span class="apidocSignatureSpan">(row)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_emitRow = function (row) {
  this.emit(&#x27;row&#x27;, row);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  break;
case &#x27;sheetData&#x27;:
  inRows = false;
  break;

case &#x27;row&#x27;:
  self._dimensions.expandRow(row);
  self.<span class="apidocCodeKeywordSpan">_emitRow</span>(row);
  row = null;
  break;

case &#x27;c&#x27;:
  if (row &#x26;&#x26; c) {
    var address = colCache.decodeAddress(c.ref);
    var cell = row.getCell(address.col);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_reader.prototype.destroy" id="apidoc.element.exceljs.worksheet_reader.prototype.destroy">
        function <span class="apidocSignatureSpan">exceljs.worksheet_reader.prototype.</span>destroy
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">destroy = function () {
  throw new Error(&#x27;Invalid Operation: destroy&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
},
_removeWorksheet: function _removeWorksheet(worksheet) {
  delete this._worksheets[worksheet.id];
},
removeWorksheet: function removeWorksheet(id) {
  var worksheet = this.getWorksheet(id);
  if (worksheet) {
    worksheet.<span class="apidocCodeKeywordSpan">destroy</span>();
  }
},

getWorksheet: function getWorksheet(id) {
  if (id === undefined) {
    return this._worksheets.find(function (worksheet) {
      return worksheet;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_reader.prototype.getColumn" id="apidoc.element.exceljs.worksheet_reader.prototype.getColumn">
        function <span class="apidocSignatureSpan">exceljs.worksheet_reader.prototype.</span>getColumn
        <span class="apidocSignatureSpan">(c)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getColumn = function (c) {
  if (typeof c === &#x27;string&#x27;){
    // if it matches a key&#x27;d column, return that
    var col = this._keys[c];
    if (col) { return col; }

    // otherise, assume letter
    c = colCache.l2n(c);
  }
  if (!this._columns) { this._columns = []; }
  if (c &#x3e; this._columns.length) {
    var n = this._columns.length + 1;
    while (n &#x3c;= c) {
      this._columns.push(new Column(this, n++));
    }
  }
  return this._columns[c-1];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
worksheet.columns = [
    { header: &#x27;Id&#x27;, key: &#x27;id&#x27;, width: 10 },
    { header: &#x27;Name&#x27;, key: &#x27;name&#x27;, width: 32 },
    { header: &#x27;D.O.B.&#x27;, key: &#x27;DOB&#x27;, width: 10, outlineLevel: 1 }
];

// Access an individual columns by key, letter and 1-based column number
var idCol = worksheet.<span class="apidocCodeKeywordSpan">getColumn</span>(&#x27;id&#x27;);
var nameCol = worksheet.getColumn(&#x27;B&#x27;);
var dobCol = worksheet.getColumn(3);

// set column properties

// Note: will overwrite cell value C1
dobCol.header = &#x27;Date of Birth&#x27;;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_reader.prototype.read" id="apidoc.element.exceljs.worksheet_reader.prototype.read">
        function <span class="apidocSignatureSpan">exceljs.worksheet_reader.prototype.</span>read
        <span class="apidocSignatureSpan">(entry, options, hyperlinkReader)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">read = function (entry, options, hyperlinkReader) {
  var self = this;

  var emitSheet = false;
  var prepSheet = false;
  var emitHyperlinks = false;
  var hyperlinks = null;
  switch (options.worksheets) {
    case &#x27;emit&#x27;:
      emitSheet = true;
      break;
    case &#x27;prep&#x27;:
      prepSheet = true;
      break;
  }
  switch(options.hyperlinks) {
    case &#x27;emit&#x27;:
      emitHyperlinks = true;
      break;
    case &#x27;cache&#x27;:
      this.hyperlinks = hyperlinks = {};
      break;
  }
  if (!emitSheet &#x26;&#x26; !emitHyperlinks &#x26;&#x26; !hyperlinks) {
    entry.autodrain();
    return;
  }

  // references
  var sharedStrings = this.workbook.sharedStrings;
  var styles = this.workbook.styles;

  // xml position
  var inCols = false;
  var inRows = false;
  var inHyperlinks = false;

  // parse state
  var cols = null;
  var row = null;
  var c = null;
  var current = null;

  var parser = Sax.createStream(true, {});
  parser.on(&#x27;opentag&#x27;, function(node) {
    if (emitSheet) {
      switch (node.name) {
        case &#x27;cols&#x27;:
          inCols = true;
          cols = [];
          break;
        case &#x27;sheetData&#x27;:
          inRows = true;
          break;

        case &#x27;col&#x27;:
          if (inCols) {
            cols.push({
              min: parseInt(node.attributes.min),
              max: parseInt(node.attributes.max),
              width: parseFloat(node.attributes.width),
              styleId: parseInt(node.attributes.style || &#x27;0&#x27;)
            });
          }
          break;

        case &#x27;row&#x27;:
          if (inRows) {
            var r = parseInt(node.attributes.r);
            row = new Row(self, r);
            if (node.attributes.ht) {
              row.height = parseFloat(node.attributes.ht);
            }
            if (node.attributes.s) {
              var styleId = parseInt(node.attributes.s);
              row.style = styles.getStyleModel(styleId);
            }
          }
          break;
        case &#x27;c&#x27;:
          if (row) {
            c = {
              ref: node.attributes.r,
              s: parseInt(node.attributes.s),
              t: node.attributes.t
            };
          }
          break;
        case &#x27;f&#x27;:
          if (c) {
            current = c.f = { text: &#x27;&#x27; };
          }
          break;
        case &#x27;v&#x27;:
          if (c) {
            current = c.v = { text: &#x27;&#x27; };
          }
          break;
        case &#x27;mergeCell&#x27;:
      }
    }


    // =================================================================
    //
    if (emitHyperlinks || hyperlinks) {
      switch (node.name) {
        case &#x27;hyperlinks&#x27;:
          inHyperlinks = true;
          break;
        case &#x27;hyperlink&#x27;:
          if (inHyperlinks) {
            var hyperlink = {
              ref: node.attributes.ref,
              rId: node.attributes[&#x27;r:id&#x27;]
            };
            if (emitHyperlinks) {
              self.emit(&#x27;hyperlink&#x27;, hyperlink);
            } else {
              hyperlinks[hyperlink.ref] = hyperlink;
            }
          }
          break;
      }
    }
  });

  // only text data is for sheet values
  parser.on(&#x27;text&#x27;, function (text) {
    if (emitSheet) {
      if (current) {
        current.text += text;
      }
    }
  });

  parser.on(&#x27;closetag&#x27;, function(name) {
    if (emitSheet) {
      switch (name) {
        case &#x27;cols&#x27;:
          inCols = false;
          self._columns = Column.fromModel(cols);
          break;
        case &#x27;sheetData&#x27;:
          inRows = false;
          break;

        case &#x27;row&#x27;:
          self._dimensions.expandRow(row);
          self._emitRow(row);
          row = null;
          break;

        case &#x27;c&#x27;:
          if (row &#x26;&#x26; c) {
            var address = colCache.decodeAddress(c.ref);
            var cell = row.getCell(address.col);
            if (c.s) {
              cell.style = self.workbook.styles.getStyleModel(c.s);
            }

            if (c.f) {
              var value = {
                formula: c.f.text ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...
workbook.csv.readFile(filename)
    .then(function(worksheet) {
        // use workbook or worksheet
    });

// read from a stream
var workbook = new Excel.Workbook();
workbook.csv.<span class="apidocCodeKeywordSpan">read</span>(stream)
    .then(function(worksheet) {
        // use workbook or worksheet
    });

// pipe from stream
var workbook = new Excel.Workbook();
stream.pipe(workbook.csv.createInputStream());
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.worksheet_writer" id="apidoc.module.exceljs.worksheet_writer">module exceljs.worksheet_writer</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.worksheet_writer" id="apidoc.element.exceljs.worksheet_writer.worksheet_writer">
        function <span class="apidocSignatureSpan">exceljs.</span>worksheet_writer
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">worksheet_writer = function (options) {
  // in a workbook, each sheet will have a number
  this.id = options.id;

  // and a name
  this.name = options.name || &#x27;Sheet&#x27; + this.id;

  // rows are stored here while they need to be worked on.
  // when they are committed, they will be deleted.
  this._rows = [];

  // column definitions
  this._columns = null;

  // column keys (addRow convenience): key ==&#x3e; this._columns index
  this._keys = {};

  // keep record of all merges
  this._merges = [];
  this._merges.add = function() {}; // ignore cell instruction

  // keep record of all hyperlinks
  this._hyperlinkWriter = new HyperlinkWriter(options);

  // keep a record of dimensions
  this._dimensions = new Dimensions();

  // first uncommitted row
  this._rowZero = 1;

  // committed flag
  this.committed = false;

  // for data validations
  this.dataValidations = new DataValidations();

  // for sharing formulae
  this._formulae = {};
  this._siFormulae = 0;

  // for default row height, outline levels, etc
  this.properties = Object.assign({}, {
    defaultRowHeight: 15,
    dyDescent: 55,
    outlineLevelCol: 0,
    outlineLevelRow: 0
  }, options.properties);

  // for all things printing
  this.pageSetup = Object.assign({}, {
    margins: {left: 0.7, right: 0.7, top: 0.75, bottom: 0.75, header: 0.3, footer:  0.3 },
    orientation: &#x27;portrait&#x27;,
    horizontalDpi: 4294967295,
    verticalDpi: 4294967295,
    fitToPage: !!(options.pageSetup &#x26;&#x26; ((options.pageSetup.fitToWidth || options.pageSetup.fitToHeight) &#x26;&#x26; !options.pageSetup.scale
)),
    pageOrder: &#x27;downThenOver&#x27;,
    blackAndWhite: false,
    draft: false,
    cellComments: &#x27;None&#x27;,
    errors: &#x27;displayed&#x27;,
    scale: 100,
    fitToWidth: 1,
    fitToHeight: 1,
    paperSize: undefined,
    showRowColHeaders: false,
    showGridLines: false,
    horizontalCentered: false,
    verticalCentered: false,
    rowBreaks: null,
    colBreaks: null
  }, options.pageSetup);

  // using shared strings creates a smaller xlsx file but may use more memory
  this.useSharedStrings = options.useSharedStrings || false;

  this._workbook = options.workbook;

  // views
  this._views = options.views || [];

  // start writing to stream now
  this._writeOpenWorksheet();

  this.startedData = false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.worksheet_writer.prototype" id="apidoc.module.exceljs.worksheet_writer.prototype">module exceljs.worksheet_writer.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype._commitRow" id="apidoc.element.exceljs.worksheet_writer.prototype._commitRow">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_commitRow
        <span class="apidocSignatureSpan">(cRow)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_commitRow = function (cRow) {
  // since rows must be written in order, we commit all rows up till and including cRow
  var found = false;
  while (this._rows.length &#x26;&#x26; !found) {
    var row = this._rows.shift();
    this._rowZero++;
    if (row) {
      this._writeRow(row);
      found = (row.number === cRow.number);
      this._rowZero = row.number + 1;
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
get worksheet() {
  return this._worksheet;
},

// Inform Streaming Writer that this row (and all rows before it) are complete
// and ready to write. Has no effect on Worksheet document
commit: function commit() {
  this._worksheet.<span class="apidocCodeKeywordSpan">_commitRow</span>(this);
},

// helps GC by breaking cyclic references
destroy: function destroy() {
  delete this._worksheet;
  delete this._cells;
  delete this.style;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype._write" id="apidoc.element.exceljs.worksheet_writer.prototype._write">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_write
        <span class="apidocSignatureSpan">(text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_write = function (text) {
  xml.reset();
  xml.addText(text);
  this.stream.write(xml);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// Write chunk to all pipes. A chunk with no data is the end
var promises = [];
this.pipes.forEach(function(pipe) {
  if (chunk.data) {
    if (pipe.sync) {
      pipe.stream.write(chunk.data, chunk.encoding);
    } else {
      promises.push(self.<span class="apidocCodeKeywordSpan">_write</span>(pipe.stream, chunk.data, chunk.encoding));
    }
  } else {
    pipe.stream.end();
  }
});
if (!promises.length) {
  promises.push(PromishLib.Promish.resolve());
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype._writeCloseSheetData" id="apidoc.element.exceljs.worksheet_writer.prototype._writeCloseSheetData">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writeCloseSheetData
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_writeCloseSheetData = function () {
  this._write(&#x27;&#x3c;/sheetData&#x3e;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

// we _cannot_ accept new rows from now on
this._rows = null;

if (!this.startedData) {
    this._writeOpenSheetData();
}
this.<span class="apidocCodeKeywordSpan">_writeCloseSheetData</span>();
this._writeMergeCells();

this._writeHyperlinks();
this._writeDataValidations();
this._writePageMargins();
this._writePageSetup();
this._writeCloseWorksheet();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype._writeCloseWorksheet" id="apidoc.element.exceljs.worksheet_writer.prototype._writeCloseWorksheet">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writeCloseWorksheet
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_writeCloseWorksheet = function () {
  this._write(&#x27;&#x3c;/worksheet&#x3e;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
this._writeCloseSheetData();
this._writeMergeCells();

this._writeHyperlinks();
this._writeDataValidations();
this._writePageMargins();
this._writePageSetup();
this.<span class="apidocCodeKeywordSpan">_writeCloseWorksheet</span>();

// signal end of stream to workbook
this.stream.end();

// also commit the hyperlinks if any
this._hyperlinkWriter.commit();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype._writeColumns" id="apidoc.element.exceljs.worksheet_writer.prototype._writeColumns">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writeColumns
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_writeColumns = function () {
  var cols = Column.toModel(this.columns);
  if (cols) {
    xform.columns.prepare(cols, {styles: this._workbook.styles});
    this.stream.write(xform.columns.toXml(cols));
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  _writeOpenSheetData: function() {
this._write(&#x27;&#x3c;sheetData&#x3e;&#x27;);
  },
  _writeRow: function(row) {
var self = this;

if (!this.startedData) {
  this.<span class="apidocCodeKeywordSpan">_writeColumns</span>();
  this._writeOpenSheetData();
  this.startedData = true;
}

if (row.hasValues || row.height) {
  var model = row.model;
  var options = {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype._writeDataValidations" id="apidoc.element.exceljs.worksheet_writer.prototype._writeDataValidations">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writeDataValidations
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_writeDataValidations = function () {
  this.stream.write(xform.dataValidations.toXml(this.dataValidations.model));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (!this.startedData) {
    this._writeOpenSheetData();
}
this._writeCloseSheetData();
this._writeMergeCells();

this._writeHyperlinks();
this.<span class="apidocCodeKeywordSpan">_writeDataValidations</span>();
this._writePageMargins();
this._writePageSetup();
this._writeCloseWorksheet();

// signal end of stream to workbook
this.stream.end();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype._writeDimensions" id="apidoc.element.exceljs.worksheet_writer.prototype._writeDimensions">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writeDimensions
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_writeDimensions = function () {
  // for some reason, Excel can&#x27;t handle dimensions at the bottom of the file
  // and we don&#x27;t know the dimensions until the commit, so don&#x27;t write them.
  // this._write(&#x27;&#x3c;dimension ref=&#x22;&#x27; + this._dimensions + &#x27;&#x22;/&#x3e;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype._writeHyperlinks" id="apidoc.element.exceljs.worksheet_writer.prototype._writeHyperlinks">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writeHyperlinks
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_writeHyperlinks = function () {
  this.stream.write(xform.hyperlinks.toXml(this._hyperlinkWriter._hyperlinks));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

if (!this.startedData) {
    this._writeOpenSheetData();
}
this._writeCloseSheetData();
this._writeMergeCells();

this.<span class="apidocCodeKeywordSpan">_writeHyperlinks</span>();
this._writeDataValidations();
this._writePageMargins();
this._writePageSetup();
this._writeCloseWorksheet();

// signal end of stream to workbook
this.stream.end();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype._writeMergeCells" id="apidoc.element.exceljs.worksheet_writer.prototype._writeMergeCells">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writeMergeCells
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_writeMergeCells = function () {
  if (this._merges.length) {
    xml.reset();
    xml.addText(&#x27;&#x3c;mergeCells count=&#x22;&#x27; + this._merges.length + &#x27;&#x22;&#x3e;&#x27;);
    this._merges.forEach(function(merge) {
      xml.addText(&#x27;&#x3c;mergeCell ref=&#x22;&#x27; + merge + &#x27;&#x22;/&#x3e;&#x27;);
    });
    xml.addText(&#x27;&#x3c;/mergeCells&#x3e;&#x27;);

    this.stream.write(xml);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// we _cannot_ accept new rows from now on
this._rows = null;

if (!this.startedData) {
    this._writeOpenSheetData();
}
this._writeCloseSheetData();
this.<span class="apidocCodeKeywordSpan">_writeMergeCells</span>();

this._writeHyperlinks();
this._writeDataValidations();
this._writePageMargins();
this._writePageSetup();
this._writeCloseWorksheet();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype._writeOpenSheetData" id="apidoc.element.exceljs.worksheet_writer.prototype._writeOpenSheetData">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writeOpenSheetData
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_writeOpenSheetData = function () {
  this._write(&#x27;&#x3c;sheetData&#x3e;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  }
});

// we _cannot_ accept new rows from now on
this._rows = null;

if (!this.startedData) {
    this.<span class="apidocCodeKeywordSpan">_writeOpenSheetData</span>();
}
this._writeCloseSheetData();
this._writeMergeCells();

this._writeHyperlinks();
this._writeDataValidations();
this._writePageMargins();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype._writeOpenWorksheet" id="apidoc.element.exceljs.worksheet_writer.prototype._writeOpenWorksheet">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writeOpenWorksheet
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_writeOpenWorksheet = function () {
  xml.reset();

  xml.addText(&#x27;&#x3c;?xml version=&#x22;1.0&#x22; encoding=&#x22;UTF-8&#x22; standalone=&#x22;yes&#x22;?&#x3e;&#x27;);
  xml.addText(&#x27;&#x3c;worksheet xmlns=&#x22;http://schemas.openxmlformats.org/spreadsheetml/2006/main&#x22; xmlns:r=&#x22;http://schemas.openxmlformats
.org/officeDocument/2006/relationships&#x22; xmlns:mc=&#x22;http://schemas.openxmlformats.org/markup-compatibility/2006&#x22; mc:Ignorable=&#x22;x14ac
&#x22; xmlns:x14ac=&#x22;http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac&#x22;&#x3e;&#x27;); // eslint-disable-line max-len

  this._writeSheetProperties(xml, this.properties, this.pageSetup);

  xml.addText(xform.sheetViews.toXml(this.views));

  this._writeSheetFormatProperties(xml, this.properties);

  this.stream.write(xml);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

this._workbook = options.workbook;

// views
this._views = options.views || [];

// start writing to stream now
this.<span class="apidocCodeKeywordSpan">_writeOpenWorksheet</span>();

this.startedData = false;
};

WorksheetWriter.prototype = {
get workbook() {
  return this._workbook;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype._writePageMargins" id="apidoc.element.exceljs.worksheet_writer.prototype._writePageMargins">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writePageMargins
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_writePageMargins = function () {
  this.stream.write(xform.pageMargins.toXml(this.pageSetup.margins));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    this._writeOpenSheetData();
}
this._writeCloseSheetData();
this._writeMergeCells();

this._writeHyperlinks();
this._writeDataValidations();
this.<span class="apidocCodeKeywordSpan">_writePageMargins</span>();
this._writePageSetup();
this._writeCloseWorksheet();

// signal end of stream to workbook
this.stream.end();

// also commit the hyperlinks if any
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype._writePageSetup" id="apidoc.element.exceljs.worksheet_writer.prototype._writePageSetup">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writePageSetup
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_writePageSetup = function () {
  this.stream.write(xform.pageSeteup.toXml(this.pageSetup));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}
this._writeCloseSheetData();
this._writeMergeCells();

this._writeHyperlinks();
this._writeDataValidations();
this._writePageMargins();
this.<span class="apidocCodeKeywordSpan">_writePageSetup</span>();
this._writeCloseWorksheet();

// signal end of stream to workbook
this.stream.end();

// also commit the hyperlinks if any
this._hyperlinkWriter.commit();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype._writeRow" id="apidoc.element.exceljs.worksheet_writer.prototype._writeRow">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writeRow
        <span class="apidocSignatureSpan">(row)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_writeRow = function (row) {
  var self = this;

  if (!this.startedData) {
    this._writeColumns();
    this._writeOpenSheetData();
    this.startedData = true;
  }

  if (row.hasValues || row.height) {
    var model = row.model;
    var options = {
      styles: this._workbook.styles,
      sharedStrings: self.useSharedStrings ? self._workbook.sharedStrings : undefined,
      hyperlinks: this._hyperlinkWriter,
      merges: this._merges,
      formulae: this._formulae,
      siFormulae: this._siFormulae,
    };
    xform.row.prepare(model, options);
    this.stream.write(xform.row.toXml(model));
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return;
}
var self = this;
// commit all rows
this._rows.forEach(function(cRow) {
  if (cRow) {
    // write the row to the stream
    self.<span class="apidocCodeKeywordSpan">_writeRow</span>(cRow);
  }
});

// we _cannot_ accept new rows from now on
this._rows = null;

if (!this.startedData) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype._writeSheetFormatProperties" id="apidoc.element.exceljs.worksheet_writer.prototype._writeSheetFormatProperties">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writeSheetFormatProperties
        <span class="apidocSignatureSpan">(xmlBuf, properties)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_writeSheetFormatProperties = function (xmlBuf, properties) {
  var sheetFormatPropertiesModel = properties ? {
    defaultRowHeight: properties.defaultRowHeight,
    dyDescent: properties.dyDescent,
    outlineLevelCol: properties.outlineLevelCol,
    outlineLevelRow: properties.outlineLevelRow
  } : undefined;

  xmlBuf.addText(xform.sheetFormatProperties.toXml(sheetFormatPropertiesModel));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  xml.addText(&#x27;&#x3c;?xml version=&#x22;1.0&#x22; encoding=&#x22;UTF-8&#x22; standalone=&#x22;yes&#x22;?&#x3e;&#x27;);
  xml.addText(&#x27;&#x3c;worksheet xmlns=&#x22;http://schemas.openxmlformats.org/spreadsheetml/2006/main&#x22; xmlns:r=&#x22;http
://schemas.openxmlformats.org/officeDocument/2006/relationships&#x22; xmlns:mc=&#x22;http://schemas.openxmlformats.org/markup-compatibility
/2006&#x22; mc:Ignorable=&#x22;x14ac&#x22; xmlns:x14ac=&#x22;http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac&#x22;&#
x3e;&#x27;); // eslint-disable-line max-len

  this._writeSheetProperties(xml, this.properties, this.pageSetup);

  xml.addText(xform.sheetViews.toXml(this.views));

  this.<span class="apidocCodeKeywordSpan">_writeSheetFormatProperties</span>(xml, this.properties);

  this.stream.write(xml);
},
_writeColumns: function() {
  var cols = Column.toModel(this.columns);
  if (cols) {
    xform.columns.prepare(cols, {styles: this._workbook.styles});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype._writeSheetProperties" id="apidoc.element.exceljs.worksheet_writer.prototype._writeSheetProperties">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>_writeSheetProperties
        <span class="apidocSignatureSpan">(xmlBuf, properties, pageSetup)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_writeSheetProperties = function (xmlBuf, properties, pageSetup) {
  var sheetPropertiesModel = {
    tabColor: properties &#x26;&#x26; properties.tabColor,
    pageSetup: pageSetup &#x26;&#x26; pageSetup.fitToPage ? {
      fitToPage: pageSetup.fitToPage
    } : undefined
  };

  xmlBuf.addText(xform.sheetProperties.toXml(sheetPropertiesModel));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
},
_writeOpenWorksheet: function() {
  xml.reset();

  xml.addText(&#x27;&#x3c;?xml version=&#x22;1.0&#x22; encoding=&#x22;UTF-8&#x22; standalone=&#x22;yes&#x22;?&#x3e;&#x27;);
  xml.addText(&#x27;&#x3c;worksheet xmlns=&#x22;http://schemas.openxmlformats.org/spreadsheetml/2006/main&#x22; xmlns:r=&#x22;http
://schemas.openxmlformats.org/officeDocument/2006/relationships&#x22; xmlns:mc=&#x22;http://schemas.openxmlformats.org/markup-compatibility
/2006&#x22; mc:Ignorable=&#x22;x14ac&#x22; xmlns:x14ac=&#x22;http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac&#x22;&#
x3e;&#x27;); // eslint-disable-line max-len

  this.<span class="apidocCodeKeywordSpan">_writeSheetProperties</span>(xml, this.properties, this.pageSetup);

  xml.addText(xform.sheetViews.toXml(this.views));

  this._writeSheetFormatProperties(xml, this.properties);

  this.stream.write(xml);
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype.addRow" id="apidoc.element.exceljs.worksheet_writer.prototype.addRow">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>addRow
        <span class="apidocSignatureSpan">(value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addRow = function (value) {
  var row = new Row(this, this._nextRow);
  this._rows[row.number - this._rowZero] = row;
  row.values = value;
  return row;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

```

## Rows

```javascript
// Add a couple of Rows by key-value, after the last current row, using the column keys
worksheet.<span class="apidocCodeKeywordSpan">addRow</span>({id: 1, name: &#x27;John Doe&#x27;, dob: new Date(1970,1,1)});
worksheet.addRow({id: 2, name: &#x27;Jane Doe&#x27;, dob: new Date(1965,1,7)});

// Add a row by contiguous Array (assign to columns A, B &#x26; C)
worksheet.addRow([3, &#x27;Sam&#x27;, new Date()]);

// Add a row by sparse Array (assign to columns A, E &#x26; I)
var rowValues = [];
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype.commit" id="apidoc.element.exceljs.worksheet_writer.prototype.commit">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>commit
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">commit = function () {
  if (this.committed) {
    return;
  }
  var self = this;
  // commit all rows
  this._rows.forEach(function(cRow) {
    if (cRow) {
      // write the row to the stream
      self._writeRow(cRow);
    }
  });

  // we _cannot_ accept new rows from now on
  this._rows = null;

  if (!this.startedData) {
      this._writeOpenSheetData();
  }
  this._writeCloseSheetData();
  this._writeMergeCells();

  this._writeHyperlinks();
  this._writeDataValidations();
  this._writePageMargins();
  this._writePageSetup();
  this._writeCloseWorksheet();

  // signal end of stream to workbook
  this.stream.end();

  // also commit the hyperlinks if any
  this._hyperlinkWriter.commit();

  this.committed = true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// Note: this operation will not affect other rows
row.splice(3,2);

// remove one cell and insert two more (cells to the right of the cut cell will be shifted right)
row.splice(4,1,&#x27;new value 1&#x27;, &#x27;new value 2&#x27;);

// Commit a completed row to stream
row.<span class="apidocCodeKeywordSpan">commit</span>();

// row metrics
var rowSize = row.cellCount;
var numValues = row.actualCellCount;
```

## Handling Individual Cells
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype.destroy" id="apidoc.element.exceljs.worksheet_writer.prototype.destroy">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>destroy
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">destroy = function () {
  throw new Error(&#x27;Invalid Operation: destroy&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
},
_removeWorksheet: function _removeWorksheet(worksheet) {
  delete this._worksheets[worksheet.id];
},
removeWorksheet: function removeWorksheet(id) {
  var worksheet = this.getWorksheet(id);
  if (worksheet) {
    worksheet.<span class="apidocCodeKeywordSpan">destroy</span>();
  }
},

getWorksheet: function getWorksheet(id) {
  if (id === undefined) {
    return this._worksheets.find(function (worksheet) {
      return worksheet;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype.eachRow" id="apidoc.element.exceljs.worksheet_writer.prototype.eachRow">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>eachRow
        <span class="apidocSignatureSpan">(options, iteratee)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">eachRow = function (options, iteratee) {
  if (!iteratee) {
    iteratee = options;
    options = undefined;
  }
  if (options &#x26;&#x26; options.includeEmpty) {
    var n = this._nextRow;
    for (var i = this._rowZero; i &#x3c; n; i++) {
      iteratee(this.getRow(i), i);
    }
  } else {
    this._rows.forEach(function(row) {
      if (row.hasValues) {
        iteratee(row, row.number);
      }
    });
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
row.values = {
    id: 13,
    name: &#x27;Thing 1&#x27;,
    dob: new Date()
};

// Iterate over all rows that have values in a worksheet
worksheet.<span class="apidocCodeKeywordSpan">eachRow</span>(function(row, rowNumber) {
    console.log(&#x27;Row &#x27; + rowNumber + &#x27; = &#x27; + JSON.stringify(row.values));
});

// Iterate over all rows (including empty rows) in a worksheet
worksheet.eachRow({ includeEmpty: true }, function(row, rowNumber) {
    console.log(&#x27;Row &#x27; + rowNumber + &#x27; = &#x27; + JSON.stringify(row.values));
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype.findCell" id="apidoc.element.exceljs.worksheet_writer.prototype.findCell">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>findCell
        <span class="apidocSignatureSpan">(r, c)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findCell = function (r, c) {
  var address = colCache.getAddress(r, c);
  var row = this.findRow(address.row);
  return row ? row.findCell(address.column) : undefined;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
},
set address(value) {
  this.model.address = value;
},
_getTranslatedFormula: function _getTranslatedFormula() {
  if (!this._translatedFormula &#x26;&#x26; this.model.sharedFormula) {
    var worksheet = this.cell._row.worksheet;
    var master = worksheet.<span class="apidocCodeKeywordSpan">findCell</span>(this.model.sharedFormula);
    this._translatedFormula = master &#x26;&#x26; slideFormula(master.formula, master.address, this.model.address);
  }
  return this._translatedFormula;
},

toCsvString: function toCsvString() {
  return &#x27;&#x27; + (this.model.result || &#x27;&#x27;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype.findRow" id="apidoc.element.exceljs.worksheet_writer.prototype.findRow">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>findRow
        <span class="apidocSignatureSpan">(rowNumber)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findRow = function (rowNumber) {
  var index = rowNumber - this._rowZero;
  return this._rows[index];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

// ================================================================================
// Cells

// returns the cell at [r,c] or address given by r. If not found, return undefined
findCell: function(r, c) {
  var address = colCache.getAddress(r, c);
  var row = this.<span class="apidocCodeKeywordSpan">findRow</span>(address.row);
  return row ? row.findCell(address.column) : undefined;
},

// return the cell at [r,c] or address given by r. If not found, create a new one.
getCell: function(r, c) {
  var address = colCache.getAddress(r, c);
  var row = this.getRow(address.row);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype.getCell" id="apidoc.element.exceljs.worksheet_writer.prototype.getCell">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>getCell
        <span class="apidocSignatureSpan">(r, c)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getCell = function (r, c) {
  var address = colCache.getAddress(r, c);
  var row = this.getRow(address.row);
  return row._getCell(address);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
worksheet.getRow(5).outlineLevel = 1;

// rows support a readonly field to indicate the collapsed state based on outlineLevel
expect(worksheet.getRow(4).collapsed).to.equal(false);
expect(worksheet.getRow(5).collapsed).to.equal(true);


row.<span class="apidocCodeKeywordSpan">getCell</span>(1).value = 5; // A5&#x27;s value set to 5
row.getCell(&#x27;name&#x27;).value = &#x27;Zeb&#x27;; // B5&#x27;s value set to &#x27;Zeb&#x27; - assuming column 2 is still keyed
 by name
row.getCell(&#x27;C&#x27;).value = new Date(); // C5&#x27;s value set to now

// Get a row as a sparse array
// Note: interface change: worksheet.getRow(4) ==&#x3e; worksheet.getRow(4).values
row = worksheet.getRow(4).values;
expect(row[5]).toEqual(&#x27;Kyle&#x27;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype.getColumn" id="apidoc.element.exceljs.worksheet_writer.prototype.getColumn">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>getColumn
        <span class="apidocSignatureSpan">(c)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getColumn = function (c) {
  if (typeof c === &#x27;string&#x27;){
    // if it matches a key&#x27;d column, return that
    var col = this._keys[c];
    if (col) return col;

    // otherwise, assume letter
    c = colCache.l2n(c);
  }
  if (!this._columns) { this._columns = []; }
  if (c &#x3e; this._columns.length) {
    var n = this._columns.length + 1;
    while (n &#x3c;= c) {
      this._columns.push(new Column(this, n++));
    }
  }
  return this._columns[c - 1];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
worksheet.columns = [
    { header: &#x27;Id&#x27;, key: &#x27;id&#x27;, width: 10 },
    { header: &#x27;Name&#x27;, key: &#x27;name&#x27;, width: 32 },
    { header: &#x27;D.O.B.&#x27;, key: &#x27;DOB&#x27;, width: 10, outlineLevel: 1 }
];

// Access an individual columns by key, letter and 1-based column number
var idCol = worksheet.<span class="apidocCodeKeywordSpan">getColumn</span>(&#x27;id&#x27;);
var nameCol = worksheet.getColumn(&#x27;B&#x27;);
var dobCol = worksheet.getColumn(3);

// set column properties

// Note: will overwrite cell value C1
dobCol.header = &#x27;Date of Birth&#x27;;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype.getRow" id="apidoc.element.exceljs.worksheet_writer.prototype.getRow">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>getRow
        <span class="apidocSignatureSpan">(rowNumber)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getRow = function (rowNumber) {
  var index = rowNumber - this._rowZero;

  // may fail if rows have been comitted
  if (index &#x3c; 0) {
    throw new Error(&#x27;Out of bounds: this row has been committed&#x27;);
  }
  var row = this._rows[index];
  if (!row) {
    this._rows[index] = row = new Row(this, rowNumber);
  }
  return row;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var rows = [
    [5,&#x27;Bob&#x27;,new Date()], // row by array
    {id:6, name: &#x27;Barbara&#x27;, dob: new Date()}
];
worksheet.addRows(rows);

// Get a row object. If it doesn&#x27;t already exist, a new empty one will be returned
var row = worksheet.<span class="apidocCodeKeywordSpan">getRow</span>(5);

// Get the last editable row in a worksheet (or undefined if there are none)
var row = worksheet.lastRow;

// Set a specific row height
row.height = 42.5;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.worksheet_writer.prototype.mergeCells" id="apidoc.element.exceljs.worksheet_writer.prototype.mergeCells">
        function <span class="apidocSignatureSpan">exceljs.worksheet_writer.prototype.</span>mergeCells
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mergeCells = function () {
  // may fail if rows have been comitted
  var dimensions = new Dimensions(Array.prototype.slice.call(arguments, 0)); // convert arguments into Array

  // check cells aren&#x27;t already merged
  this._merges.forEach(function(merge) {
    if (merge.intersects(dimensions)) {
      throw new Error(&#x27;Cannot merge alreay merged cells&#x27;);
    }
  });

  // apply merge
  var master = this.getCell(dimensions.top, dimensions.left);
  for (var i = dimensions.top; i &#x3c;= dimensions.bottom; i++) {
    for (var j = dimensions.left; j &#x3c;= dimensions.right; j++) {
      if ((i &#x3e; dimensions.top) || (j &#x3e; dimensions.left)) {
        this.getCell(i,j).merge(master);
      }
    }
  }

  // index merge
  this._merges.push(dimensions);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
expect(worksheet.getCell(&#x27;C3&#x27;).type).toEqual(Excel.ValueType.Date);
```

## Merged Cells

```javascript
// merge a range of cells
worksheet.<span class="apidocCodeKeywordSpan">mergeCells</span>(&#x27;A4:B5&#x27;);

// ... merged cells are linked
worksheet.getCell(&#x27;B5&#x27;).value = &#x27;Hello, World!&#x27;;
expect(worksheet.getCell(&#x27;B5&#x27;).value).toBe(worksheet.getCell(&#x27;A4&#x27;).value);
expect(worksheet.getCell(&#x27;B5&#x27;).master).toBe(worksheet.getCell(&#x27;A4&#x27;));

// ... merged cells share the same style object
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.xlsx" id="apidoc.module.exceljs.xlsx">module exceljs.xlsx</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.xlsx.xlsx" id="apidoc.element.exceljs.xlsx.xlsx">
        function <span class="apidocSignatureSpan">exceljs.</span>xlsx
        <span class="apidocSignatureSpan">(workbook)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">xlsx = function (workbook) {
  this.workbook = workbook;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.xlsx.prototype" id="apidoc.module.exceljs.xlsx.prototype">module exceljs.xlsx.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype._finalize" id="apidoc.element.exceljs.xlsx.prototype._finalize">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>_finalize
        <span class="apidocSignatureSpan">(zip)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_finalize = function (zip) {
  var self = this;

  return new PromishLib.Promish(function(resolve, reject) {

    zip.on(&#x27;finish&#x27;, function () {
      resolve(self);
    });
    zip.on(&#x27;error&#x27;, function (error) {
      reject(error);
    });

    zip.finalize();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    ];
    return PromishLib.Promish.all(afters);
  })
  .then(function () {
    return self.addWorkbook(zip, model, workbookXform);
  })
  .then(function () {
    return self.<span class="apidocCodeKeywordSpan">_finalize</span>(zip);
  });
  },
  writeFile: function (filename, options) {
var self = this;
var stream = fs.createWriteStream(filename);

return new PromishLib.Promish(function(resolve, reject) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype.addApp" id="apidoc.element.exceljs.xlsx.prototype.addApp">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>addApp
        <span class="apidocSignatureSpan">(zip, model)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addApp = function (zip, model) {
  return new PromishLib.Promish(function(resolve) {
    var xform = new AppXform();
    var xml = xform.toXml(model);
    zip.append(xml, {name: &#x27;docProps/app.xml&#x27;});
    resolve();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
model.worksheets.forEach(function (worksheet) {
  worksheetXform.prepare(worksheet, prepareOptions);
});

// render
var promises = [
  self.addContentTypes(zip, model),
  self.<span class="apidocCodeKeywordSpan">addApp</span>(zip, model),
  self.addCore(zip, model),
  self.addThemes(zip, model),
  self.addOfficeRels(zip, model)
];
return PromishLib.Promish.all(promises)
  .then(function () {
    return self.addWorksheets(zip, model, worksheetXform);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype.addContentTypes" id="apidoc.element.exceljs.xlsx.prototype.addContentTypes">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>addContentTypes
        <span class="apidocSignatureSpan">(zip, model)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addContentTypes = function (zip, model) {
  return new PromishLib.Promish(function(resolve) {
    var xform = new ContentTypesXform();
    var xml = xform.toXml(model);
    zip.append(xml, {name: &#x27;[Content_Types].xml&#x27;});
    resolve();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
workbookXform.prepare(model);
model.worksheets.forEach(function (worksheet) {
  worksheetXform.prepare(worksheet, prepareOptions);
});

// render
var promises = [
  self.<span class="apidocCodeKeywordSpan">addContentTypes</span>(zip, model),
  self.addApp(zip, model),
  self.addCore(zip, model),
  self.addThemes(zip, model),
  self.addOfficeRels(zip, model)
];
return PromishLib.Promish.all(promises)
  .then(function () {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype.addCore" id="apidoc.element.exceljs.xlsx.prototype.addCore">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>addCore
        <span class="apidocSignatureSpan">(zip, model)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addCore = function (zip, model) {
  return new PromishLib.Promish(function(resolve) {
    var coreXform = new CoreXform();
    zip.append(coreXform.toXml(model), {name: &#x27;docProps/core.xml&#x27;});
    resolve();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  worksheetXform.prepare(worksheet, prepareOptions);
});

// render
var promises = [
  self.addContentTypes(zip, model),
  self.addApp(zip, model),
  self.<span class="apidocCodeKeywordSpan">addCore</span>(zip, model),
  self.addThemes(zip, model),
  self.addOfficeRels(zip, model)
];
return PromishLib.Promish.all(promises)
  .then(function () {
    return self.addWorksheets(zip, model, worksheetXform);
  })
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype.addOfficeRels" id="apidoc.element.exceljs.xlsx.prototype.addOfficeRels">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>addOfficeRels
        <span class="apidocSignatureSpan">(zip)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addOfficeRels = function (zip) {
  return new PromishLib.Promish(function(resolve) {
    var xform = new RelationshipsXform();
    var xml = xform.toXml([
        {rId: &#x27;rId1&#x27;, type: XLSX.RelType.OfficeDocument, target: &#x27;xl/workbook.xml&#x27;}
      ]);
    zip.append(xml, {name: &#x27;_rels/.rels&#x27;});
    resolve();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

// render
var promises = [
  self.addContentTypes(zip, model),
  self.addApp(zip, model),
  self.addCore(zip, model),
  self.addThemes(zip, model),
  self.<span class="apidocCodeKeywordSpan">addOfficeRels</span>(zip, model)
];
return PromishLib.Promish.all(promises)
  .then(function () {
    return self.addWorksheets(zip, model, worksheetXform);
  })
  .then(function () {
    // Some things can only be done after all the worksheets have been processed
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype.addSharedStrings" id="apidoc.element.exceljs.xlsx.prototype.addSharedStrings">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>addSharedStrings
        <span class="apidocSignatureSpan">(zip, model)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addSharedStrings = function (zip, model) {
  if (!model.sharedStrings || !model.sharedStrings.count) {
    return PromishLib.Promish.resolve();
  } else {
    return new PromishLib.Promish(function(resolve) {
      zip.append(model.sharedStrings.xml, {name: &#x27;xl/sharedStrings.xml&#x27;});
      resolve();
    });
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return PromishLib.Promish.all(promises)
.then(function () {
  return self.addWorksheets(zip, model, worksheetXform);
})
.then(function () {
  // Some things can only be done after all the worksheets have been processed
  var afters = [
    self.<span class="apidocCodeKeywordSpan">addSharedStrings</span>(zip, model),
    self.addStyles(zip, model),
    self.addWorkbookRels(zip, model)
  ];
  return PromishLib.Promish.all(afters);
})
.then(function () {
  return self.addWorkbook(zip, model, workbookXform);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype.addStyles" id="apidoc.element.exceljs.xlsx.prototype.addStyles">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>addStyles
        <span class="apidocSignatureSpan">(zip, model)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addStyles = function (zip, model) {
  return new PromishLib.Promish(function(resolve) {
    var xml = model.styles.xml;
    if (xml) {
      zip.append(xml, {name: &#x27;xl/styles.xml&#x27;});
    }
    resolve();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
.then(function () {
  return self.addWorksheets(zip, model, worksheetXform);
})
.then(function () {
  // Some things can only be done after all the worksheets have been processed
  var afters = [
    self.addSharedStrings(zip, model),
    self.<span class="apidocCodeKeywordSpan">addStyles</span>(zip, model),
    self.addWorkbookRels(zip, model)
  ];
  return PromishLib.Promish.all(afters);
})
.then(function () {
  return self.addWorkbook(zip, model, workbookXform);
})
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype.addThemes" id="apidoc.element.exceljs.xlsx.prototype.addThemes">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>addThemes
        <span class="apidocSignatureSpan">(zip, model)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addThemes = function (zip, model) {
  return new PromishLib.Promish(function(resolve) {
    var themes = model.themes || { theme1: theme1Xml };
    Object.keys(themes).forEach(function(name) {
      var xml = themes[name];
      var path = &#x27;xl/theme/&#x27; + name + &#x27;.xml&#x27;;
      zip.append(xml, {name: path});
    });
    resolve();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
});

// render
var promises = [
  self.addContentTypes(zip, model),
  self.addApp(zip, model),
  self.addCore(zip, model),
  self.<span class="apidocCodeKeywordSpan">addThemes</span>(zip, model),
  self.addOfficeRels(zip, model)
];
return PromishLib.Promish.all(promises)
  .then(function () {
    return self.addWorksheets(zip, model, worksheetXform);
  })
  .then(function () {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype.addWorkbook" id="apidoc.element.exceljs.xlsx.prototype.addWorkbook">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>addWorkbook
        <span class="apidocSignatureSpan">(zip, model, xform)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addWorkbook = function (zip, model, xform) {
  return new PromishLib.Promish(function(resolve) {
    zip.append(xform.toXml(model), {name: &#x27;xl/workbook.xml&#x27;});
    resolve();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        self.addSharedStrings(zip, model),
        self.addStyles(zip, model),
        self.addWorkbookRels(zip, model)
      ];
      return PromishLib.Promish.all(afters);
    })
    .then(function () {
      return self.<span class="apidocCodeKeywordSpan">addWorkbook</span>(zip, model, workbookXform);
    })
    .then(function () {
      return self._finalize(zip);
    });
},
writeFile: function (filename, options) {
  var self = this;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype.addWorkbookRels" id="apidoc.element.exceljs.xlsx.prototype.addWorkbookRels">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>addWorkbookRels
        <span class="apidocSignatureSpan">(zip, model)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addWorkbookRels = function (zip, model) {
  var count = 1;
  var relationships = [
      {rId: &#x27;rId&#x27; + (count++), type: XLSX.RelType.Styles, target: &#x27;styles.xml&#x27;},
      {rId: &#x27;rId&#x27; + (count++), type: XLSX.RelType.Theme, target: &#x27;theme/theme1.xml&#x27;}
  ];
  if (model.sharedStrings.count) {
    relationships.push(
      {rId: &#x27;rId&#x27; + (count++), type: XLSX.RelType.SharedStrings, target: &#x27;sharedStrings.xml&#x27;}
    );
  }
  model.worksheets.forEach(function (worksheet) {
    worksheet.rId = &#x27;rId&#x27; + (count++);
    relationships.push(
      {rId: worksheet.rId, type: XLSX.RelType.Worksheet, target: &#x27;worksheets/sheet&#x27; + worksheet.id + &#x27;.xml&#x27;}
    );
  });
  return new PromishLib.Promish(function(resolve) {
    var xform = new RelationshipsXform();
    var xml = xform.toXml(relationships);
    zip.append(xml, {name: &#x27;xl/_rels/workbook.xml.rels&#x27;});
    resolve();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return self.addWorksheets(zip, model, worksheetXform);
})
.then(function () {
  // Some things can only be done after all the worksheets have been processed
  var afters = [
    self.addSharedStrings(zip, model),
    self.addStyles(zip, model),
    self.<span class="apidocCodeKeywordSpan">addWorkbookRels</span>(zip, model)
  ];
  return PromishLib.Promish.all(afters);
})
.then(function () {
  return self.addWorkbook(zip, model, workbookXform);
})
.then(function () {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype.addWorksheets" id="apidoc.element.exceljs.xlsx.prototype.addWorksheets">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>addWorksheets
        <span class="apidocSignatureSpan">(zip, model, worksheetXform)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addWorksheets = function (zip, model, worksheetXform) {
  return new PromishLib.Promish(function(resolve) {

    // preparation phase
    var relationshipsXform = new RelationshipsXform();

    // write sheets
    model.worksheets.forEach(function (worksheet) {
      var xmlStream = new XmlStream();
      worksheetXform.render(xmlStream, worksheet);
      zip.append(xmlStream.xml, {name: &#x27;xl/worksheets/sheet&#x27; + worksheet.id + &#x27;.xml&#x27;});

      if (worksheet.hyperlinks &#x26;&#x26; worksheet.hyperlinks.length) {
        xmlStream = new XmlStream();
        relationshipsXform.render(xmlStream, worksheet.hyperlinks);
        zip.append(xmlStream.xml, {name: &#x27;xl/worksheets/_rels/sheet&#x27; + worksheet.id + &#x27;.xml.rels&#x27;});
      }
    });

    resolve();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  self.addApp(zip, model),
  self.addCore(zip, model),
  self.addThemes(zip, model),
  self.addOfficeRels(zip, model)
];
return PromishLib.Promish.all(promises)
  .then(function () {
    return self.<span class="apidocCodeKeywordSpan">addWorksheets</span>(zip, model, worksheetXform);
  })
  .then(function () {
    // Some things can only be done after all the worksheets have been processed
    var afters = [
      self.addSharedStrings(zip, model),
      self.addStyles(zip, model),
      self.addWorkbookRels(zip, model)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype.createInputStream" id="apidoc.element.exceljs.xlsx.prototype.createInputStream">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>createInputStream
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createInputStream = function () {
  var self = this;
  var model = {
    worksheets: [],
    worksheetHash: {},
    worksheetRels: [],
    themes: {},
  };

  // we have to be prepared to read the zip entries in whatever order they arrive
  var promises = [];
  var stream = new ZipStream.ZipReader();
  stream.on(&#x27;entry&#x27;, function (entry) {
    var promise = null;

    var entryPath = entry.path;
    if (entryPath[0] === &#x27;/&#x27;) {
      entryPath = entryPath.substr(1);
    }
    switch (entryPath) {
      case &#x27;_rels/.rels&#x27;:
        promise = self.parseRels(entry)
          .then(function (relationships) {
            model.globalRels = relationships;
          });
        break;

      case &#x27;xl/workbook.xml&#x27;:
        promise = self.parseWorkbook(entry)
          .then(function (workbook) {
            model.sheets = workbook.sheets;
            model.definedNames = workbook.definedNames;
            model.views = workbook.views;
            model.properties = workbook.properties;
          });
        break;

      case &#x27;xl/_rels/workbook.xml.rels&#x27;:
        promise = self.parseRels(entry)
          .then(function (relationships) {
            model.workbookRels = relationships;
          });
        break;

      case &#x27;xl/sharedStrings.xml&#x27;:
        model.sharedStrings = new SharedStringsXform();
        promise = model.sharedStrings.parseStream(entry);
        break;

      case &#x27;xl/styles.xml&#x27;:
        model.styles = new StylesXform();
        promise = model.styles.parseStream(entry);
        break;

      case &#x27;docProps/app.xml&#x27;:
        var appXform = new AppXform();
        promise = appXform.parseStream(entry)
          .then(function(appProperties) {
            Object.assign(model, {
              company: appProperties.company,
              manager: appProperties.manager
            });
          });
        break;

      case &#x27;docProps/core.xml&#x27;:
        var coreXform = new CoreXform();
        promise = coreXform.parseStream(entry)
          .then(function(coreProperties) {
            Object.assign(model, coreProperties);
          });
        break;

      default:
        promise =
          self.processWorksheetEntry(entry, model) ||
          self.processWorksheetRelsEntry(entry, model) ||
          self.processThemeEntry(entry, model) ||
          self.processIgnoreEntry(entry);
        break;
    }

    if (promise) {
      promises.push(promise);
      promise = null;
    }
  });
  stream.on(&#x27;finished&#x27;, function () {
    PromishLib.Promish.all(promises)
      .then(function () {
        self.reconcile(model);

        // apply model
        self.workbook.model = model;
      })
      .then(function () {
        stream.emit(&#x27;done&#x27;);
      })
      .catch(function (error) {
        stream.emit(&#x27;error&#x27;, error);
      });
  });
  return stream;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
workbook.xlsx.readFile(filename)
    .then(function() {
        // use workbook
    });

// pipe from stream
var workbook = new Excel.Workbook();
stream.pipe(workbook.xlsx.<span class="apidocCodeKeywordSpan">createInputStream</span>());
```

#### Writing XLSX

```javascript
// write to a file
var workbook = createAndFillWorkbook();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype.load" id="apidoc.element.exceljs.xlsx.prototype.load">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>load
        <span class="apidocSignatureSpan">(data, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">load = function (data, options) {
  var self = this;
  if (options === undefined) {
    options = {};
  }
  var zipStream = this.createInputStream();
  return new PromishLib.Promish(function(resolve, reject) {
    zipStream.on(&#x27;done&#x27;, function () {
      resolve(self.workbook);
    }).on(&#x27;error&#x27;, function (error) {
      reject(error);
    });

    if (options.base64) {
      var buffer = new Buffer(data.toString(), &#x27;base64&#x27;);
      zipStream.write(buffer);
    } else {
      zipStream.write(data);
    }
    zipStream.end();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype.parseRels" id="apidoc.element.exceljs.xlsx.prototype.parseRels">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>parseRels
        <span class="apidocSignatureSpan">(stream)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parseRels = function (stream) {
  var xform = new RelationshipsXform();
  return xform.parseStream(stream);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

      var entryPath = entry.path;
      if (entryPath[0] === &#x27;/&#x27;) {
entryPath = entryPath.substr(1);
      }
      switch (entryPath) {
case &#x27;_rels/.rels&#x27;:
  promise = self.<span class="apidocCodeKeywordSpan">parseRels</span>(entry)
    .then(function (relationships) {
      model.globalRels = relationships;
    });
  break;

case &#x27;xl/workbook.xml&#x27;:
  promise = self.parseWorkbook(entry)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype.parseSharedStrings" id="apidoc.element.exceljs.xlsx.prototype.parseSharedStrings">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>parseSharedStrings
        <span class="apidocSignatureSpan">(stream)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parseSharedStrings = function (stream) {
  var xform = new SharedStringsXform();
  return xform.parseStream(stream);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype.parseWorkbook" id="apidoc.element.exceljs.xlsx.prototype.parseWorkbook">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>parseWorkbook
        <span class="apidocSignatureSpan">(stream)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parseWorkbook = function (stream) {
  var xform = new WorkbookXform();
  return xform.parseStream(stream);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  promise = self.parseRels(entry)
    .then(function (relationships) {
      model.globalRels = relationships;
    });
  break;

case &#x27;xl/workbook.xml&#x27;:
  promise = self.<span class="apidocCodeKeywordSpan">parseWorkbook</span>(entry)
    .then(function (workbook) {
      model.sheets = workbook.sheets;
      model.definedNames = workbook.definedNames;
      model.views = workbook.views;
      model.properties = workbook.properties;
    });
  break;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype.processIgnoreEntry" id="apidoc.element.exceljs.xlsx.prototype.processIgnoreEntry">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>processIgnoreEntry
        <span class="apidocSignatureSpan">(entry)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">processIgnoreEntry = function (entry) {
  entry.autodrain();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    break;

  default:
    promise =
      self.processWorksheetEntry(entry, model) ||
      self.processWorksheetRelsEntry(entry, model) ||
      self.processThemeEntry(entry, model) ||
      self.<span class="apidocCodeKeywordSpan">processIgnoreEntry</span>(entry);
    break;
}

if (promise) {
  promises.push(promise);
  promise = null;
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype.processThemeEntry" id="apidoc.element.exceljs.xlsx.prototype.processThemeEntry">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>processThemeEntry
        <span class="apidocSignatureSpan">(entry, model)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">processThemeEntry = function (entry, model) {
  var match = entry.path.match(/xl\/theme\/([a-zA-Z0-9]+)\.xml/);
  if (match) {
    return new PromishLib.Promish(function(resolve, reject) {
      var name = match[1];
      // TODO: stream entry into buffer and store the xml in the model.themes[]
      var stream = new StreamBuf();
      entry.on(&#x27;error&#x27;, reject);
      stream.on(&#x27;error&#x27;, reject);
      stream.on(&#x27;finish&#x27;, function() {
        model.themes[name] = stream.read().toString();
        resolve();
      });
      entry.pipe(stream);
    });
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      });
    break;

  default:
    promise =
      self.processWorksheetEntry(entry, model) ||
      self.processWorksheetRelsEntry(entry, model) ||
      self.<span class="apidocCodeKeywordSpan">processThemeEntry</span>(entry, model) ||
      self.processIgnoreEntry(entry);
    break;
}

if (promise) {
  promises.push(promise);
  promise = null;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype.processWorksheetEntry" id="apidoc.element.exceljs.xlsx.prototype.processWorksheetEntry">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>processWorksheetEntry
        <span class="apidocSignatureSpan">(entry, model)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">processWorksheetEntry = function (entry, model) {
  var match = entry.path.match(/xl\/worksheets\/sheet(\d+)\.xml/);
  if (match) {
    var sheetNo = match[1];
    var xform = new WorksheetXform();
    return xform.parseStream(entry)
      .then(function (worksheet) {
        worksheet.sheetNo = sheetNo;
        model.worksheetHash[entry.path] = worksheet;
        model.worksheets.push(worksheet);
      });
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      .then(function(coreProperties) {
        Object.assign(model, coreProperties);
      });
    break;

  default:
    promise =
      self.<span class="apidocCodeKeywordSpan">processWorksheetEntry</span>(entry, model) ||
      self.processWorksheetRelsEntry(entry, model) ||
      self.processThemeEntry(entry, model) ||
      self.processIgnoreEntry(entry);
    break;
}

if (promise) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype.processWorksheetRelsEntry" id="apidoc.element.exceljs.xlsx.prototype.processWorksheetRelsEntry">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>processWorksheetRelsEntry
        <span class="apidocSignatureSpan">(entry, model)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">processWorksheetRelsEntry = function (entry, model) {
  var match = entry.path.match(/xl\/worksheets\/_rels\/sheet(\d+)\.xml.rels/);
  if (match) {
    var sheetNo = match[1];
    var xform = new RelationshipsXform();
    return xform.parseStream(entry)
      .then(function(relationships) {
        model.worksheetRels[sheetNo] = relationships;
      });
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        Object.assign(model, coreProperties);
      });
    break;

  default:
    promise =
      self.processWorksheetEntry(entry, model) ||
      self.<span class="apidocCodeKeywordSpan">processWorksheetRelsEntry</span>(entry, model) ||
      self.processThemeEntry(entry, model) ||
      self.processIgnoreEntry(entry);
    break;
}

if (promise) {
  promises.push(promise);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype.read" id="apidoc.element.exceljs.xlsx.prototype.read">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>read
        <span class="apidocSignatureSpan">(stream)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">read = function (stream) {
  var self = this;
  var zipStream = this.createInputStream();
  return new PromishLib.Promish(function(resolve, reject) {
    zipStream.on(&#x27;done&#x27;, function () {
      resolve(self.workbook);
    }).on(&#x27;error&#x27;, function (error) {
      reject(error);
    });
    stream.pipe(zipStream);
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
workbook.csv.readFile(filename)
    .then(function(worksheet) {
        // use workbook or worksheet
    });

// read from a stream
var workbook = new Excel.Workbook();
workbook.csv.<span class="apidocCodeKeywordSpan">read</span>(stream)
    .then(function(worksheet) {
        // use workbook or worksheet
    });

// pipe from stream
var workbook = new Excel.Workbook();
stream.pipe(workbook.csv.createInputStream());
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype.readFile" id="apidoc.element.exceljs.xlsx.prototype.readFile">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>readFile
        <span class="apidocSignatureSpan">(filename)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">readFile = function (filename) {
  var self = this;
  var stream;
  return utils.fs.exists(filename)
    .then(function (exists) {
      if (!exists) {
        throw new Error(&#x27;File not found: &#x27; + filename);
      }
      stream = fs.createReadStream(filename);
      return self.read(stream);
    })
    .then(function (workbook) {
      stream.close();
      return workbook;
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
### XLSX

#### Reading XLSX

```javascript
// read from a file
var workbook = new Excel.Workbook();
workbook.xlsx.<span class="apidocCodeKeywordSpan">readFile</span>(filename)
    .then(function() {
        // use workbook
    });

// pipe from stream
var workbook = new Excel.Workbook();
stream.pipe(workbook.xlsx.createInputStream());
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype.reconcile" id="apidoc.element.exceljs.xlsx.prototype.reconcile">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>reconcile
        <span class="apidocSignatureSpan">(model)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">reconcile = function (model) {
  var workbookXform = new WorkbookXform();
  var worksheetXform = new WorksheetXform();

  workbookXform.reconcile(model);
  var sheetOptions = {
    styles: model.styles,
    sharedStrings: model.sharedStrings,
    date1904: model.properties.date1904
  };
  model.worksheets.forEach(function (worksheet) {
    worksheet.relationships = model.worksheetRels[worksheet.sheetNo];
    worksheetXform.reconcile(worksheet, sheetOptions);
  });

  // delete unnecessary parts
  model.worksheetHash = undefined;
  model.worksheetRels = undefined;
  model.globalRels = undefined;
  model.sharedStrings = undefined;
  model.workbookRels = undefined;
  model.sheetDefs = undefined;
  model.styles = undefined;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      return false;
    }
  },
  reconcile: function reconcile(model, options) {
    if (model) {
      var childXform = this.childXform;
      model.forEach(function (childModel) {
        childXform.<span class="apidocCodeKeywordSpan">reconcile</span>(childModel, options);
      });
    }
  }
});


},{&#x22;../../utils/utils&#x22;:20,&#x22;./base-xform&#x22;:25}],39:[function(require,module,exports){
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype.write" id="apidoc.element.exceljs.xlsx.prototype.write">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>write
        <span class="apidocSignatureSpan">(stream, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">write = function (stream, options) {
  options = options || {};
  var self = this;
  var model = self.workbook.model;
  var zip = new ZipStream.ZipWriter();
  zip.pipe(stream);

  // ensure following properties have sane values
  model.creator = model.creator || &#x27;ExcelJS&#x27;;
  model.lastModifiedBy = model.lastModifiedBy || &#x27;ExcelJS&#x27;;
  model.created = model.created || new Date();
  model.modified = model.modified || new Date();

  model.useSharedStrings = options.useSharedStrings !== undefined ?
    options.useSharedStrings :
    true;
  model.useStyles = options.useStyles !== undefined ?
    options.useStyles :
    true;

  // Manage the shared strings
  model.sharedStrings = new SharedStringsXform();

  // add a style manager to handle cell formats, fonts, etc.
  model.styles = model.useStyles ? new StylesXform(true) : new StylesXform.Mock();

  // prepare all of the things before the render
  var workbookXform = new WorkbookXform();
  var worksheetXform = new WorksheetXform();
  var prepareOptions = {
    sharedStrings: model.sharedStrings,
    styles: model.styles,
    date1904: model.properties.date1904
  };
  workbookXform.prepare(model);
  model.worksheets.forEach(function (worksheet) {
    worksheetXform.prepare(worksheet, prepareOptions);
  });

  // render
  var promises = [
    self.addContentTypes(zip, model),
    self.addApp(zip, model),
    self.addCore(zip, model),
    self.addThemes(zip, model),
    self.addOfficeRels(zip, model)
  ];
  return PromishLib.Promish.all(promises)
    .then(function () {
      return self.addWorksheets(zip, model, worksheetXform);
    })
    .then(function () {
      // Some things can only be done after all the worksheets have been processed
      var afters = [
        self.addSharedStrings(zip, model),
        self.addStyles(zip, model),
        self.addWorkbookRels(zip, model)
      ];
      return PromishLib.Promish.all(afters);
    })
    .then(function () {
      return self.addWorkbook(zip, model, workbookXform);
    })
    .then(function () {
      return self._finalize(zip);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var workbook = createAndFillWorkbook();
workbook.xlsx.writeFile(filename)
    .then(function() {
        // done
    });

// write to a stream
workbook.xlsx.<span class="apidocCodeKeywordSpan">write</span>(stream)
    .then(function() {
        // done
    });
```

### CSV
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype.writeBuffer" id="apidoc.element.exceljs.xlsx.prototype.writeBuffer">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>writeBuffer
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">writeBuffer = function (options) {
  var self = this;
  var stream = new StreamBuf();
  return self.write(stream, options)
    .then(function() {
      return stream.read();
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xlsx.prototype.writeFile" id="apidoc.element.exceljs.xlsx.prototype.writeFile">
        function <span class="apidocSignatureSpan">exceljs.xlsx.prototype.</span>writeFile
        <span class="apidocSignatureSpan">(filename, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">writeFile = function (filename, options) {
  var self = this;
  var stream = fs.createWriteStream(filename);

  return new PromishLib.Promish(function(resolve, reject) {
    stream.on(&#x27;finish&#x27;, function () {
      resolve();
    });
    stream.on(&#x27;error&#x27;, function (error) {
      reject(error);
    });

    self.write(stream, options)
      .then(function () {
        stream.end();
      })
      .catch(function (error) {
        reject(error);
      });
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

#### Writing XLSX

```javascript
// write to a file
var workbook = createAndFillWorkbook();
workbook.xlsx.<span class="apidocCodeKeywordSpan">writeFile</span>(filename)
.then(function() {
    // done
});

// write to a stream
workbook.xlsx.write(stream)
.then(function() {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.xml_stream" id="apidoc.module.exceljs.xml_stream">module exceljs.xml_stream</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.xml_stream.xml_stream" id="apidoc.element.exceljs.xml_stream.xml_stream">
        function <span class="apidocSignatureSpan">exceljs.</span>xml_stream
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">xml_stream = function () {
  this._xml = [];
  this._stack = [];
  this._rollbacks = [];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.xml_stream.prototype" id="apidoc.module.exceljs.xml_stream.prototype">module exceljs.xml_stream.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.xml_stream.prototype.addAttribute" id="apidoc.element.exceljs.xml_stream.prototype.addAttribute">
        function <span class="apidocSignatureSpan">exceljs.xml_stream.prototype.</span>addAttribute
        <span class="apidocSignatureSpan">(name, value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addAttribute = function (name, value) {
  if (!this.open) {
    throw new Error(&#x27;Cannot write attributes to node if it is not open&#x27;);
  }
  pushAttribute(this._xml, name, value);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }
  },

  render: function render(xmlStream, model) {
    if (model &#x26;&#x26; model.length) {
xmlStream.openNode(this.tag, this.$);
if (this.count) {
  xmlStream.<span class="apidocCodeKeywordSpan">addAttribute</span>(this.$count, model.length);
}

var childXform = this.childXform;
model.forEach(function (childModel) {
  childXform.render(xmlStream, childModel);
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xml_stream.prototype.addAttributes" id="apidoc.element.exceljs.xml_stream.prototype.addAttributes">
        function <span class="apidocSignatureSpan">exceljs.xml_stream.prototype.</span>addAttributes
        <span class="apidocSignatureSpan">(attrs)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addAttributes = function (attrs) {
  if (!this.open) {
    throw new Error(&#x27;Cannot write attributes to node if it is not open&#x27;);
  }
  pushAttributes(this._xml, attrs);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

utils.inherits(DateXform, BaseXform, {

render: function render(xmlStream, model) {
  if (model) {
    xmlStream.openNode(this.tag);
    if (this.attrs) {
      xmlStream.<span class="apidocCodeKeywordSpan">addAttributes</span>(this.attrs);
    }
    if (this.attr) {
      xmlStream.addAttribute(this.attr, this._format(model));
    } else {
      xmlStream.writeText(this._format(model));
    }
    xmlStream.closeNode();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xml_stream.prototype.addRollback" id="apidoc.element.exceljs.xml_stream.prototype.addRollback">
        function <span class="apidocSignatureSpan">exceljs.xml_stream.prototype.</span>addRollback
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addRollback = function () {
  this._rollbacks.push({
    xml: this._xml.length,
    stack: this._stack.length,
    leaf: this.leaf,
    open: this.open
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

  get tag() {
    return &#x27;sheetPr&#x27;;
  },

  render: function render(xmlStream, model) {
    if (model) {
xmlStream.<span class="apidocCodeKeywordSpan">addRollback</span>();
xmlStream.openNode(&#x27;sheetPr&#x27;);

var inner = false;
inner = this.map.tabColor.render(xmlStream, model.tabColor) || inner;
inner = this.map.pageSetUpPr.render(xmlStream, model.pageSetup) || inner;

if (inner) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xml_stream.prototype.closeAll" id="apidoc.element.exceljs.xml_stream.prototype.closeAll">
        function <span class="apidocSignatureSpan">exceljs.xml_stream.prototype.</span>closeAll
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">closeAll = function () {
  while (this._stack.length) {
    this.closeNode();
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      this._stack.splice(r.stack, this._stack.length - r.stack);
    }
    this.leaf = r.leaf;
    this.open = r.open;
  },

  get xml() {
    this.<span class="apidocCodeKeywordSpan">closeAll</span>();
    return this._xml.join(&#x27;&#x27;);
  }
};


},{&#x22;./under-dash&#x22;:19,&#x22;./utils&#x22;:20}],22:[function(require,module,exports){
/**
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xml_stream.prototype.closeNode" id="apidoc.element.exceljs.xml_stream.prototype.closeNode">
        function <span class="apidocSignatureSpan">exceljs.xml_stream.prototype.</span>closeNode
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">closeNode = function () {
  var node = this._stack.pop();
  var xml = this._xml;
  if (this.leaf) {
    xml.push(CLOSE_SLASH_ANGLE);
  } else {
    xml.push(OPEN_ANGLE_SLASH);
    xml.push(node);
    xml.push(CLOSE_ANGLE);
  }
  this.open = false;
  this.leaf = false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
},
leafNode: function leafNode(name, attributes, text) {
  this.openNode(name, attributes);
  if (text !== undefined) {
    // zeros need to be written
    this.writeText(text);
  }
  this.<span class="apidocCodeKeywordSpan">closeNode</span>();
},

closeAll: function closeAll() {
  while (this._stack.length) {
    this.closeNode();
  }
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xml_stream.prototype.commit" id="apidoc.element.exceljs.xml_stream.prototype.commit">
        function <span class="apidocSignatureSpan">exceljs.xml_stream.prototype.</span>commit
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">commit = function () {
  this._rollbacks.pop();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// Note: this operation will not affect other rows
row.splice(3,2);

// remove one cell and insert two more (cells to the right of the cut cell will be shifted right)
row.splice(4,1,&#x27;new value 1&#x27;, &#x27;new value 2&#x27;);

// Commit a completed row to stream
row.<span class="apidocCodeKeywordSpan">commit</span>();

// row metrics
var rowSize = row.cellCount;
var numValues = row.actualCellCount;
```

## Handling Individual Cells
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xml_stream.prototype.leafNode" id="apidoc.element.exceljs.xml_stream.prototype.leafNode">
        function <span class="apidocSignatureSpan">exceljs.xml_stream.prototype.</span>leafNode
        <span class="apidocSignatureSpan">(name, attributes, text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">leafNode = function (name, attributes, text) {
  this.openNode(name, attributes);
  if (text !== undefined) { // zeros need to be written
    this.writeText(text);
  }
  this.closeNode();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var BaseXform = require(&#x27;../base-xform&#x27;);

var WorksheetXform = module.exports = function () {};

utils.inherits(WorksheetXform, BaseXform, {

render: function render(xmlStream, model) {
  xmlStream.<span class="apidocCodeKeywordSpan">leafNode</span>(&#x27;sheet&#x27;, {
    sheetId: model.id,
    name: model.name,
    &#x27;r:id&#x27;: model.rId
  });
},

parseOpen: function parseOpen(node) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xml_stream.prototype.openNode" id="apidoc.element.exceljs.xml_stream.prototype.openNode">
        function <span class="apidocSignatureSpan">exceljs.xml_stream.prototype.</span>openNode
        <span class="apidocSignatureSpan">(name, attributes)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">openNode = function (name, attributes) {
  var parent = this.tos;
  var xml = this._xml;
  if (parent &#x26;&#x26; this.open) {
    xml.push(CLOSE_ANGLE);
  }

  this._stack.push(name);

  // start streaming node
  xml.push(OPEN_ANGLE);
  xml.push(name);
  pushAttributes(xml, attributes);
  this.leaf = true;
  this.open = true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    xml.push(node);
    xml.push(CLOSE_ANGLE);
  }
  this.open = false;
  this.leaf = false;
},
leafNode: function leafNode(name, attributes, text) {
  this.<span class="apidocCodeKeywordSpan">openNode</span>(name, attributes);
  if (text !== undefined) {
    // zeros need to be written
    this.writeText(text);
  }
  this.closeNode();
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xml_stream.prototype.openXml" id="apidoc.element.exceljs.xml_stream.prototype.openXml">
        function <span class="apidocSignatureSpan">exceljs.xml_stream.prototype.</span>openXml
        <span class="apidocSignatureSpan">(docAttributes)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">openXml = function (docAttributes) {
  var xml = this._xml;
  // &#x3c;?xml version=&#x22;1.0&#x22; encoding=&#x22;UTF-8&#x22; standalone=&#x22;yes&#x22;?&#x3e;
  xml.push(&#x27;&#x3c;?xml&#x27;);
  pushAttributes(xml, docAttributes);
  xml.push(&#x27;?&#x3e;\n&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
});
if (printAreas.length) {
  model.definedNames = model.definedNames.concat(printAreas);
}
  },

  render: function render(xmlStream, model) {
xmlStream.<span class="apidocCodeKeywordSpan">openXml</span>(XmlStream.StdDocAttributes);
xmlStream.openNode(&#x27;workbook&#x27;, WorkbookXform.WORKBOOK_ATTRIBUTES);

this.map.fileVersion.render(xmlStream);
this.map.workbookPr.render(xmlStream, model.properties);
this.map.bookViews.render(xmlStream, model.views);
this.map.sheets.render(xmlStream, model.sheets);
this.map.definedNames.render(xmlStream, model.definedNames);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xml_stream.prototype.rollback" id="apidoc.element.exceljs.xml_stream.prototype.rollback">
        function <span class="apidocSignatureSpan">exceljs.xml_stream.prototype.</span>rollback
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">rollback = function () {
  var r = this._rollbacks.pop();
  if (this._xml.length &#x3e; r.xml) {
    this._xml.splice(r.xml, this._xml.length - r.xml);
  }
  if (this._stack.length &#x3e; r.stack) {
    this._stack.splice(r.stack, this._stack.length - r.stack);
  }
  this.leaf = r.leaf;
  this.open = r.open;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    inner = this.map.tabColor.render(xmlStream, model.tabColor) || inner;
    inner = this.map.pageSetUpPr.render(xmlStream, model.pageSetup) || inner;

    if (inner) {
      xmlStream.closeNode();
      xmlStream.commit();
    } else {
      xmlStream.<span class="apidocCodeKeywordSpan">rollback</span>();
    }
  }
},

parseOpen: function parseOpen(node) {
  if (this.parser) {
    this.parser.parseOpen(node);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xml_stream.prototype.writeText" id="apidoc.element.exceljs.xml_stream.prototype.writeText">
        function <span class="apidocSignatureSpan">exceljs.xml_stream.prototype.</span>writeText
        <span class="apidocSignatureSpan">(text)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">writeText = function (text) {
  var xml = this._xml;
  if (this.open) {
    xml.push(CLOSE_ANGLE);
    this.open = false;
  }
  this.leaf = false;
  xml.push(utils.xmlEncode(text.toString()));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  this.open = false;
  this.leaf = false;
},
leafNode: function leafNode(name, attributes, text) {
  this.openNode(name, attributes);
  if (text !== undefined) {
    // zeros need to be written
    this.<span class="apidocCodeKeywordSpan">writeText</span>(text);
  }
  this.closeNode();
},

closeAll: function closeAll() {
  while (this._stack.length) {
    this.closeNode();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.xml_stream.prototype.writeXml" id="apidoc.element.exceljs.xml_stream.prototype.writeXml">
        function <span class="apidocSignatureSpan">exceljs.xml_stream.prototype.</span>writeXml
        <span class="apidocSignatureSpan">(xml)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">writeXml = function (xml) {
  if (this.open) {
    this._xml.push(CLOSE_ANGLE);
    this.open = false;
  }
  this.leaf = false;
  this._xml.push(xml);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
utils.inherits(StaticXform, BaseXform, {
render: function(xmlStream) {
  if (!this._xml) {
    var stream = new XmlStream();
    build(stream, this._model);
    this._xml = stream.xml;
  }
  xmlStream.<span class="apidocCodeKeywordSpan">writeXml</span>(this._xml);
},

parseOpen: function() {
  return true;
},
parseText: function() {
},
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.exceljs.zip_stream" id="apidoc.module.exceljs.zip_stream">module exceljs.zip_stream</a></h1>


    <h2>
        <a href="#apidoc.element.exceljs.zip_stream.ZipReader" id="apidoc.element.exceljs.zip_stream.ZipReader">
        function <span class="apidocSignatureSpan">exceljs.zip_stream.</span>ZipReader
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ZipReader = function () {
  var self = this;
  this.count = 0;
  this.jsZip = new JSZip();
  this.stream = new StreamBuf();
  this.stream.on(&#x27;finish&#x27;, function() {
    self._process();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
worksheetHash: {},
worksheetRels: [],
themes: {},
    };

    // we have to be prepared to read the zip entries in whatever order they arrive
    var promises = [];
    var stream = new ZipStream.<span class="apidocCodeKeywordSpan">ZipReader</span>();
    stream.on(&#x27;entry&#x27;, function (entry) {
var promise = null;

var entryPath = entry.path;
if (entryPath[0] === &#x27;/&#x27;) {
  entryPath = entryPath.substr(1);
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.exceljs.zip_stream.ZipWriter" id="apidoc.element.exceljs.zip_stream.ZipWriter">
        function <span class="apidocSignatureSpan">exceljs.zip_stream.</span>ZipWriter
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ZipWriter = function () {
  this.zip = new JSZip();
  this.stream = new StreamBuf();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  zip.finalize();
});
  },
  write: function (stream, options) {
options = options || {};
var self = this;
var model = self.workbook.model;
var zip = new ZipStream.<span class="apidocCodeKeywordSpan">ZipWriter</span>();
zip.pipe(stream);

// ensure following properties have sane values
model.creator = model.creator || &#x27;ExcelJS&#x27;;
model.lastModifiedBy = model.lastModifiedBy || &#x27;ExcelJS&#x27;;
model.created = model.created || new Date();
model.modified = model.modified || new Date();
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
